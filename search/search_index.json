{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to Hopsworks # Hopsworks and its Feature Store are an open source data-intensive AI platform used for the development and operation of machine learning models at scale. Hopsworks on AWS Hopsworks on Azure Hopsworks on GCP Hopsworks on Premise Get started with the Feature Store Get Started with Models and Serving Development and Operational ML on Hopsworks # You can develop and run Python, Spark, and Flink applications on Hopsworks - in Jupyter notebooks, as jobs, or even notebooks as jobs. You can build production pipelines with the bundled Airflow, and even run ML training pipelines with GPUs in notebooks on Airflow. You can train models on as many GPUs as are installed in a Hopsworks cluster and easily share them among users. Who\u2019s behind Hopsworks? # Hopsworks started as an open-source collaborative project at KTH University , RISE , and has more recently been taken on by Logical Clocks . Several funding bodies have helped contribute to its development including: European Commission (FP7, H2020) , EIT , SSF , Vinnova and Celtic-Next . Open-Source # Hopsworks is available under the AGPL-V3 license. In plain English this means that you are free to use Hopsworks and even build paid services on it, but if you modify the source code, you should also release your changes and any systems built around it as AGPL-V3. Join the community # Ask questions and give us feedback in the Hopsworks Community Follow us on Twitter Check out all our latest product releases Contribute # We are building the most complete and modular ML platform available in the market and we count on your support to continuously improve Hopsworks. Feel free to give us suggestions , report bugs and add features to our library anytime. We\u2019re the best in what we do and want our community to succeed as well. Our many thanks to the top contributors of Hopsworks! Enjoy!","title":"Home"},{"location":"#welcome-to-hopsworks","text":"Hopsworks and its Feature Store are an open source data-intensive AI platform used for the development and operation of machine learning models at scale. Hopsworks on AWS Hopsworks on Azure Hopsworks on GCP Hopsworks on Premise Get started with the Feature Store Get Started with Models and Serving","title":"Welcome to Hopsworks"},{"location":"#development-and-operational-ml-on-hopsworks","text":"You can develop and run Python, Spark, and Flink applications on Hopsworks - in Jupyter notebooks, as jobs, or even notebooks as jobs. You can build production pipelines with the bundled Airflow, and even run ML training pipelines with GPUs in notebooks on Airflow. You can train models on as many GPUs as are installed in a Hopsworks cluster and easily share them among users.","title":"Development and Operational ML on Hopsworks"},{"location":"#whos-behind-hopsworks","text":"Hopsworks started as an open-source collaborative project at KTH University , RISE , and has more recently been taken on by Logical Clocks . Several funding bodies have helped contribute to its development including: European Commission (FP7, H2020) , EIT , SSF , Vinnova and Celtic-Next .","title":"Who\u2019s behind Hopsworks?"},{"location":"#open-source","text":"Hopsworks is available under the AGPL-V3 license. In plain English this means that you are free to use Hopsworks and even build paid services on it, but if you modify the source code, you should also release your changes and any systems built around it as AGPL-V3.","title":"Open-Source"},{"location":"#join-the-community","text":"Ask questions and give us feedback in the Hopsworks Community Follow us on Twitter Check out all our latest product releases","title":"Join the community"},{"location":"#contribute","text":"We are building the most complete and modular ML platform available in the market and we count on your support to continuously improve Hopsworks. Feel free to give us suggestions , report bugs and add features to our library anytime. We\u2019re the best in what we do and want our community to succeed as well. Our many thanks to the top contributors of Hopsworks! Enjoy!","title":"Contribute"},{"location":"admin/","text":"Cluster Administration # Hopsworks has a cluster management page that allows you, the administrator, to perform management actions, monitor and control Hopsworks. To access the cluster management page you should log in into Hopsworks using your administrator account. In the top right corner, click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu.","title":"Introduction"},{"location":"admin/#cluster-administration","text":"Hopsworks has a cluster management page that allows you, the administrator, to perform management actions, monitor and control Hopsworks. To access the cluster management page you should log in into Hopsworks using your administrator account. In the top right corner, click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu.","title":"Cluster Administration"},{"location":"admin/alert/","text":"Configure Alerts # Alerts are sent from Hopsworks using Prometheus' Alert manager . In order to send alerts we first need to configure the Alert manager . To do that click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu. In the Cluster Settings' Alerts tab you can configure the alert manager to send alerts via email, slack or pagerduty. Configure alerts 1. Email Alerts # To send alerts via email you need to configure an SMTP server. Click on the Configure button on the left side of the email row and fill out the form that pops up. Configure Email Alerts Default from : the address used as sender in the alert email. SMTP smarthost : the Simple Mail Transfer Protocol (SMTP) host through which emails are sent. Default hostname (optional) : hostname to identify to the SMTP server. Authentication method : how to authenticate to the SMTP server. CRAM-MD5, LOGIN or PLAIN. Optionally cluster wide Email alert receivers can be added in Default receiver emails . These receivers will be available to all users when they create event triggered alerts . 2. Slack Alerts # Alert can also be sent via Slack message. To be able to send Slack messages you first need to configure a Slack webhook. Click on the Configure button on the left side of the slack row and past in your Slack webhook in Webhook . Configure slack Alerts Optionally cluster wide Slack alert receivers can be added in Slack channel/user . These receivers will be available to all users when they create event triggered alerts . 3. Pagerduty # Pagerduty is another way you can send alerts from Hopsworks. Click on the Configure button on the left side of the pagerduty row and fill out the form that pops up. Configure Pagerduty Alerts Fill in Pagerduty URL: the URL to send API requests to. Optionally cluster wide Pagerduty alert receivers can be added in Service key/Routing key . By first choosing the PagerDuty integration type: global event routing (routing_key) : when using PagerDuty integration type Events API v2 . service (service_key) : when using PagerDuty integration type Prometheus . Then adding the Service key/Routing key of the receiver(s). PagerDuty provides documentation on how to integrate with Prometheus' Alert manager. Advanced configuration # If you are familiar with Prometheus' Alert manager you can also configure alerts by editing the yaml/json file directly. Advanced configuration Example: Adding the yaml snippet shown below in the global section of the alert manager configuration will have the same effect as creating the SMTP configuration as shown in section 1 above. global : smtp_smarthost : smtp.gmail.com:587 smtp_from : hopsworks@gmail.com smtp_auth_username : hopsworks@gmail.com smtp_auth_password : XXXXXXXXX smtp_auth_identity : hopsworks@gmail.com ... To test the alerts by creating triggers from Jobs and Feature group validations see Alerts .","title":"Configure Alerts"},{"location":"admin/alert/#configure-alerts","text":"Alerts are sent from Hopsworks using Prometheus' Alert manager . In order to send alerts we first need to configure the Alert manager . To do that click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu. In the Cluster Settings' Alerts tab you can configure the alert manager to send alerts via email, slack or pagerduty. Configure alerts","title":"Configure Alerts"},{"location":"admin/alert/#1-email-alerts","text":"To send alerts via email you need to configure an SMTP server. Click on the Configure button on the left side of the email row and fill out the form that pops up. Configure Email Alerts Default from : the address used as sender in the alert email. SMTP smarthost : the Simple Mail Transfer Protocol (SMTP) host through which emails are sent. Default hostname (optional) : hostname to identify to the SMTP server. Authentication method : how to authenticate to the SMTP server. CRAM-MD5, LOGIN or PLAIN. Optionally cluster wide Email alert receivers can be added in Default receiver emails . These receivers will be available to all users when they create event triggered alerts .","title":"1. Email Alerts"},{"location":"admin/alert/#2-slack-alerts","text":"Alert can also be sent via Slack message. To be able to send Slack messages you first need to configure a Slack webhook. Click on the Configure button on the left side of the slack row and past in your Slack webhook in Webhook . Configure slack Alerts Optionally cluster wide Slack alert receivers can be added in Slack channel/user . These receivers will be available to all users when they create event triggered alerts .","title":"2. Slack Alerts"},{"location":"admin/alert/#3-pagerduty","text":"Pagerduty is another way you can send alerts from Hopsworks. Click on the Configure button on the left side of the pagerduty row and fill out the form that pops up. Configure Pagerduty Alerts Fill in Pagerduty URL: the URL to send API requests to. Optionally cluster wide Pagerduty alert receivers can be added in Service key/Routing key . By first choosing the PagerDuty integration type: global event routing (routing_key) : when using PagerDuty integration type Events API v2 . service (service_key) : when using PagerDuty integration type Prometheus . Then adding the Service key/Routing key of the receiver(s). PagerDuty provides documentation on how to integrate with Prometheus' Alert manager.","title":"3. Pagerduty"},{"location":"admin/alert/#advanced-configuration","text":"If you are familiar with Prometheus' Alert manager you can also configure alerts by editing the yaml/json file directly. Advanced configuration Example: Adding the yaml snippet shown below in the global section of the alert manager configuration will have the same effect as creating the SMTP configuration as shown in section 1 above. global : smtp_smarthost : smtp.gmail.com:587 smtp_from : hopsworks@gmail.com smtp_auth_username : hopsworks@gmail.com smtp_auth_password : XXXXXXXXX smtp_auth_identity : hopsworks@gmail.com ... To test the alerts by creating triggers from Jobs and Feature group validations see Alerts .","title":"Advanced configuration"},{"location":"admin/auth/","text":"Authentication Methods # To configure Authentication methods click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu. In the Cluster Settings Authentication tab you can configure how users authenticate. TOTP Two-factor Authentication : can be disabled , optional or mandatory . If set to mandatory all users are required to set up two-factor authentication when registering. Note If two-factor is set to mandatory on a cluster with preexisting users all users will need to go through lost device recovery step to enable two-factor. So consider setting it to optional first and allow users to enable it before setting it to mandatory. OAuth2 : if your organization already have an identity management system compatible with OpenID Connect (OIDC) you can configure Hopsworks to use your identity provider by enabling OAuth as shown in the figure below. After enabling OAuth you can register your identity provider by clicking on Add Identity Provider button. See Create client for details. LDAP/Kerberos : if your organization is using LDAP or Kerberos to manage users and services you can configure Hopsworks to use it as the user management system. You can enable LDAP/Kerberos by clicking on the checkbox, as shown in the figure below, and choosing LDAP or Kerberos. For more information on how to configure LDAP and Kerberos see Configure LDAP and Configure Kerberos . Setup Authentication Methods In the figure above we see a cluster with Two-factor authentication disabled, OAuth enabled with one registered identity provider and LDAP authentication enabled.","title":"Configure Authentication"},{"location":"admin/auth/#authentication-methods","text":"To configure Authentication methods click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu. In the Cluster Settings Authentication tab you can configure how users authenticate. TOTP Two-factor Authentication : can be disabled , optional or mandatory . If set to mandatory all users are required to set up two-factor authentication when registering. Note If two-factor is set to mandatory on a cluster with preexisting users all users will need to go through lost device recovery step to enable two-factor. So consider setting it to optional first and allow users to enable it before setting it to mandatory. OAuth2 : if your organization already have an identity management system compatible with OpenID Connect (OIDC) you can configure Hopsworks to use your identity provider by enabling OAuth as shown in the figure below. After enabling OAuth you can register your identity provider by clicking on Add Identity Provider button. See Create client for details. LDAP/Kerberos : if your organization is using LDAP or Kerberos to manage users and services you can configure Hopsworks to use it as the user management system. You can enable LDAP/Kerberos by clicking on the checkbox, as shown in the figure below, and choosing LDAP or Kerberos. For more information on how to configure LDAP and Kerberos see Configure LDAP and Configure Kerberos . Setup Authentication Methods In the figure above we see a cluster with Two-factor authentication disabled, OAuth enabled with one registered identity provider and LDAP authentication enabled.","title":"Authentication Methods"},{"location":"admin/dummy/","text":"","title":"Dummy"},{"location":"admin/installation/","text":"Installation notes #","title":"Installation notes"},{"location":"admin/installation/#installation-notes","text":"","title":"Installation notes"},{"location":"admin/project/","text":"Admin Project Guide #","title":"Admin Project Guide"},{"location":"admin/project/#admin-project-guide","text":"","title":"Admin Project Guide"},{"location":"admin/services/","text":"Manage Services # Hopsworks provides administrators with a view of the status/health of the cluster. This information is provided through the Services page. You can find the Services page by clicking on your name, in the top right corner of the navigation bar, and choosing Cluster Settings from the dropdown menu and going to the Services tab. Services page This page give administrators an overview of which services are running on the cluster. It provides information about their status as reported by agents that monitor the status of the different Systemd units. Columns in the services table represent machines in your cluster. Each service running on a machine will have a status running (green), stopped (gray), or bad health (red). Services are divided into groups, and you can search for a service by its name or group. You can also search for machines by their host name. Services After you find the correct service you will be able to start , stop or restart it, by clicking on its status. Start, Stop and Restart a service Note Stopping some services like the web server (glassfish_domain1) is not recommended. If you stop it you will have to access the machine running the service and start it with systemctl start glassfish_domain1 .","title":"Manage Services"},{"location":"admin/services/#manage-services","text":"Hopsworks provides administrators with a view of the status/health of the cluster. This information is provided through the Services page. You can find the Services page by clicking on your name, in the top right corner of the navigation bar, and choosing Cluster Settings from the dropdown menu and going to the Services tab. Services page This page give administrators an overview of which services are running on the cluster. It provides information about their status as reported by agents that monitor the status of the different Systemd units. Columns in the services table represent machines in your cluster. Each service running on a machine will have a status running (green), stopped (gray), or bad health (red). Services are divided into groups, and you can search for a service by its name or group. You can also search for machines by their host name. Services After you find the correct service you will be able to start , stop or restart it, by clicking on its status. Start, Stop and Restart a service Note Stopping some services like the web server (glassfish_domain1) is not recommended. If you stop it you will have to access the machine running the service and start it with systemctl start glassfish_domain1 .","title":"Manage Services"},{"location":"admin/user/","text":"User Management # Whether you run Hopsworks on-premise, or on the cloud using hopsworks.ai , you have a Hopsworks cluster which contains all users and projects. Cluster users # All the users of your Hopsworks instance have access to your cluster with different access rights. You can find them by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu and going to the Users tab (You need to have Admin role to get access to the Cluster Settings page). Active Users Cluster roles # Roles let you manage the access rights of a user to the cluster. User: users with this role are only allowed to use the cluster by creating a limited number of projects. Admin: users with this role are allowed to manage the cluster. This includes accepting new users to the cluster or blocking them, managing user quota, configure alerts and setting up authentication methods . Validating and blocking users # By default, a user who register on Hopsworks using their own credentials are not granted access to the cluster. First, a user with an admin role needs to validate their account. By clicking on the Review Requests button you can open a user request review popup as shown in the image below. Review user request On the user request review popup you can activate or block users. Users with a validated email address will have a check mark on their email. Similarly, if a user is no longer allowed access to the cluster you can block them. To keep consistency with the history of your datasets, a user can not be deleted but only blocked. If necessary a user can be deleted manually in the cluster using the command line. You can block a user by clicking on the block icon on the right side of the user in the list. Blocked Users Blocked users will appear on the lower section of the page. Click on display blocked users to show all the blocked users in your cluster. If a user is blocked by mistake you can reactivate it by clicking on the check mark icon that corresponds to that user in the blocked users list. You can also change the role of a user by clicking on the select dropdown that shows the current role of the user. If there are too many users in your cluster, use the search box (available for blocked users too) to filter users by name or email. It is also possible to filter activated users by role. For example to see all administrators in you cluster click on the select dropdown to the right of the search box and choose Admin . Create users # If you want to allow users to login without registering you can pre-create them by clicking on New user . Create new user After setting the user's name and email chose the type of user you want to create (Hopsworks, Kerberos or LDAP). To create a Kerberos or LDAP user you need to get the users UUID from the Kerberos or LDAP server. Hopsworks user can also be assigned a Role . Kerberos and LDAP users on the other hand can only be assigned a role through group mapping. A temporary password will be generated and displayed when you click on Create new user . Copy the password and pass it securely to the user. Copy temporary password Reset user password # In the case where a user loses her/his password and can not recover it with the password recovery , an administrator can reset it for them. On the bottom of the Users page click on the Reset a user password link. A popup window with a dropdown for searching users by name or email will open. Find the user and click on Reset new password . Reset user password A temporary password will be displayed. Copy the password and pass it to the user securely. Copy temporary password A user with a temporary password will see a warning message when going to User settings Authentication tab. Change password Note A temporary password should be changed as soon as possible.","title":"User Management"},{"location":"admin/user/#user-management","text":"Whether you run Hopsworks on-premise, or on the cloud using hopsworks.ai , you have a Hopsworks cluster which contains all users and projects.","title":"User Management"},{"location":"admin/user/#cluster-users","text":"All the users of your Hopsworks instance have access to your cluster with different access rights. You can find them by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu and going to the Users tab (You need to have Admin role to get access to the Cluster Settings page). Active Users","title":"Cluster users"},{"location":"admin/user/#cluster-roles","text":"Roles let you manage the access rights of a user to the cluster. User: users with this role are only allowed to use the cluster by creating a limited number of projects. Admin: users with this role are allowed to manage the cluster. This includes accepting new users to the cluster or blocking them, managing user quota, configure alerts and setting up authentication methods .","title":"Cluster roles"},{"location":"admin/user/#validating-and-blocking-users","text":"By default, a user who register on Hopsworks using their own credentials are not granted access to the cluster. First, a user with an admin role needs to validate their account. By clicking on the Review Requests button you can open a user request review popup as shown in the image below. Review user request On the user request review popup you can activate or block users. Users with a validated email address will have a check mark on their email. Similarly, if a user is no longer allowed access to the cluster you can block them. To keep consistency with the history of your datasets, a user can not be deleted but only blocked. If necessary a user can be deleted manually in the cluster using the command line. You can block a user by clicking on the block icon on the right side of the user in the list. Blocked Users Blocked users will appear on the lower section of the page. Click on display blocked users to show all the blocked users in your cluster. If a user is blocked by mistake you can reactivate it by clicking on the check mark icon that corresponds to that user in the blocked users list. You can also change the role of a user by clicking on the select dropdown that shows the current role of the user. If there are too many users in your cluster, use the search box (available for blocked users too) to filter users by name or email. It is also possible to filter activated users by role. For example to see all administrators in you cluster click on the select dropdown to the right of the search box and choose Admin .","title":"Validating and blocking users"},{"location":"admin/user/#create-users","text":"If you want to allow users to login without registering you can pre-create them by clicking on New user . Create new user After setting the user's name and email chose the type of user you want to create (Hopsworks, Kerberos or LDAP). To create a Kerberos or LDAP user you need to get the users UUID from the Kerberos or LDAP server. Hopsworks user can also be assigned a Role . Kerberos and LDAP users on the other hand can only be assigned a role through group mapping. A temporary password will be generated and displayed when you click on Create new user . Copy the password and pass it securely to the user. Copy temporary password","title":"Create users"},{"location":"admin/user/#reset-user-password","text":"In the case where a user loses her/his password and can not recover it with the password recovery , an administrator can reset it for them. On the bottom of the Users page click on the Reset a user password link. A popup window with a dropdown for searching users by name or email will open. Find the user and click on Reset new password . Reset user password A temporary password will be displayed. Copy the password and pass it to the user securely. Copy temporary password A user with a temporary password will see a warning message when going to User settings Authentication tab. Change password Note A temporary password should be changed as soon as possible.","title":"Reset user password"},{"location":"admin/ldap/configure-krb/","text":"Configure Kerberos # Kerberos need some server configuration before you can enable it from the UI. For instruction on how to configure your hopsworks server see Server Configuration for Kerberos After configuring the server you can configure Authentication methods by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Authentication tab you can find in Cluster Settings , you can enable Kerberos by clicking on the Kerberos checkbox. If LDAP/Kerberos checkbox is not checked, make sure that you configured your application server and enable it by clicking on the checkbox. Setup Authentication Methods Finally, click on edit configuration and fill in the attributes. Configure Kerberos Account status: the status a user will be assigned when logging in for the first time. If a user is assigned a status different from Activated an admin needs to manually activate each user from the User management . Group mapping: allows you to specify a mapping between LDAP groups and Hopsworks groups. The mapping is a semicolon separated string in the form Directory Administrators->HOPS_ADMIN;IT People-> HOPS_USER . Default is empty. If no mapping is specified, users need to be assigned a role by an admin before they can log in. User id: the id field in LDAP with a string placeholder. Default uid=%s . User given name: the given name field in LDAP. Default givenName . User surname: the surname field in LDAP. Default sn . User email: the email field in LDAP. Default mail . User search filter: the search filter for user. Default uid=%s . Principal search filter: the search filter for principal name. Default krbPrincipalName=%s . Group search filter: the search filter for groups. Default member=%d . Group target: the target to search for groups in the LDAP directory tree. Default cn . Dynamic group target: the target to search for dynamic groups in the LDAP directory tree. Default memberOf . User dn: specify the distinguished name (DN) of the container or base point where the users are stored. Default is empty. Group dn: specify the DN of the container or base point where the groups are stored. Default is empty. All defaults are taken from OpenLDAP . The login page will now have the choice to use Kerberos for authentication. Log in using Kerberos Note Make sure that you have Kerberos properly configured on your computer and you are logged in. Kerberos support must also be configured on the browser to use Kerberos for authentication.","title":"Configure Kerberos"},{"location":"admin/ldap/configure-krb/#configure-kerberos","text":"Kerberos need some server configuration before you can enable it from the UI. For instruction on how to configure your hopsworks server see Server Configuration for Kerberos After configuring the server you can configure Authentication methods by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Authentication tab you can find in Cluster Settings , you can enable Kerberos by clicking on the Kerberos checkbox. If LDAP/Kerberos checkbox is not checked, make sure that you configured your application server and enable it by clicking on the checkbox. Setup Authentication Methods Finally, click on edit configuration and fill in the attributes. Configure Kerberos Account status: the status a user will be assigned when logging in for the first time. If a user is assigned a status different from Activated an admin needs to manually activate each user from the User management . Group mapping: allows you to specify a mapping between LDAP groups and Hopsworks groups. The mapping is a semicolon separated string in the form Directory Administrators->HOPS_ADMIN;IT People-> HOPS_USER . Default is empty. If no mapping is specified, users need to be assigned a role by an admin before they can log in. User id: the id field in LDAP with a string placeholder. Default uid=%s . User given name: the given name field in LDAP. Default givenName . User surname: the surname field in LDAP. Default sn . User email: the email field in LDAP. Default mail . User search filter: the search filter for user. Default uid=%s . Principal search filter: the search filter for principal name. Default krbPrincipalName=%s . Group search filter: the search filter for groups. Default member=%d . Group target: the target to search for groups in the LDAP directory tree. Default cn . Dynamic group target: the target to search for dynamic groups in the LDAP directory tree. Default memberOf . User dn: specify the distinguished name (DN) of the container or base point where the users are stored. Default is empty. Group dn: specify the DN of the container or base point where the groups are stored. Default is empty. All defaults are taken from OpenLDAP . The login page will now have the choice to use Kerberos for authentication. Log in using Kerberos Note Make sure that you have Kerberos properly configured on your computer and you are logged in. Kerberos support must also be configured on the browser to use Kerberos for authentication.","title":"Configure Kerberos"},{"location":"admin/ldap/configure-ldap/","text":"Configure LDAP/Kerberos # LDAP need some server configuration before you can enable it from the UI. For instruction on how to configure your hopsworks server see Server Configuration for LDAP After configuring the server you can configure Authentication methods by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Authentication tab you can find in Cluster Settings , you can enable LDAP by clicking on the LDAP checkbox. If LDAP/Kerberos checkbox is not checked make sure that you configured your application server and enable it by clicking on the checkbox. Setup Authentication Methods Finally, click on edit configuration and fill in the attributes. Configure LDAP Account status: the status a user will be assigned when logging in for the first time. If a use is assigned a status different from Activated an admin needs to manually activate each user from the User management . Group mapping: allows you to specify a mapping between LDAP groups and Hopsworks groups. The mapping is a semicolon separated string in the form Directory Administrators->HOPS_ADMIN;IT People-> HOPS_USER . Default is empty. If no mapping is specified, users need to be assigned a role by an admin before they can log in. User id: the id field in LDAP with a string placeholder. Default uid=%s . User given name: the given name field in LDAP. Default givenName . User surname: the surname field in LDAP. Default sn . User email: the email field in LDAP. Default mail . User search filter: the search filter for user. Default uid=%s . Group search filter: the search filter for groups. Default member=%d . Group target: the target to search for groups in the LDAP directory tree. Default cn . Dynamic group target: the target to search for dynamic groups in the LDAP directory tree. Default memberOf . User dn: specify the distinguished name (DN) of the container or base point where the users are stored. Default is empty. Group dn: specify the DN of the container or base point where the groups are stored. Default is empty. All defaults are taken from OpenLDAP . The login page will now have the choice to use LDAP for authentication. Log in using LDAP","title":"Configure LDAP"},{"location":"admin/ldap/configure-ldap/#configure-ldapkerberos","text":"LDAP need some server configuration before you can enable it from the UI. For instruction on how to configure your hopsworks server see Server Configuration for LDAP After configuring the server you can configure Authentication methods by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Authentication tab you can find in Cluster Settings , you can enable LDAP by clicking on the LDAP checkbox. If LDAP/Kerberos checkbox is not checked make sure that you configured your application server and enable it by clicking on the checkbox. Setup Authentication Methods Finally, click on edit configuration and fill in the attributes. Configure LDAP Account status: the status a user will be assigned when logging in for the first time. If a use is assigned a status different from Activated an admin needs to manually activate each user from the User management . Group mapping: allows you to specify a mapping between LDAP groups and Hopsworks groups. The mapping is a semicolon separated string in the form Directory Administrators->HOPS_ADMIN;IT People-> HOPS_USER . Default is empty. If no mapping is specified, users need to be assigned a role by an admin before they can log in. User id: the id field in LDAP with a string placeholder. Default uid=%s . User given name: the given name field in LDAP. Default givenName . User surname: the surname field in LDAP. Default sn . User email: the email field in LDAP. Default mail . User search filter: the search filter for user. Default uid=%s . Group search filter: the search filter for groups. Default member=%d . Group target: the target to search for groups in the LDAP directory tree. Default cn . Dynamic group target: the target to search for dynamic groups in the LDAP directory tree. Default memberOf . User dn: specify the distinguished name (DN) of the container or base point where the users are stored. Default is empty. Group dn: specify the DN of the container or base point where the groups are stored. Default is empty. All defaults are taken from OpenLDAP . The login page will now have the choice to use LDAP for authentication. Log in using LDAP","title":"Configure LDAP/Kerberos"},{"location":"admin/ldap/configure-server/","text":"Configure Server for LDAP and Kerberos # LDAP and Kerberos integration need some configuration in the Karamel cluster definition used to deploy your hopsworks cluster. Server Configuration for LDAP # The LDAP attributes below are used to configure JNDI external resource in Payara. The JNDI resource will communicate with your LDAP server to perform the authentication. ldap : enabled : true jndilookupname : \"dc=hopsworks,dc=ai\" provider_url : \"ldap://193.10.66.104:1389\" attr_binary_val : \"entryUUID\" security_auth : \"none\" security_principal : \"\" security_credentials : \"\" referral : \"ignore\" additional_props : \"\" jndilookupname: should contain the LDAP domain. attr_binary_val: is the binary unique identifier that will be used in subsequent logins to identify the user. security_auth: how to authenticate to the LDAP server. security_principal: contains the username of the user that will be used to query LDAP. security_credentials: contains the password of the user that will be used to query LDAP. referral: whether to follow or ignore an alternate location in which an LDAP Request may be processed. Server Configuration for Kerberos # The Kerberos attributes are used to configure SPNEGO . SPNEGO is used to establish a secure context between the requester and the application server when using Kerberos authentication. kerberos : enabled : true krb_conf_path : \"/etc/krb5.conf\" krb_server_key_tab_path : \"/etc/security/keytabs/service.keytab\" krb_server_key_tab_name : \"service.keytab\" spnego_server_conf : '\\nuseKeyTab=true\\nprincipal=\\\"HTTP/server.hopsworks.ai@HOPSWORKS.AI\\\"\\nstoreKey=true\\nisInitiator=false' ldap : jndilookupname : \"dc=hopsworks,dc=ai\" provider_url : \"ldap://193.10.66.104:1389\" attr_binary_val : \"objectGUID\" security_auth : \"none\" security_principal : \"\" security_credentials : \"\" referral : \"ignore\" additional_props : \"\" Both Kerberos and LDAP attributes need to be specified to configure Kerberos. The LDAP attributes are explained above. krb_conf_path: contains the path to the krb5.conf used by SPNEGO to get information about the default domain and the location of the Kerberos KDC. The file is copied by the recipe in to /srv/hops/domains/domain1/config. krb_server_key_tab_path: contains the path to the Kerberos service keytab. The keytab is copied by the recipe in to /srv/hops/domains/domain/config with the name set in the krb_server_key_tab_name attribute. spnego_server_conf: contains the configuration that will be appended to Payara's (application serve used to host hopsworks) login.conf. In particular, it should contain useKeyTab=true, and the principal name to be used in the authentication phase. Initiator should be set to false.","title":"Configure server for LDAP and Kerberos"},{"location":"admin/ldap/configure-server/#configure-server-for-ldap-and-kerberos","text":"LDAP and Kerberos integration need some configuration in the Karamel cluster definition used to deploy your hopsworks cluster.","title":"Configure Server for LDAP and Kerberos"},{"location":"admin/ldap/configure-server/#server-configuration-for-ldap","text":"The LDAP attributes below are used to configure JNDI external resource in Payara. The JNDI resource will communicate with your LDAP server to perform the authentication. ldap : enabled : true jndilookupname : \"dc=hopsworks,dc=ai\" provider_url : \"ldap://193.10.66.104:1389\" attr_binary_val : \"entryUUID\" security_auth : \"none\" security_principal : \"\" security_credentials : \"\" referral : \"ignore\" additional_props : \"\" jndilookupname: should contain the LDAP domain. attr_binary_val: is the binary unique identifier that will be used in subsequent logins to identify the user. security_auth: how to authenticate to the LDAP server. security_principal: contains the username of the user that will be used to query LDAP. security_credentials: contains the password of the user that will be used to query LDAP. referral: whether to follow or ignore an alternate location in which an LDAP Request may be processed.","title":"Server Configuration for LDAP"},{"location":"admin/ldap/configure-server/#server-configuration-for-kerberos","text":"The Kerberos attributes are used to configure SPNEGO . SPNEGO is used to establish a secure context between the requester and the application server when using Kerberos authentication. kerberos : enabled : true krb_conf_path : \"/etc/krb5.conf\" krb_server_key_tab_path : \"/etc/security/keytabs/service.keytab\" krb_server_key_tab_name : \"service.keytab\" spnego_server_conf : '\\nuseKeyTab=true\\nprincipal=\\\"HTTP/server.hopsworks.ai@HOPSWORKS.AI\\\"\\nstoreKey=true\\nisInitiator=false' ldap : jndilookupname : \"dc=hopsworks,dc=ai\" provider_url : \"ldap://193.10.66.104:1389\" attr_binary_val : \"objectGUID\" security_auth : \"none\" security_principal : \"\" security_credentials : \"\" referral : \"ignore\" additional_props : \"\" Both Kerberos and LDAP attributes need to be specified to configure Kerberos. The LDAP attributes are explained above. krb_conf_path: contains the path to the krb5.conf used by SPNEGO to get information about the default domain and the location of the Kerberos KDC. The file is copied by the recipe in to /srv/hops/domains/domain1/config. krb_server_key_tab_path: contains the path to the Kerberos service keytab. The keytab is copied by the recipe in to /srv/hops/domains/domain/config with the name set in the krb_server_key_tab_name attribute. spnego_server_conf: contains the configuration that will be appended to Payara's (application serve used to host hopsworks) login.conf. In particular, it should contain useKeyTab=true, and the principal name to be used in the authentication phase. Initiator should be set to false.","title":"Server Configuration for Kerberos"},{"location":"admin/oauth2/create-azure-client/","text":"Create An Application in Azure Active Directory. # This example uses Azure Active Directory as the identity provider, but the same can be done with any identity provider supporting OAuth2. Configure your identity provider. # To use OAuth2 in hopsworks you first need to create and configure an OAuth client in your identity provider. We will take the example of Azure AD for the remaining of this documentation, but equivalent steps can be taken on other identity providers. Navigate to the Microsoft Azure Portal and authenticate. Navigate to Azure Active Directory . Click on App Registrations . Click on New Registration . Create application Enter a name for the client such as hopsworks_oauth_client . Verify the Supported account type is set to Accounts in this organizational directory only . And Click Register. Name application In the Overview section, copy the Application (client) ID field . We will use it in Identity Provider registration under the name Client id . Copy client ID Click on Endpoints and copy the OpenId Connect metadata document endpoint excluding the .well-known/openid-configuration part. We will use it in Identity Provider registration under the name Connection URL . Endpoint Click on Certificates & secrets , then Click on New client secret . New client secret Add a description of the secret. Select an expiration period. And, Click Add . Client secret creation Copy the secret. This will be used in Identity Provider registration under the name Client Secret . Client secret creation Click on Authentication . Then click on Add a platform Add a platform In Configure platforms click on Web . Configure platform: Web Enter the Redirect URI and click on Configure . The redirect URI is HOPSWORKS-URI/callback with HOPSWORKS-URI the URI of your hopsworks cluster. Configure platform: Redirect Note If your hopsworks cluster is created on the cloud (hopsworks.ai), you can find your HOPSWORKS-URI by going to the hopsworks.ai dashboard in the General tab of your cluster and copying the URI.","title":"Create Azure Client"},{"location":"admin/oauth2/create-azure-client/#create-an-application-in-azure-active-directory","text":"This example uses Azure Active Directory as the identity provider, but the same can be done with any identity provider supporting OAuth2.","title":"Create An Application in Azure Active Directory."},{"location":"admin/oauth2/create-azure-client/#configure-your-identity-provider","text":"To use OAuth2 in hopsworks you first need to create and configure an OAuth client in your identity provider. We will take the example of Azure AD for the remaining of this documentation, but equivalent steps can be taken on other identity providers. Navigate to the Microsoft Azure Portal and authenticate. Navigate to Azure Active Directory . Click on App Registrations . Click on New Registration . Create application Enter a name for the client such as hopsworks_oauth_client . Verify the Supported account type is set to Accounts in this organizational directory only . And Click Register. Name application In the Overview section, copy the Application (client) ID field . We will use it in Identity Provider registration under the name Client id . Copy client ID Click on Endpoints and copy the OpenId Connect metadata document endpoint excluding the .well-known/openid-configuration part. We will use it in Identity Provider registration under the name Connection URL . Endpoint Click on Certificates & secrets , then Click on New client secret . New client secret Add a description of the secret. Select an expiration period. And, Click Add . Client secret creation Copy the secret. This will be used in Identity Provider registration under the name Client Secret . Client secret creation Click on Authentication . Then click on Add a platform Add a platform In Configure platforms click on Web . Configure platform: Web Enter the Redirect URI and click on Configure . The redirect URI is HOPSWORKS-URI/callback with HOPSWORKS-URI the URI of your hopsworks cluster. Configure platform: Redirect Note If your hopsworks cluster is created on the cloud (hopsworks.ai), you can find your HOPSWORKS-URI by going to the hopsworks.ai dashboard in the General tab of your cluster and copying the URI.","title":"Configure your identity provider."},{"location":"admin/oauth2/create-client/","text":"Register Identity Provider in Hopsworks # Before registering your identity provider in Hopsworks you need to create a client application in your identity provider and acquire a client id and a client secret . An example on how to create a client using Okta and Azure Active Directory identity providers can be found here and here respectively. After acquiring the client id and client secret create the client in Hopsworks by enabling OAuth2 and clicking on add another identity provider in the Authentication configuration page . Then set base uri of your identity provider in Connection URL give a name to your identity provider (the name will be used in the login page as an alternative login method) and set the client id and client secret in their respective fields, as shown in the figure below. Application overview Connection URL : (provider Uri) is the base uri of the identity provider's API (URI should contain scheme http:// or https://). Additional configuration can be set here: Verify email : if checked only users with verified email address (in the identity provider) can log in to Hopsworks. Code challenge : if your identity provider requires code challenge for authorization request check the code challenge check box. This will allow you to choose code challenge method that can be either plain or S256 . Logo URL : optionally a logo URL to an image can be added. The logo will be shown on the login page with the name as shown in the figure below. Group mapping # Optionally you can add a group mapping from your identity provider to hopsworks groups, by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Cluster Settings Configuration tab search for oauth_group_mapping and click on the edit button. Set Configuration variables Note Setting oauth_group_mapping to ANY_GROUP->HOPS_USER will assign the role user to any user from any group in your identity provider when they log into hopsworks with OAuth for the first time. You can replace ANY_GROUP with the group of your choice in the identity provider. You can replace HOPS_USER by HOPS_ADMIN if you want the users of that group to be admins in hopsworks. You can do several mappings by separating them with a semicolon. Users will now see a new button on the login page. The button has the name you set above for Name and will redirect to your identity provider. Login with OAuth2 Note When creating a client make sure you can access the provider metadata by making a GET request on the well known endpoint of the provider. The well-known URL, will typically be the Connection URL plus .well-known/openid-configuration . For the above client it would be https://dev-86723251.okta.com/.well-known/openid-configuration .","title":"Register an Identity Provider"},{"location":"admin/oauth2/create-client/#register-identity-provider-in-hopsworks","text":"Before registering your identity provider in Hopsworks you need to create a client application in your identity provider and acquire a client id and a client secret . An example on how to create a client using Okta and Azure Active Directory identity providers can be found here and here respectively. After acquiring the client id and client secret create the client in Hopsworks by enabling OAuth2 and clicking on add another identity provider in the Authentication configuration page . Then set base uri of your identity provider in Connection URL give a name to your identity provider (the name will be used in the login page as an alternative login method) and set the client id and client secret in their respective fields, as shown in the figure below. Application overview Connection URL : (provider Uri) is the base uri of the identity provider's API (URI should contain scheme http:// or https://). Additional configuration can be set here: Verify email : if checked only users with verified email address (in the identity provider) can log in to Hopsworks. Code challenge : if your identity provider requires code challenge for authorization request check the code challenge check box. This will allow you to choose code challenge method that can be either plain or S256 . Logo URL : optionally a logo URL to an image can be added. The logo will be shown on the login page with the name as shown in the figure below.","title":"Register Identity Provider in Hopsworks"},{"location":"admin/oauth2/create-client/#group-mapping","text":"Optionally you can add a group mapping from your identity provider to hopsworks groups, by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Cluster Settings Configuration tab search for oauth_group_mapping and click on the edit button. Set Configuration variables Note Setting oauth_group_mapping to ANY_GROUP->HOPS_USER will assign the role user to any user from any group in your identity provider when they log into hopsworks with OAuth for the first time. You can replace ANY_GROUP with the group of your choice in the identity provider. You can replace HOPS_USER by HOPS_ADMIN if you want the users of that group to be admins in hopsworks. You can do several mappings by separating them with a semicolon. Users will now see a new button on the login page. The button has the name you set above for Name and will redirect to your identity provider. Login with OAuth2 Note When creating a client make sure you can access the provider metadata by making a GET request on the well known endpoint of the provider. The well-known URL, will typically be the Connection URL plus .well-known/openid-configuration . For the above client it would be https://dev-86723251.okta.com/.well-known/openid-configuration .","title":"Group mapping"},{"location":"admin/oauth2/create-okta-client/","text":"Create An Application in Okta # This example uses an Okta development account to create an application that will represent a Hopsworks client in the identity provider. To create a developer account go to Okta developer . After creating a developer account register a client by going to Applications and click on Create App Integration . Okta Applications This will open a popup as shown in the figure below. Select OIDC as Sign-in-method and Web Application as Application type and click next. Create new Application Give your application a name and select Client credential as Grant Type . Then add a Sign-in redirect URI that is your Hopsworks cluster domain name (including the port number if needed) with path /callback , and a Sign-out redirect URI that is Hopsworks cluster domain name (including the port number if needed) with no path. New Application If you want to limit who can access your Hopsworks cluster select Limit access to selected groups and select group(s) you want to give access to. Here we will allow everyone in the organization to access the cluster. Group assignment Group mapping # You can also create mappings from groups in Okta to groups in Hopsworks. To achieve this you need to configure Okta to send Groups with user information. To do this go to Applications and select your application name. In the Sign On tab click edit OpenID Connect ID Token and select Filter for Groups claim type , then for Groups claim filter add groups as the claim name, select Match Regex from the dropdown and .* (dot star) as Regex to match all groups. See Group mapping on how to do the mapping in Hopsworks. Group claim After the application is created go back to Applications and click on the application you just created. Use the Okta domain ( Connection URL ), client id and client secret generated for your app in the Identity Provider registration in Hopsworks. Application overview Note When copying the domain in the figure above make sure to add the url scheme (http:// or https://) when using it in the Connection URL in the Identity Provider registration form .","title":"Create Okta Client"},{"location":"admin/oauth2/create-okta-client/#create-an-application-in-okta","text":"This example uses an Okta development account to create an application that will represent a Hopsworks client in the identity provider. To create a developer account go to Okta developer . After creating a developer account register a client by going to Applications and click on Create App Integration . Okta Applications This will open a popup as shown in the figure below. Select OIDC as Sign-in-method and Web Application as Application type and click next. Create new Application Give your application a name and select Client credential as Grant Type . Then add a Sign-in redirect URI that is your Hopsworks cluster domain name (including the port number if needed) with path /callback , and a Sign-out redirect URI that is Hopsworks cluster domain name (including the port number if needed) with no path. New Application If you want to limit who can access your Hopsworks cluster select Limit access to selected groups and select group(s) you want to give access to. Here we will allow everyone in the organization to access the cluster. Group assignment","title":"Create An Application in Okta"},{"location":"admin/oauth2/create-okta-client/#group-mapping","text":"You can also create mappings from groups in Okta to groups in Hopsworks. To achieve this you need to configure Okta to send Groups with user information. To do this go to Applications and select your application name. In the Sign On tab click edit OpenID Connect ID Token and select Filter for Groups claim type , then for Groups claim filter add groups as the claim name, select Match Regex from the dropdown and .* (dot star) as Regex to match all groups. See Group mapping on how to do the mapping in Hopsworks. Group claim After the application is created go back to Applications and click on the application you just created. Use the Okta domain ( Connection URL ), client id and client secret generated for your app in the Identity Provider registration in Hopsworks. Application overview Note When copying the domain in the figure above make sure to add the url scheme (http:// or https://) when using it in the Connection URL in the Identity Provider registration form .","title":"Group mapping"},{"location":"concepts/hopsworks/","text":"Hopsworks is a modular MLOps platform with: a feature store (available as standalone) model registry and model serving based on KServe vector database based on OpenSearch a data science and data engineering platform Standalone Feature Store # Hopsworks was the first open-source and first enterprise feature store for ML. You can use Hopsworks as a standalone feature store with the HSFS API. Model Management # Hopsworks includes support for model management, with model deployments using the KServe framework and a model registry designed for KServe. Hopsworks logs all inference requests to Kafka to enable easy monitoring of deployed models, and provides model metrics with grafana/prometheus. Vector DB # Hopsworks provides a vector database (or embedding store) based on OpenSearch kNN ( FAISS and nmslib ). Hopsworks Vector DB includes out-of-the-box support for authentication, access control, filtering, backup-and-restore, and horizontal scalability. Hopsworks' Feature Store and vector DB are often used together to build scalable recommender systems, such as ranking-and-retrieval for real-time recommendations. Governance # Hopsworks provides a data-mesh architecture for managing ML assets and teams, with multi-tenant projects. Not unlike a github repository, a project is a sandbox containing team members, data, and ML assets. In Hopsworks, all ML assets (features, models, training data) are versioned, taggable, lineage-tracked, and support free-text search. Data can be also be securely shared between projects. Data Science Platform # You can develop feature engineering pipelines and training pipelines in Hopsworks. There is support for version control (github, gitlab, bitbucket), Jupyter notebooks, a shared distriubted file system, per project conda environments for managing python dependencies without needing to write Dockerfiles, jobs (Python, Spark, Flink), and workflow orchestration with Airflow.","title":"Hopsworks Platform"},{"location":"concepts/hopsworks/#standalone-feature-store","text":"Hopsworks was the first open-source and first enterprise feature store for ML. You can use Hopsworks as a standalone feature store with the HSFS API.","title":"Standalone Feature Store"},{"location":"concepts/hopsworks/#model-management","text":"Hopsworks includes support for model management, with model deployments using the KServe framework and a model registry designed for KServe. Hopsworks logs all inference requests to Kafka to enable easy monitoring of deployed models, and provides model metrics with grafana/prometheus.","title":"Model Management"},{"location":"concepts/hopsworks/#vector-db","text":"Hopsworks provides a vector database (or embedding store) based on OpenSearch kNN ( FAISS and nmslib ). Hopsworks Vector DB includes out-of-the-box support for authentication, access control, filtering, backup-and-restore, and horizontal scalability. Hopsworks' Feature Store and vector DB are often used together to build scalable recommender systems, such as ranking-and-retrieval for real-time recommendations.","title":"Vector DB"},{"location":"concepts/hopsworks/#governance","text":"Hopsworks provides a data-mesh architecture for managing ML assets and teams, with multi-tenant projects. Not unlike a github repository, a project is a sandbox containing team members, data, and ML assets. In Hopsworks, all ML assets (features, models, training data) are versioned, taggable, lineage-tracked, and support free-text search. Data can be also be securely shared between projects.","title":"Governance"},{"location":"concepts/hopsworks/#data-science-platform","text":"You can develop feature engineering pipelines and training pipelines in Hopsworks. There is support for version control (github, gitlab, bitbucket), Jupyter notebooks, a shared distriubted file system, per project conda environments for managing python dependencies without needing to write Dockerfiles, jobs (Python, Spark, Flink), and workflow orchestration with Airflow.","title":"Data Science Platform"},{"location":"concepts/dev/inside/","text":"Hopsworks supports development in Jupyter notebooks, running in Hopsworks. You can also develop programs in Python, Spark, Flink outside of Hopsworks, and run them as jobs inside Hopsworks. Jobs can be run: from the UI; with the Hopsworks Jobs API; from Airflow programs; in your IDE using a plugin (PyCharm Hopsworks plugin); Jupyter: Conda Env + Docker Image: Git:","title":"Inside Hopsworks"},{"location":"concepts/dev/outside/","text":"You can write programs that use Hopsworks in any Python, Spark or PySpark environment. Hopsworks also supports Flink and SQL in external data warehouses used as a feature store for offline features. There is REST API for Hopsworks that can be used with a valid API key, generated in Hopsworks. There are SDKs available in Python and Java/Scala for HSFS, in Python for HSML, and in Python for the Hopsworks API.","title":"Outside Hopsworks"},{"location":"concepts/fs/","text":"What is Hopsworks Feature Store? # Hopsworks and its Feature Store are an open source data-intensive AI platform used for the development and operation of machine learning models at scale. The Hopsworks Feature Store provides the HSFS API to enable clients to write features to feature groups in the feature store, and to read features from feature views - either through a low latency Online API to retrieve pre-computed features for operational models or through a high throughput, latency insensitive Offline API, used to create training data and to retrieve batch data for scoring. HSFS API # The HSFS (HopsworkS Feature Store) API is how you, as a developer, will use the feature store. The HSFS API helps simplify some of the problems that feature stores address including: consistent features for training and serving centralized, secure access to features point-in-time JOINs of features to create training data with no data leakage easier connection and backfilling of features from external data sources use of external tables as features transparent computation of statistics and usage data for features. Write to feature groups, read from feature views. # You write to feature groups with a feature pipeline program. The program can be written in Python, Spark, Flink, or SQL. You read from views on top of the feature groups, called feature views. That is, a feature view does not store feature data, but is a logical grouping of features. Typically, you define a feature view because you want to train/deploy a model with exactly those features in the feature view. Feature views enable the reuse of feature data from different feature groups across different models.","title":"Architecture"},{"location":"concepts/fs/#what-is-hopsworks-feature-store","text":"Hopsworks and its Feature Store are an open source data-intensive AI platform used for the development and operation of machine learning models at scale. The Hopsworks Feature Store provides the HSFS API to enable clients to write features to feature groups in the feature store, and to read features from feature views - either through a low latency Online API to retrieve pre-computed features for operational models or through a high throughput, latency insensitive Offline API, used to create training data and to retrieve batch data for scoring.","title":"What is Hopsworks Feature Store?"},{"location":"concepts/fs/#hsfs-api","text":"The HSFS (HopsworkS Feature Store) API is how you, as a developer, will use the feature store. The HSFS API helps simplify some of the problems that feature stores address including: consistent features for training and serving centralized, secure access to features point-in-time JOINs of features to create training data with no data leakage easier connection and backfilling of features from external data sources use of external tables as features transparent computation of statistics and usage data for features.","title":"HSFS API"},{"location":"concepts/fs/#write-to-feature-groups-read-from-feature-views","text":"You write to feature groups with a feature pipeline program. The program can be written in Python, Spark, Flink, or SQL. You read from views on top of the feature groups, called feature views. That is, a feature view does not store feature data, but is a logical grouping of features. Typically, you define a feature view because you want to train/deploy a model with exactly those features in the feature view. Feature views enable the reuse of feature data from different feature groups across different models.","title":"Write to feature groups, read from feature views."},{"location":"concepts/fs/feature_group/external_fg/","text":"External feature groups are offline feature groups where their data is stored in an external table. An external table requires a storage connector, defined with the Connector API (or more typically in the user interface), to enable HSFS to retrieve data from the external table. An external table includes a user-defined SQL string for retrieving data, but you also perform SQL operations, including projections, aggregations, and so on. The SQL query is executed on-demand when HSFS retrieves data from the external Feature Group, for example, when creating training data using features in the external table. In the image below, we can see that HSFS currently supports a large number of data sources, including any JDBC-enabled source, Snowflake, Data Lake, Redshift, BigQuery, S3, ADLS, GCS, and Kafka","title":"External Feature Groups"},{"location":"concepts/fs/feature_group/feature_pipelines/","text":"A feature pipeline is a program that orchestrates the execution of a dataflow graph of data validation, aggregation, transformation, and other feature engineering steps on input data to create and/or update feature values. With HSFS, you can write feature pipelines in different languages as shown in the figure below. Python is the most widely used framework for feature engineering due to it extensive library support for aggregations (Pandas), data validation (Great Expectations), and transformations (in Scikit-Learn, TensorFlow, PyTorch, etc). SQL has grown in popularity for performing heavy lifting in feature pipelines - computing aggregates on data - when the input data already resides in a data warehouse. However, SQL is limited in its support for data validation (Great Expectations support in DBT is one way to do data validation for SQL) and transformations. Spark provides scalable, general-purpose support for feature engineering, with aggregations, data validation (Great Expecations and Deequ, for example), and transformations. Flink is used for feature engineering when you need very fresh features computed in real-time. Alerting # HSFS also supports alerts, that can be triggered when there are problems in your feature pipelines, for example, when a write fails due to an error or a failed expectation. You can send alerts to different alerting endpoints, such as email or Slack, that can be configured in the Hopsworks UI.","title":"Feature Pipelines"},{"location":"concepts/fs/feature_group/feature_pipelines/#alerting","text":"HSFS also supports alerts, that can be triggered when there are problems in your feature pipelines, for example, when a write fails due to an error or a failed expectation. You can send alerts to different alerting endpoints, such as email or Slack, that can be configured in the Hopsworks UI.","title":"Alerting"},{"location":"concepts/fs/feature_group/fg_overview/","text":"As a programmer, you can consider a feature, in machine learning, to be a variable associated with some entity that contains a value that is useful for helping train a model to solve a prediction problem. That is, the feature is just a variable with predictive power for a machine learning problem, or task. A feature group is a table of features, where each feature group has a primary key, and optionally an event_time column (indicating when the features in that row were observed), and a partition key. Collectively, they are referred to as columns. The partition key determines how to layout the feature group rows on disk such that you can efficiently query the data using queries with the partition key. For example, if your partition key is the day and you have hundreds of days worth of data, with a partition key, you can query the day for only a given day or a range of days, and only the data for those days will be read from disk. Online and offline Storage # Feature groups can be stored in a low-latency \"online\" database and/or in low cost, high throughput \"offline\" storage, typically a data lake or data warehouse. The online store stores only the latest values of features for a feature group. It is used to serve pre-computed features to models at runtime. The offline store stores the historical values of features for a feature group, so it may store many times more data than the online store. Offline feature groups are used, typically, to create training data for models, but also to retrieve data for batch scoring of models:","title":"FG Overview"},{"location":"concepts/fs/feature_group/fg_overview/#online-and-offline-storage","text":"Feature groups can be stored in a low-latency \"online\" database and/or in low cost, high throughput \"offline\" storage, typically a data lake or data warehouse. The online store stores only the latest values of features for a feature group. It is used to serve pre-computed features to models at runtime. The offline store stores the historical values of features for a feature group, so it may store many times more data than the online store. Offline feature groups are used, typically, to create training data for models, but also to retrieve data for batch scoring of models:","title":"Online and offline Storage"},{"location":"concepts/fs/feature_group/fg_statistics/","text":"HSFS supports monitoring, validation, and alerting for features: transparently compute statistics over features on writing to a feature group; validation of data written to feature groups using Great Expectations alerting users when there was a problem writing or update features. You can define expectation suites in Great Expectations and assoicate them with feature groups. When you write to a feature group, the expectations are executed, then you can define a policy on the feature group for what to do if any expectation fails. Alerting # HSFS also supports alerts that can be triggered when expectations fail. For example, you can send a slack message if features being written to a feature group are missing some input data.","title":"Feature Validation/Statistics"},{"location":"concepts/fs/feature_group/fg_statistics/#alerting","text":"HSFS also supports alerts that can be triggered when expectations fail. For example, you can send a slack message if features being written to a feature group are missing some input data.","title":"Alerting"},{"location":"concepts/fs/feature_group/storage_connector/","text":"","title":"Storage connector"},{"location":"concepts/fs/feature_group/versioning/","text":"Data Versioning of a feature group involves tracking updates to the feature group, so that you can recover the state of the feature group at a given point-in-time in the past. The schema of feature groups is also versioned. If you make a breaking change to the schema of a feature group, you need to increment the version of the feature group, and then backfill the new feature group. A breaking schema change is when you: drop a column from the schema add a new fature without any default value for the new feature change how a feature is computed, such that, for training models, the data for the old feature is not compatible with the data for the new feature. For example, if you have an embedding as a feature and change the algorithm to compute that embedding, you probably should not mix feature values computed with the old embedding model with feature values computed with the new embedding model.","title":"Versioning"},{"location":"concepts/fs/feature_group/write_apis/","text":"You write to feature groups, and read from feature views. There are 3 APIs for writing to feature groups, as shown in the table below: Stream API Batch API Connector API Python X - - Spark X X - Flink X - - External Table - - X Stream API # The Stream API is the only API for Python and Flink clients, and is the preferred API for Spark, as it ensures consistent features between offline and online feature stores. The Stream API first writes data to be ingested to a Kafka topic, and then Hopsworks ensures that the data is synchronized to the Online and Offline Feature Groups through the OnlineFS service and Hudi DeltaStreamer jobs, respectively. The data in the feature groups is guaranteed to arrive at-most-once, through idempotent writes to the online feature group (only the latest values of features are stored there, and duplicates in Kafka only cause idempotent updates) and duplicate removal by Apache Hudi for the offline feature group. Batch API # For very large updates to feature groups, such as when you are backfilling large amounts of data to an offline feature group, it is often preferential to write directly to the Hudi tables in Hopsworks, instead of via Kafka - thus reducing write amplification. Spark clients can write directly to Hudi tables on Hopsworks with Hopsworks libraries and certificates using a HDFS API. This requires network connectivity between the Spark clients and the datanodes in Hopsworks. Connector API # Hopsworks supports external tables as feature groups. You can mount a table from an external database as an offline feature group using the Connector API - you create an external table using the connector. This enables you to use features from your external data source (Snowflake, Redshift, Delta Lake, etc) as you would any feature in an offline feature group in Hopsworks. You can, for example, join features from different feature groups (external or not) together to create feature views and training data for models.","title":"Write APIs"},{"location":"concepts/fs/feature_group/write_apis/#stream-api","text":"The Stream API is the only API for Python and Flink clients, and is the preferred API for Spark, as it ensures consistent features between offline and online feature stores. The Stream API first writes data to be ingested to a Kafka topic, and then Hopsworks ensures that the data is synchronized to the Online and Offline Feature Groups through the OnlineFS service and Hudi DeltaStreamer jobs, respectively. The data in the feature groups is guaranteed to arrive at-most-once, through idempotent writes to the online feature group (only the latest values of features are stored there, and duplicates in Kafka only cause idempotent updates) and duplicate removal by Apache Hudi for the offline feature group.","title":"Stream API"},{"location":"concepts/fs/feature_group/write_apis/#batch-api","text":"For very large updates to feature groups, such as when you are backfilling large amounts of data to an offline feature group, it is often preferential to write directly to the Hudi tables in Hopsworks, instead of via Kafka - thus reducing write amplification. Spark clients can write directly to Hudi tables on Hopsworks with Hopsworks libraries and certificates using a HDFS API. This requires network connectivity between the Spark clients and the datanodes in Hopsworks.","title":"Batch API"},{"location":"concepts/fs/feature_group/write_apis/#connector-api","text":"Hopsworks supports external tables as feature groups. You can mount a table from an external database as an offline feature group using the Connector API - you create an external table using the connector. This enables you to use features from your external data source (Snowflake, Redshift, Delta Lake, etc) as you would any feature in an offline feature group in Hopsworks. You can, for example, join features from different feature groups (external or not) together to create feature views and training data for models.","title":"Connector API"},{"location":"concepts/fs/feature_view/create_fv/","text":"","title":"Create fv"},{"location":"concepts/fs/feature_view/fv_overview/","text":"A feature view is a logical view over (or interface to) a set of features that may come from different feature groups. You create a feature view by joining together features from existing feature groups. In the illustration below, we can see that features are joined together from the two feature groups: seller_delivery_time_monthly and the seller_reviews_quarterly. You can also see that features in the feature view inherit not only the feature type from their feature groups, but also whether they are the primary key and/or the event_time. The image also includes transformation functions that are applied to individual features. Transformation functions are a part of the feature types included in the feature view. That is, a feature in a feature view is not only defined by its data type (int, string, etc) or its feature type (categorical, numerical, embedding), but also by its transformation. Feature views can also include: the label for the supervised ML problem transformation functions that should be applied to specified features consistently between training and serving the ability to create training data the ability to retrieve a feature vector with the most recent feature values In the flow chart below, we can see the decisions that can be taken when creating (1) a feature view, and (2) creating training data with the feature view. We can see here how the feature view is a representation for a model in the feature store - the same feature view is used to retrieve feature vectors for operational model that was created with training data from this feature view. As such, you can see that the most common use case for creating a feature view is to define the features that will be used in a model. In this way, feature views enable features from different feature groups to be reused across different models, and if features are stored untransfromed in feature groups, they become even more reusable, as different feature views can apply different transformations to the same feature.","title":"FV Overview"},{"location":"concepts/fs/feature_view/online_api/","text":"A feature vector is a row of features (without the primary key(s) and event timestamp): The Feature View's online API provides methods to return an individual feature vector, or a batch of feature vectors, containing the latest feature values, given a valid primary key for the feature view. It may be the case that some features should not be retrieved from the feature store, but are supplied by the client. We call these 'passed' features and, similar to precomputed features from the feature store, they can also be transformed by the HSFS client in the method: feature_view.get_feature_vector( , passed={ .... })","title":"Online API"},{"location":"concepts/fs/feature_view/statistics/","text":"The feature view does not contain any statistics, as it is simply an interface consisting of a number of features and any transformation functions applied to those features. However, training data can have descriptive statistics over it computed by HSFS. Descriptive statistics for training data is important for model monitoring, as it can enable model monitoring. If you compute the same descriptive statistics over windows of input features to models, you can help determine when there is a significant change in the distribution of an input feature, so-called feature shift.","title":"Statistics"},{"location":"concepts/fs/feature_view/training_data/","text":"Training data is created using a feature view. You can create training data as either: in-memory Pandas DataFrames, useful when you have a small amount of training data; materialized training data in files, in a file format of your choice (such as .tfrecord, .csv, or .parquet). You can apply filters when creating training data from a feature view: start-time and end-time, for example, to create the train-set from an earlier time range, and the test-set from a later (unseen) time range; feature value features, for example, only train a model on customers from a particular country. Note that filters are not applied when retrieving feature vectors using feature views, as we only look up features for a specific entity, like a customer. In this case, the application should know that predictions for this customer should be made on the model trained on customers in USA, for example. Point-in-time Correct JOINs # When you create training data from features in different feature groups, it is possible that the feature groups are updated at different cadences. For example, maybe one feature group is updated hourly, while another feature group is updated daily. It is very complex to write code that joins features together from such feature groups and ensures there is no data leakage in the resultant training data. HSFS hides this complexity by performing the point-in-time JOIN transparently, similar to the illustration below: HSFS uses the event_time columns on both feature groups to determine the most recent (but not newer) feature values that are joined together with the feature values from the feature group containing the label. That is, the features in the feature group containinig the label are the observation times for the features in the resulting training data, and we want feature values from the other feature groups that have the most recent timestamps, but not newer than the timestamp in the label-containing feature group.","title":"Training Data"},{"location":"concepts/fs/feature_view/training_data/#point-in-time-correct-joins","text":"When you create training data from features in different feature groups, it is possible that the feature groups are updated at different cadences. For example, maybe one feature group is updated hourly, while another feature group is updated daily. It is very complex to write code that joins features together from such feature groups and ensures there is no data leakage in the resultant training data. HSFS hides this complexity by performing the point-in-time JOIN transparently, similar to the illustration below: HSFS uses the event_time columns on both feature groups to determine the most recent (but not newer) feature values that are joined together with the feature values from the feature group containing the label. That is, the features in the feature group containinig the label are the observation times for the features in the resulting training data, and we want feature values from the other feature groups that have the most recent timestamps, but not newer than the timestamp in the label-containing feature group.","title":"Point-in-time Correct JOINs"},{"location":"concepts/fs/feature_view/transformations/","text":"Hopsworks feature store helps prevent training-serving skew , where different feature transformation functions are used when creating training data and when serving features online, by providing transformation functions that can be attached to features in a feature view. When training data is created with a feature view or when a feature vector is retrieved from a feature view, HSFS ensures that any transformation functions defined over any features in the feature view will be applied before returning feature values. Transformation functions are Python UDFs (user-defined functions), and each transformation function takes a feature values as input, with a well-defined input type, and returns an output based on the well-defined output schema. There are built-in transformation functions in HSFS, such as minmax_scalar, and you can write your own custom transformation functions as Python UDFs.","title":"Consistent Transformations"},{"location":"concepts/fs/feature_view/versioning/","text":"Feature views are interfaces, and if there is a change in the interface (the types of the features, the transformations applied to the features), then you need to change the version, to prevent breaking existing clients. Training datasets are associated with a specific feature view version, and have their own version.","title":"Versioning"},{"location":"concepts/mlops/flywheel/","text":"The MLOps flywheel is the path to production for most machine learning projects. You need to setup a flywheel to enable more data to be generated from your existing operational or batch services, and that data should be fed into the feature store, where it can be used to train bettter models. With better models, you should hopefully improve you operational/batch services, so that you attract more clients, who in turn produce more data for training models. And so on. Offline vs Online Infrastructure # ML Assets and Provenance # Tags, keywords, search","title":"MLOps Flywheel"},{"location":"concepts/mlops/flywheel/#offline-vs-online-infrastructure","text":"","title":"Offline vs Online Infrastructure"},{"location":"concepts/mlops/flywheel/#ml-assets-and-provenance","text":"Tags, keywords, search","title":"ML Assets and Provenance"},{"location":"concepts/mlops/governance/","text":"","title":"Governance"},{"location":"concepts/mlops/kserve/","text":"KServe is an open-source framework for model serving on Kubernetes. A KServe model deploy can include the following components: Transformer Predictors Loggers Versioning","title":"KServe"},{"location":"concepts/mlops/mlops/","text":"","title":"Mlops"},{"location":"concepts/mlops/opensearch/","text":"Hopsworks includes OpenSearch as a multi-tenant service in projects. OpenSearch provides vector database capabilities throught its k-NN plugin, that supports the FAISS and nsmlib embedding indexes. Through Hopsworsk, OpenSearch also provides enterprise capabilities, including authentication and access control to indexes (an index can be private to a Hopsworks project), filtering, scalability, high availability, and disaster recovery support.","title":"Vector Database"},{"location":"concepts/mlops/projects/","text":"","title":"Projects"},{"location":"concepts/mlops/registry/","text":"Hopsworks Model Registry enables developers to publish, test, monitor, govern and share models for collaboration with other teams. The model registry is where developers publish their models during the experimentation phase. The model registry can also be used to share models with the team and stakeholders. The model registry centralizes model management, enabling models to be securely accessed and governed. Models are more than just the model itself - the registry also stores sample data for testsing, configuration information, provenance information, environment variables, links to the code used to generate the model, the model version, and tags/descriptions). Model Package # Model Schema Model artifacts Model version information Model format (based on the ML framework used to train the model - e.g., .pkl or .tb files) You can also optionally include in your packaged model: - Sample data (used to test the model in KServe) - The source notebook/program/experiment used to create the model","title":"Model Registry"},{"location":"concepts/mlops/registry/#model-package","text":"Model Schema Model artifacts Model version information Model format (based on the ML framework used to train the model - e.g., .pkl or .tb files) You can also optionally include in your packaged model: - Sample data (used to test the model in KServe) - The source notebook/program/experiment used to create the model","title":"Model Package"},{"location":"concepts/projects/cicd/","text":"","title":"CI/CD"},{"location":"concepts/projects/governance/","text":"Hopsworks provides project-level multi-tenancy, a data mesh enabling technology. Think of it as a Github repository for your teams and ML assets. More specifically, a project is a sandbox for team members, ML assets (features, training data, models, vector database, model deployments), and optionally feature pipelines and training pipelines. The ML assets can only be accessed by project members, and there is role-based access control (RBAC) for project members within a project. Dev/Staging/Prod for Data # Projects enable you to define devlopment, staging, and even production projects on the same cluster. Often, companies deploy production projects on dedicated clusters, but development projects and staging projects on a shared cluster. This way, projects can be easily used to implement CI/CD workflows. Data Mesh of Feature Stores # Projects enable you to move beyond the traditional dev/staging/prod ownership model for data. Different teams or lines of business can have their own private feature stores, you can mix them with a group-wide feature store, and feature stores can be securely shared between teams/organizations. Effectively, you can have decentralized ownership of feature stores, with domain-specific projects, and each project managing its own feature pipelines. Hopsworks provides data/feature sharing support between these self-service projects. Audit Logs with REST API # Hopsworks stores audit logs for all calls on its REST API in its file system, HopsFS. The audit log can be used to analyze the historical usage of services by users.","title":"Governance"},{"location":"concepts/projects/governance/#devstagingprod-for-data","text":"Projects enable you to define devlopment, staging, and even production projects on the same cluster. Often, companies deploy production projects on dedicated clusters, but development projects and staging projects on a shared cluster. This way, projects can be easily used to implement CI/CD workflows.","title":"Dev/Staging/Prod for Data"},{"location":"concepts/projects/governance/#data-mesh-of-feature-stores","text":"Projects enable you to move beyond the traditional dev/staging/prod ownership model for data. Different teams or lines of business can have their own private feature stores, you can mix them with a group-wide feature store, and feature stores can be securely shared between teams/organizations. Effectively, you can have decentralized ownership of feature stores, with domain-specific projects, and each project managing its own feature pipelines. Hopsworks provides data/feature sharing support between these self-service projects.","title":"Data Mesh of Feature Stores"},{"location":"concepts/projects/governance/#audit-logs-with-rest-api","text":"Hopsworks stores audit logs for all calls on its REST API in its file system, HopsFS. The audit log can be used to analyze the historical usage of services by users.","title":"Audit Logs with REST API"},{"location":"concepts/projects/storage/","text":"","title":"Data Storage/Sharing"},{"location":"getting_started/fs/fs_gs/","text":"Getting Started: Feature Store #","title":"Getting Started: Feature Store"},{"location":"getting_started/fs/fs_gs/#getting-started-feature-store","text":"","title":"Getting Started: Feature Store"},{"location":"getting_started/fs/tutorials/aml/","text":"","title":"AML Tutorial"},{"location":"reference_guides/","text":"Feature Store API Machine Learning API Services API","title":"API"},{"location":"setup_installation/aws/cluster_creation/","text":"Getting started with Hopsworks.ai (AWS) # This guide goes into detail for each of the steps of the cluster creation in Hopsworks.ai Step 1 starting to create a cluster # In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Step 2 setting the General information # Create a Hopsworks cluster, general information Select the Region in which you want your cluster to run (1), name your cluster (2). Select the Instance type (3) and Local storage (4) size for the cluster Head node . S3 bucket configuration # Enter the name of the S3 bucket (5) you want the cluster to store its data in. Note The S3 bucket you are using must be empty. Premium users have the option to use encrypted S3 buckets . To configure an encrypted bucket click on the Advanced tab and select the appropriate encryption type. Note Encryption must have been already enabled for the bucket We support the following encryption schemes: SSE-S3 SSE-KMS S3 managed key User managed key Users can also select an AWS canned ACLs for the objects: bucket-owner-full-control On the main page, you can also choose to aggregate logs in CloudWatch and to opt out of hopsworks.ai log collection. The first one is to aggregate the logs of services running in your cluster in CloudWatch service in your configured AWS account. This can be useful if you want to understand what is happening on your cluster, without having to ssh into the instances. The second one is for hopsworks.ai to collect logs about the services running in your cluster. These logs will help us improve our system and provide support. If you choose to opt-out from the log collection and need support you will have to provide us the log by yourself, which will slow down the support process. Step 3 workers configuration # In this step, you configure the workers. There are two possible setups static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: the documentation . In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand. Static workers configuration # You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes . Create a Hopsworks cluster, static workers configuration Autoscaling workers configuration # You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You then have access to a two parts form allowing you to configure the autoscaling. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Create a Hopsworks cluster, autoscale workers configuration Step 4 select an SSH key # When deploying clusters, Hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. Select the SSH key that you want to use to access cluster instances. For more detail on how to add a shh key in AWS refer to Create an ssh key Choose SSH key Step 5 select the Instance Profile # To let the cluster instances access the S3 bucket we need to attach an instance profile to the virtual machines. In this step, you choose which profile to use. This profile needs to have access right to the S3 bucket you selected in Step 2 . For more details on how to create the instance profile and give it access to the S3 bucket refer to Creating an instance profile and giving it access to the bucket Choose the instance profile Step 6 set the backup retention policy # Note This step is only accessible to enterprise users. To backup the S3 bucket data when taking a cluster backup we need to set a retention policy for S3. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the backup retention policy Step 7 Managed Containers # Hopsworks can integrate with Amazon Elastic Kubernetes Service (EKS) and Amazon Elastic Container Registry (ECR) to launch Python jobs, Jupyter servers, and ML model servings on top of Amazon EKS. For more detail on how to set up this integration refer to Integration with Amazon EKS and Amazon ECR . Add EKS cluster name Step 8 VPC selection # In this step, you can select the VPC which will be used by the Hopsworks cluster. You can either select an existing VPC or let Hopsworks.ai create one for you. If you decide to let Hopsworks.ai create the VPC for you, you can choose the CIDR block for this virtual network. Refer to Create a VPC for more details on how to create your own VPC in AWS. Choose a VPC Note If the VPC uses a custom domain read our guide on how to set this up Step 9 Availability Zone selection # If you selected an existing VPC in the previous step, this step lets you select which availability zone of this VPC to use. If you did not select an existing virtual network in the previous step Hopsworks.ai will create an availability zone for you. You can choose the CIDR block this subnet will use. Choose an availability zone Step 10 Security group selection # If you selected an existing VPC in the previous step, this step lets you select which security group to use. Note Hopsworks.ai require some rules for inbound and outbound traffic in your security group, for more details refer to inbound traffic rules and outbound traffic rules . Note Hopsworks.ai attaches a public ip to your cluster by default. However, you can disable this behavior by unchecking the Attach Public IP checkbox. Choose security group Limiting outbound traffic to Hopsworks.ai # Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai. If you have strict regulation regarding outbound traffic, you can enable the Use static IPs to communicate with Hopsworks.ai checkbox to get a list of IPs to be allowed as shown below: Enable static IPs Step 11 User management selection # In this step, you can choose which user management system to use. You have four choices: Managed : Hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization. OAuth2 : integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail. LDAP : integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail. Disabled : let you manage users manually from within Hopsworks. Choose user management type Step 12 Managed RonDB # Hopsworks.ai users have the option to create a cluster with dedicated VMs running RonDB . For details on how to configure RonDB check our guide here . Enable Managed RonDB If you need this feature and don't see this step please contact us . Step 13 add tags to your instances. # In this step, you can define tags that will be added to the cluster virtual machines. Add tags Step 14 add an init script to your instances. # In this step, you can enter an initialization script that will be run at startup on every instance. You can select whether this script will run before or after the VM configuration. Be cautious if you select to run it before the VM configuration as this might affect Cluster creation. Note this init script must be a bash script starting with #!/usr/bin/env bash Add initialization script Step 15 Review and create # Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Cluster Creation"},{"location":"setup_installation/aws/cluster_creation/#getting-started-with-hopsworksai-aws","text":"This guide goes into detail for each of the steps of the cluster creation in Hopsworks.ai","title":"Getting started with Hopsworks.ai (AWS)"},{"location":"setup_installation/aws/cluster_creation/#step-1-starting-to-create-a-cluster","text":"In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster","title":"Step 1 starting to create a cluster"},{"location":"setup_installation/aws/cluster_creation/#step-2-setting-the-general-information","text":"Create a Hopsworks cluster, general information Select the Region in which you want your cluster to run (1), name your cluster (2). Select the Instance type (3) and Local storage (4) size for the cluster Head node .","title":"Step 2 setting the General information"},{"location":"setup_installation/aws/cluster_creation/#s3-bucket-configuration","text":"Enter the name of the S3 bucket (5) you want the cluster to store its data in. Note The S3 bucket you are using must be empty. Premium users have the option to use encrypted S3 buckets . To configure an encrypted bucket click on the Advanced tab and select the appropriate encryption type. Note Encryption must have been already enabled for the bucket We support the following encryption schemes: SSE-S3 SSE-KMS S3 managed key User managed key Users can also select an AWS canned ACLs for the objects: bucket-owner-full-control On the main page, you can also choose to aggregate logs in CloudWatch and to opt out of hopsworks.ai log collection. The first one is to aggregate the logs of services running in your cluster in CloudWatch service in your configured AWS account. This can be useful if you want to understand what is happening on your cluster, without having to ssh into the instances. The second one is for hopsworks.ai to collect logs about the services running in your cluster. These logs will help us improve our system and provide support. If you choose to opt-out from the log collection and need support you will have to provide us the log by yourself, which will slow down the support process.","title":"S3 bucket configuration"},{"location":"setup_installation/aws/cluster_creation/#step-3-workers-configuration","text":"In this step, you configure the workers. There are two possible setups static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: the documentation . In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand.","title":"Step 3 workers configuration"},{"location":"setup_installation/aws/cluster_creation/#static-workers-configuration","text":"You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes . Create a Hopsworks cluster, static workers configuration","title":"Static workers configuration"},{"location":"setup_installation/aws/cluster_creation/#autoscaling-workers-configuration","text":"You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You then have access to a two parts form allowing you to configure the autoscaling. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Create a Hopsworks cluster, autoscale workers configuration","title":"Autoscaling workers configuration"},{"location":"setup_installation/aws/cluster_creation/#step-4-select-an-ssh-key","text":"When deploying clusters, Hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. Select the SSH key that you want to use to access cluster instances. For more detail on how to add a shh key in AWS refer to Create an ssh key Choose SSH key","title":"Step 4 select an SSH key"},{"location":"setup_installation/aws/cluster_creation/#step-5-select-the-instance-profile","text":"To let the cluster instances access the S3 bucket we need to attach an instance profile to the virtual machines. In this step, you choose which profile to use. This profile needs to have access right to the S3 bucket you selected in Step 2 . For more details on how to create the instance profile and give it access to the S3 bucket refer to Creating an instance profile and giving it access to the bucket Choose the instance profile","title":"Step 5 select the Instance Profile"},{"location":"setup_installation/aws/cluster_creation/#step-6-set-the-backup-retention-policy","text":"Note This step is only accessible to enterprise users. To backup the S3 bucket data when taking a cluster backup we need to set a retention policy for S3. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the backup retention policy","title":"Step 6 set the backup retention policy"},{"location":"setup_installation/aws/cluster_creation/#step-7-managed-containers","text":"Hopsworks can integrate with Amazon Elastic Kubernetes Service (EKS) and Amazon Elastic Container Registry (ECR) to launch Python jobs, Jupyter servers, and ML model servings on top of Amazon EKS. For more detail on how to set up this integration refer to Integration with Amazon EKS and Amazon ECR . Add EKS cluster name","title":"Step 7 Managed Containers"},{"location":"setup_installation/aws/cluster_creation/#step-8-vpc-selection","text":"In this step, you can select the VPC which will be used by the Hopsworks cluster. You can either select an existing VPC or let Hopsworks.ai create one for you. If you decide to let Hopsworks.ai create the VPC for you, you can choose the CIDR block for this virtual network. Refer to Create a VPC for more details on how to create your own VPC in AWS. Choose a VPC Note If the VPC uses a custom domain read our guide on how to set this up","title":"Step 8 VPC selection"},{"location":"setup_installation/aws/cluster_creation/#step-9-availability-zone-selection","text":"If you selected an existing VPC in the previous step, this step lets you select which availability zone of this VPC to use. If you did not select an existing virtual network in the previous step Hopsworks.ai will create an availability zone for you. You can choose the CIDR block this subnet will use. Choose an availability zone","title":"Step 9 Availability Zone selection"},{"location":"setup_installation/aws/cluster_creation/#step-10-security-group-selection","text":"If you selected an existing VPC in the previous step, this step lets you select which security group to use. Note Hopsworks.ai require some rules for inbound and outbound traffic in your security group, for more details refer to inbound traffic rules and outbound traffic rules . Note Hopsworks.ai attaches a public ip to your cluster by default. However, you can disable this behavior by unchecking the Attach Public IP checkbox. Choose security group","title":"Step 10 Security group selection"},{"location":"setup_installation/aws/cluster_creation/#limiting-outbound-traffic-to-hopsworksai","text":"Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai. If you have strict regulation regarding outbound traffic, you can enable the Use static IPs to communicate with Hopsworks.ai checkbox to get a list of IPs to be allowed as shown below: Enable static IPs","title":"Limiting outbound traffic to Hopsworks.ai"},{"location":"setup_installation/aws/cluster_creation/#step-11-user-management-selection","text":"In this step, you can choose which user management system to use. You have four choices: Managed : Hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization. OAuth2 : integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail. LDAP : integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail. Disabled : let you manage users manually from within Hopsworks. Choose user management type","title":"Step 11 User management selection"},{"location":"setup_installation/aws/cluster_creation/#step-12-managed-rondb","text":"Hopsworks.ai users have the option to create a cluster with dedicated VMs running RonDB . For details on how to configure RonDB check our guide here . Enable Managed RonDB If you need this feature and don't see this step please contact us .","title":"Step 12 Managed RonDB"},{"location":"setup_installation/aws/cluster_creation/#step-13-add-tags-to-your-instances","text":"In this step, you can define tags that will be added to the cluster virtual machines. Add tags","title":"Step 13 add tags to your instances."},{"location":"setup_installation/aws/cluster_creation/#step-14-add-an-init-script-to-your-instances","text":"In this step, you can enter an initialization script that will be run at startup on every instance. You can select whether this script will run before or after the VM configuration. Be cautious if you select to run it before the VM configuration as this might affect Cluster creation. Note this init script must be a bash script starting with #!/usr/bin/env bash Add initialization script","title":"Step 14 add an init script to your instances."},{"location":"setup_installation/aws/cluster_creation/#step-15-review-and-create","text":"Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Step 15 Review and create"},{"location":"setup_installation/aws/custom_domain_name/","text":"Deploy in a VPC with a custom domain name # Some organizations follow network patterns which impose a specific domain name for Instances. In that case, the instance's hostname instead of ip-10-0-0-175.us-east-2.compute.internal would be ip-10-0-0-175.bar.foo The control plane at hopsworks.ai needs to be aware of such case in order to properly initialize the Cluster. Note This feature is enabled only upon request. If you want this feature to be enable for your account please contact sales There are multiple ways to use custom domain names in your organization which are beyond the scope of this guide. We assume your cloud/network team has already setup the infrastructure. If you are using a resolver such as Amazon Route 53 , it is advised to update the record sets automatically. See our guide below for more information. Set cluster domain name # If this feature is enabled for your account, then in the VPC selection step you will have the option to specify the custom domain name as shown in the figure below. VPC with custom domain name In this case, the hostname of the Instance would be INSTANCE_ID.dev.hopsworks.domain Hostnames must be resolvable by all Virtual Machines in the cluster. For that reason we suggest, if possible, to automatically register the hostnames with your DNS. In the following section we present an example of automatic name registration in Amazon Route 53 Auto registration with Amazon Route 53 # It is quite common for organizations in AWS to use Route 53 for DNS or for hosted zones. You can configure a cluster in hopsworks.ai to execute some custom initialization script before any other action. This script will be executed on all nodes of the cluster. Since the hostname of the VM is in the form of INSTANCE_ID.DOMAIN_NAME it is easy to automate the zone update. The script below creates an A record in a configured Route 53 hosted zone. Warning If you want the VM to register itself with Route 53 you must amend the Instance Profile with the following permissions { \"Sid\" : \"Route53RecordSet\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"route53:ChangeResourceRecordSets\" ], \"Resource\" : \"arn:aws:route53:::hostedzone/YOUR_HOSTED_ZONE_ID\" }, { \"Sid\" : \"Route53GetChange\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"route53:GetChange\" ], \"Resource\" : \"arn:aws:route53:::change/*\" } The following script will get the instance ID from the EC2 metadata server and add an A record to the hosted zone in Route53. Update the YOUR_HOSTED_ZONE_ID and YOUR_CUSTOM_DOMAIN_NAME to match yours. #!/usr/bin/env bash set -e HOSTED_ZONE_ID = YOUR_HOSTED_ZONE_ID ZONE = YOUR_CUSTOM_DOMAIN_NAME record_set_file = /tmp/record_set.json instance_id = $( curl --silent http://169.254.169.254/2016-09-02/meta-data/instance-id ) domain_name = \" ${ instance_id } . ${ ZONE } \" local_ip = $( curl --silent http://169.254.169.254/2016-09-02/meta-data/local-ipv4 ) cat << EOC | tee $record_set_file { \"Changes\": [ { \"Action\": \"UPSERT\", \"ResourceRecordSet\": { \"Name\": \"${domain_name}\", \"Type\": \"A\", \"TTL\": 60, \"ResourceRecords\": [ { \"Value\": \"${local_ip}\" } ] } } ] } EOC echo \"Adding A record ${ domain_name } -> ${ local_ip } to Hosted Zone ${ HOSTED_ZONE_ID } \" change_resource_id = $( aws route53 change-resource-record-sets --hosted-zone-id ${ HOSTED_ZONE_ID } --change-batch file:// ${ record_set_file } | jq -r '.ChangeInfo.Id' ) echo \"Change resource ID: ${ change_resource_id } \" aws route53 wait resource-record-sets-changed --id ${ change_resource_id } echo \"Added resource record set\" rm -f ${ record_set_file } Set VM initialization script # As a final step you need to configure the Cluster to use the script above during VM creation with the user init script option. Paste the script to the text box and make sure you select this script to be executed before anything else on the VM. Automatic domain name registration with Route53","title":"Deploy in a VPC with a custom domain name"},{"location":"setup_installation/aws/custom_domain_name/#deploy-in-a-vpc-with-a-custom-domain-name","text":"Some organizations follow network patterns which impose a specific domain name for Instances. In that case, the instance's hostname instead of ip-10-0-0-175.us-east-2.compute.internal would be ip-10-0-0-175.bar.foo The control plane at hopsworks.ai needs to be aware of such case in order to properly initialize the Cluster. Note This feature is enabled only upon request. If you want this feature to be enable for your account please contact sales There are multiple ways to use custom domain names in your organization which are beyond the scope of this guide. We assume your cloud/network team has already setup the infrastructure. If you are using a resolver such as Amazon Route 53 , it is advised to update the record sets automatically. See our guide below for more information.","title":"Deploy in a VPC with a custom domain name"},{"location":"setup_installation/aws/custom_domain_name/#set-cluster-domain-name","text":"If this feature is enabled for your account, then in the VPC selection step you will have the option to specify the custom domain name as shown in the figure below. VPC with custom domain name In this case, the hostname of the Instance would be INSTANCE_ID.dev.hopsworks.domain Hostnames must be resolvable by all Virtual Machines in the cluster. For that reason we suggest, if possible, to automatically register the hostnames with your DNS. In the following section we present an example of automatic name registration in Amazon Route 53","title":"Set cluster domain name"},{"location":"setup_installation/aws/custom_domain_name/#auto-registration-with-amazon-route-53","text":"It is quite common for organizations in AWS to use Route 53 for DNS or for hosted zones. You can configure a cluster in hopsworks.ai to execute some custom initialization script before any other action. This script will be executed on all nodes of the cluster. Since the hostname of the VM is in the form of INSTANCE_ID.DOMAIN_NAME it is easy to automate the zone update. The script below creates an A record in a configured Route 53 hosted zone. Warning If you want the VM to register itself with Route 53 you must amend the Instance Profile with the following permissions { \"Sid\" : \"Route53RecordSet\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"route53:ChangeResourceRecordSets\" ], \"Resource\" : \"arn:aws:route53:::hostedzone/YOUR_HOSTED_ZONE_ID\" }, { \"Sid\" : \"Route53GetChange\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"route53:GetChange\" ], \"Resource\" : \"arn:aws:route53:::change/*\" } The following script will get the instance ID from the EC2 metadata server and add an A record to the hosted zone in Route53. Update the YOUR_HOSTED_ZONE_ID and YOUR_CUSTOM_DOMAIN_NAME to match yours. #!/usr/bin/env bash set -e HOSTED_ZONE_ID = YOUR_HOSTED_ZONE_ID ZONE = YOUR_CUSTOM_DOMAIN_NAME record_set_file = /tmp/record_set.json instance_id = $( curl --silent http://169.254.169.254/2016-09-02/meta-data/instance-id ) domain_name = \" ${ instance_id } . ${ ZONE } \" local_ip = $( curl --silent http://169.254.169.254/2016-09-02/meta-data/local-ipv4 ) cat << EOC | tee $record_set_file { \"Changes\": [ { \"Action\": \"UPSERT\", \"ResourceRecordSet\": { \"Name\": \"${domain_name}\", \"Type\": \"A\", \"TTL\": 60, \"ResourceRecords\": [ { \"Value\": \"${local_ip}\" } ] } } ] } EOC echo \"Adding A record ${ domain_name } -> ${ local_ip } to Hosted Zone ${ HOSTED_ZONE_ID } \" change_resource_id = $( aws route53 change-resource-record-sets --hosted-zone-id ${ HOSTED_ZONE_ID } --change-batch file:// ${ record_set_file } | jq -r '.ChangeInfo.Id' ) echo \"Change resource ID: ${ change_resource_id } \" aws route53 wait resource-record-sets-changed --id ${ change_resource_id } echo \"Added resource record set\" rm -f ${ record_set_file }","title":"Auto registration with Amazon Route 53"},{"location":"setup_installation/aws/custom_domain_name/#set-vm-initialization-script","text":"As a final step you need to configure the Cluster to use the script above during VM creation with the user init script option. Paste the script to the text box and make sure you select this script to be executed before anything else on the VM. Automatic domain name registration with Route53","title":"Set VM initialization script"},{"location":"setup_installation/aws/eks_ecr_integration/","text":"Integration with Amazon EKS and Amazon ECR # This guide shows how to create a cluster in Hopsworks.ai with integrated support for Amazon Elastic Kubernetes Service (EKS) and Amazon Elastic Container Registry (ECR). So that Hopsworks can launch Python jobs, Jupyter servers, and ML model servings on top of Amazon EKS. Warning In the current version, we don't support sharing EKS clusters between Hopsworks clusters. That is, an EKS cluster can be only used by one Hopsworks cluster. Step 1: Create an EKS cluster on AWS # If you have an existing EKS cluster, skip this step and go directly to Step 2. Amazon provides two getting started guides using AWS management console or eksctl to help you create an EKS cluster. The easiest way is to use the eksctl command. Step 1.1: Installing eksctl, aws, and kubectl # Follow the prerequisites section in getting started with eksctl to install aws, eksctl, and kubectl. Step 1.2: Create an EKS cluster using eksctl # You can create a sample EKS cluster with the name my-eks-cluster using Kubernetes version 1.17 with 2 managed nodes in the us-east-2 region by running the following command. For more details on the eksctl usage, check the eksctl documentation . eksctl create cluster --name my-eks-cluster --version 1 .17 --region us-east-2 --nodegroup-name my-nodes --nodes 2 --managed Output: [ \u2139 ] eksctl version 0 .26.0 [ \u2139 ] using region us-east-2 [ \u2139 ] setting availability zones to [ us-east-2b us-east-2a us-east-2c ] [ \u2139 ] subnets for us-east-2b - public:192.168.0.0/19 private:192.168.96.0/19 [ \u2139 ] subnets for us-east-2a - public:192.168.32.0/19 private:192.168.128.0/19 [ \u2139 ] subnets for us-east-2c - public:192.168.64.0/19 private:192.168.160.0/19 [ \u2139 ] using Kubernetes version 1 .17 [ \u2139 ] creating EKS cluster \"my-eks-cluster\" in \"us-east-2\" region with managed nodes [ \u2139 ] will create 2 separate CloudFormation stacks for cluster itself and the initial managed nodegroup [ \u2139 ] if you encounter any issues, check CloudFormation console or try 'eksctl utils describe-stacks --region=us-east-2 --cluster=my-eks-cluster' [ \u2139 ] CloudWatch logging will not be enabled for cluster \"my-eks-cluster\" in \"us-east-2\" [ \u2139 ] you can enable it with 'eksctl utils update-cluster-logging --region=us-east-2 --cluster=my-eks-cluster' [ \u2139 ] Kubernetes API endpoint access will use default of { publicAccess = true, privateAccess = false } for cluster \"my-eks-cluster\" in \"us-east-2\" [ \u2139 ] 2 sequential tasks: { create cluster control plane \"my-eks-cluster\" , 2 sequential sub-tasks: { no tasks, create managed nodegroup \"my-nodes\" } } [ \u2139 ] building cluster stack \"eksctl-my-eks-cluster-cluster\" [ \u2139 ] deploying stack \"eksctl-my-eks-cluster-cluster\" [ \u2139 ] building managed nodegroup stack \"eksctl-my-eks-cluster-nodegroup-my-nodes\" [ \u2139 ] deploying stack \"eksctl-my-eks-cluster-nodegroup-my-nodes\" [ \u2139 ] waiting for the control plane availability... [ \u2714 ] saved kubeconfig as \"/Users/maism/.kube/config\" [ \u2139 ] no tasks [ \u2714 ] all EKS cluster resources for \"my-eks-cluster\" have been created [ \u2139 ] nodegroup \"my-nodes\" has 2 node ( s ) [ \u2139 ] node \"ip-192-168-21-142.us-east-2.compute.internal\" is ready [ \u2139 ] node \"ip-192-168-62-117.us-east-2.compute.internal\" is ready [ \u2139 ] waiting for at least 2 node ( s ) to become ready in \"my-nodes\" [ \u2139 ] nodegroup \"my-nodes\" has 2 node ( s ) [ \u2139 ] node \"ip-192-168-21-142.us-east-2.compute.internal\" is ready [ \u2139 ] node \"ip-192-168-62-117.us-east-2.compute.internal\" is ready [ \u2139 ] kubectl command should work with \"/Users/maism/.kube/config\" , try 'kubectl get nodes' [ \u2714 ] EKS cluster \"my-eks-cluster\" in \"us-east-2\" region is ready Once the cluster is created, eksctl will write the cluster credentials for the newly created cluster to your local kubeconfig file (~/.kube/config). To test the cluster credentials, you can run the following command to get the list of nodes in the cluster. kubectl get nodes Output: NAME STATUS ROLES AGE VERSION ip-192-168-21-142.us-east-2.compute.internal Ready <none> 2m35s v1.17.9-eks-4c6976 ip-192-168-62-117.us-east-2.compute.internal Ready <none> 2m34s v1.17.9-eks-4c6976 Step 2: Create an instance profile role on AWS # You need to add permission to the instance profile you use for instances deployed by Hopsworks.ai to give them access to EKS and ECR. Go to the IAM service in the AWS management console , click Roles , search for your role, and click on it. Click on Add inline policy . Go to the JSON tab and replace the existing JSON permissions with the JSON permissions below.. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"AllowPullMainImages\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ecr:GetDownloadUrlForLayer\" , \"ecr:BatchGetImage\" ], \"Resource\" : [ \"arn:aws:ecr:*:*:repository/filebeat\" , \"arn:aws:ecr:*:*:repository/base\" ] }, { \"Sid\" : \"AllowPushandPullImages\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ecr:CreateRepository\" , \"ecr:GetDownloadUrlForLayer\" , \"ecr:BatchGetImage\" , \"ecr:CompleteLayerUpload\" , \"ecr:UploadLayerPart\" , \"ecr:InitiateLayerUpload\" , \"ecr:DeleteRepository\" , \"ecr:BatchCheckLayerAvailability\" , \"ecr:PutImage\" , \"ecr:ListImages\" , \"ecr:BatchDeleteImage\" , \"ecr:GetLifecyclePolicy\" , \"ecr:PutLifecyclePolicy\" ], \"Resource\" : [ \"arn:aws:ecr:*:*:repository/*/filebeat\" , \"arn:aws:ecr:*:*:repository/*/base\" ] }, { \"Sid\" : \"AllowGetAuthToken\" , \"Effect\" : \"Allow\" , \"Action\" : \"ecr:GetAuthorizationToken\" , \"Resource\" : \"*\" }, { \"Sid\" : \"AllowDescirbeEKS\" , \"Effect\" : \"Allow\" , \"Action\" : \"eks:DescribeCluster\" , \"Resource\" : \"arn:aws:eks:*:*:cluster/*\" } ] } Click on Review policy . Give a name to your policy and click on Create policy . Copy the Role ARN of your profile (not to be confused with the Instance Profile ARNs two lines bellow). Coppy the *Role ARN* Step 3: Allow your role to use your EKS cluster # You need to configure your EKS cluster to accept connections from the role you created above. This is done by using the following kubectl command. For more details, check Managing users or IAM roles for your cluster . Note The kubectl edit command uses the vi editor by default, however, you can override this behavior by setting KUBE_EDITOR to your preferred editor . KUBE_EDITOR = \"vi\" kubectl edit configmap aws-auth -n kube-system Output: # Please edit the object below. Lines beginning with a '#' will be ignored, # and an empty file will abort the edit. If an error occurs while saving this file will be # reopened with the relevant failures. # apiVersion: v1 data: mapRoles: | - groups: - system:bootstrappers - system:nodes rolearn: arn:aws:iam::xxxxxxxxxxxx:role/eksctl-my-eks-cluster-nodegroup-m-NodeInstanceRole-FQ7L0HQI4NCC username: system:node: {{ EC2PrivateDNSName }} kind: ConfigMap metadata: creationTimestamp: \"2020-08-24T07:42:31Z\" name: aws-auth namespace: kube-system resourceVersion: \"770\" selfLink: /api/v1/namespaces/kube-system/configmaps/aws-auth uid: c794b2d8-9f10-443d-9072-c65d0f2eb552 Follow the example below (lines 13-16) to add your role to mapRoles and assign the system:masters group to your role. Make sure to replace 'YOUR ROLE RoleARN' with the Role ARN you copied in the previous step before saving. Warning Make sure to keep the same formatting as in the example below. The configuration format is sensitive to indentation and copy-pasting does not always keep the correct indentation. # Please edit the object below. Lines beginning with a '#' will be ignored, # and an empty file will abort the edit. If an error occurs while saving this file will be # reopened with the relevant failures. # apiVersion: v1 data: mapRoles: | - groups: - system:bootstrappers - system:nodes rolearn: arn:aws:iam::xxxxxxxxxxxx:role/eksctl-my-eks-cluster-nodegroup-m-NodeInstanceRole-FQ7L0HQI4NCC username: system:node: {{ EC2PrivateDNSName }} - groups: - system:masters rolearn: <YOUR ROLE RoleARN> username: hopsworks kind: ConfigMap metadata: creationTimestamp: \"2020-08-24T07:42:31Z\" name: aws-auth namespace: kube-system resourceVersion: \"770\" selfLink: /api/v1/namespaces/kube-system/configmaps/aws-auth uid: c794b2d8-9f10-443d-9072-c65d0f2eb552 Once you are done with editing the configmap, save it and exit the editor. The output should be: configmap/aws-auth edited Step 4: Setup network connectivity # For Hopsworks to be able to start containers in the EKS cluster and for these containers to be able to use Hopsworks we need to establish network connectivity between Hopsworks and EKS. For this, we have two solutions. The first option ( A ) is to run Hopsworks and EKS in the same virtual network and security group. The second option ( B ) is to pair the EKS and Hopsworks virtual networks. If you choose this option, make sure to create the peering before starting the Hopsworks cluster as it connects to EKS at startup. Option A : run Hopsworks and EKS in the same virtual network. # Running EKS and Hopsworks in the same security group is the simplest of the two solutions when it comes to setting up the system. All you need to do is to open the ports needed by Hopsworks in the security group created by the EKS cluster. Then you can just select this security group during the Hopsworks cluster creation. We will now see how to open the ports for HTTP (80) and HTTPS (443) to allow Hopsworks to run with all its functionalities. Note It is possible not to open ports 80 and 443 at the cost of some features. See Limiting permissions for more details. First, you need to get the name of the security group of your EKS cluster by using the following eksctl command. Notice that you need to replace my-eks-cluster with the name of your cluster. eksctl utils describe-stacks --region = us-east-2 --cluster = my-eks-cluster | grep 'OutputKey: \"ClusterSecurityGroupId\"' -a1 Check the output for OutputValue , which will be the id of your EKS security group. ExportName: \"eksctl-my-eks-cluster-cluster::ClusterSecurityGroupId\" , OutputKey: \"ClusterSecurityGroupId\" , OutputValue: \"YOUR_EKS_SECURITY_GROUP_ID\" Go to the Security Groups section of EC2 in the AWS management console and search for your security group using the id obtained above. Note the VPC ID , you will need it when creating the hopsworks cluster. Then, click on it then go to the Inbound rules tab and click on Edit inbound rules . You should now see the following screen. Edit inbound rules Add two rules for HTTP and HTTPS as follows: Edit inbound rules Click Save rules to save the updated rules to the security group. Option B : create a pairing between Hopsworks and EKS # To establish virtual peering between the Kubernetes cluster and Hopsworks, you need to select or create a virtual network for Hopsworks. You can create the virtual network by following the AWS documentation steps to create the virtual private network . Make sure to configure your subnet to use an address space that does not overlap with the address space in the Kubernetes network. You then need to select or create a security group for the Hopsworks VPC. You can create the security group by following the steps in the AWS documentation . Remember to open the port for HTTP (80) and HTTPS (443) to allow Hopsworks to run with all its functionalities. Note It is possible not to open ports 80 and 443 at the cost of some features. See Limiting permissions for more details. Once the Hopsworks VPC and security group are created you need to create a peering between the Hopsworks VPC and the EKS VPC. For this follow the AWS documentation here . Finally, you need to edit the security groups for the EKS cluster and for Hopsworks to allow full communication between both VPC. This can be done following the instruction in the AWS documentation . You can get the name of the security group of your EKS cluster by using the following eksctl command. Notice that you need to replace my-eks-cluster with the name of your cluster. eksctl utils describe-stacks --region = us-east-2 --cluster = my-eks-cluster | grep 'OutputKey: \"ClusterSecurityGroupId\"' -a1 Check the output for OutputValue , which will be the id of your EKS security group. ExportName: \"eksctl-my-eks-cluster-cluster::ClusterSecurityGroupId\" , OutputKey: \"ClusterSecurityGroupId\" , OutputValue: \"YOUR_EKS_SECURITY_GROUP_ID\" Step 5: Allow Hopsworks.ai to delete ECR repositories on your behalf # For hopsworks.ai to be able to clean up the ECR repo when terminating your hopsworks cluster, you need to add a new inline policy to the Cross-Account role or user connected to Hopsworks.ai , that you set up when connecting your AWS account to hopsworks.ai . Navigate to AWS management console , then click on Roles or Users depending on which connection method you have used in Hopsworks.ai, and then search for your role or user name and click on it. Go to the Permissions tab, click on Add inline policy and go to the JSON tab. Replace the existing JSON permissions with the JSON permissions below. Click on Review policy , name it, and click Create policy . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"AllowDeletingECRRepositories\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ecr:DeleteRepository\" ], \"Resource\" : [ \"arn:aws:ecr:*:*:repository/*/filebeat\" , \"arn:aws:ecr:*:*:repository/*/base\" ] } ] } Step 6: Create a Hopsworks cluster with EKS and ECR support # In Hopsworks.ai, select Create cluster . Choose the region of your EKS cluster and fill in the name of your S3 bucket , then click Next: Create Hopsworks cluster Choose your preferred SSH key to use with the cluster, then click Next: Choose SSH key Choose the instance profile role that you have created in Step 2 (click on the refresh button if your instance profile is not in the list), then click Next: Choose instance profile role Choose the backup retention period and click Next: Choose the backup retention policy Choose Enabled to enable the use of Amazon EKS and ECR: Choose Enabled Add your EKS cluster name, then click Next: Add EKS cluster name If you followed option A when setting up the network Choose the VPC of your EKS cluster. Its name should have the form eksctl-YOUR-CLUSTER-NAME-cluster (click on the refresh button if the VPC is not in the list). If you followed option B choose the VPC you created during Step 4 . Choose VPC Choose any of the subnets in the VPC, then click Next. Note Avoid private subnets if you want to enjoy all the hopsworks features . Choose Subnet Choose the security group that you have updated/created in Step 4 , then click Next: Note If you followed option A select the Security Group with the same id as in Step 4 and NOT the ones containing ControlPlaneSecurity or ClusterSharedNode in their name. Choose Security Group Click Review and submit , then Create. Once the cluster is created, Hopsworks will use EKS to launch Python jobs, Jupyter servers, and ML model servings.","title":"Integration with Amazon EKS and Amazon ECR"},{"location":"setup_installation/aws/eks_ecr_integration/#integration-with-amazon-eks-and-amazon-ecr","text":"This guide shows how to create a cluster in Hopsworks.ai with integrated support for Amazon Elastic Kubernetes Service (EKS) and Amazon Elastic Container Registry (ECR). So that Hopsworks can launch Python jobs, Jupyter servers, and ML model servings on top of Amazon EKS. Warning In the current version, we don't support sharing EKS clusters between Hopsworks clusters. That is, an EKS cluster can be only used by one Hopsworks cluster.","title":"Integration with Amazon EKS and Amazon ECR"},{"location":"setup_installation/aws/eks_ecr_integration/#step-1-create-an-eks-cluster-on-aws","text":"If you have an existing EKS cluster, skip this step and go directly to Step 2. Amazon provides two getting started guides using AWS management console or eksctl to help you create an EKS cluster. The easiest way is to use the eksctl command.","title":"Step 1: Create an EKS cluster on AWS"},{"location":"setup_installation/aws/eks_ecr_integration/#step-11-installing-eksctl-aws-and-kubectl","text":"Follow the prerequisites section in getting started with eksctl to install aws, eksctl, and kubectl.","title":"Step 1.1: Installing eksctl, aws, and kubectl"},{"location":"setup_installation/aws/eks_ecr_integration/#step-12-create-an-eks-cluster-using-eksctl","text":"You can create a sample EKS cluster with the name my-eks-cluster using Kubernetes version 1.17 with 2 managed nodes in the us-east-2 region by running the following command. For more details on the eksctl usage, check the eksctl documentation . eksctl create cluster --name my-eks-cluster --version 1 .17 --region us-east-2 --nodegroup-name my-nodes --nodes 2 --managed Output: [ \u2139 ] eksctl version 0 .26.0 [ \u2139 ] using region us-east-2 [ \u2139 ] setting availability zones to [ us-east-2b us-east-2a us-east-2c ] [ \u2139 ] subnets for us-east-2b - public:192.168.0.0/19 private:192.168.96.0/19 [ \u2139 ] subnets for us-east-2a - public:192.168.32.0/19 private:192.168.128.0/19 [ \u2139 ] subnets for us-east-2c - public:192.168.64.0/19 private:192.168.160.0/19 [ \u2139 ] using Kubernetes version 1 .17 [ \u2139 ] creating EKS cluster \"my-eks-cluster\" in \"us-east-2\" region with managed nodes [ \u2139 ] will create 2 separate CloudFormation stacks for cluster itself and the initial managed nodegroup [ \u2139 ] if you encounter any issues, check CloudFormation console or try 'eksctl utils describe-stacks --region=us-east-2 --cluster=my-eks-cluster' [ \u2139 ] CloudWatch logging will not be enabled for cluster \"my-eks-cluster\" in \"us-east-2\" [ \u2139 ] you can enable it with 'eksctl utils update-cluster-logging --region=us-east-2 --cluster=my-eks-cluster' [ \u2139 ] Kubernetes API endpoint access will use default of { publicAccess = true, privateAccess = false } for cluster \"my-eks-cluster\" in \"us-east-2\" [ \u2139 ] 2 sequential tasks: { create cluster control plane \"my-eks-cluster\" , 2 sequential sub-tasks: { no tasks, create managed nodegroup \"my-nodes\" } } [ \u2139 ] building cluster stack \"eksctl-my-eks-cluster-cluster\" [ \u2139 ] deploying stack \"eksctl-my-eks-cluster-cluster\" [ \u2139 ] building managed nodegroup stack \"eksctl-my-eks-cluster-nodegroup-my-nodes\" [ \u2139 ] deploying stack \"eksctl-my-eks-cluster-nodegroup-my-nodes\" [ \u2139 ] waiting for the control plane availability... [ \u2714 ] saved kubeconfig as \"/Users/maism/.kube/config\" [ \u2139 ] no tasks [ \u2714 ] all EKS cluster resources for \"my-eks-cluster\" have been created [ \u2139 ] nodegroup \"my-nodes\" has 2 node ( s ) [ \u2139 ] node \"ip-192-168-21-142.us-east-2.compute.internal\" is ready [ \u2139 ] node \"ip-192-168-62-117.us-east-2.compute.internal\" is ready [ \u2139 ] waiting for at least 2 node ( s ) to become ready in \"my-nodes\" [ \u2139 ] nodegroup \"my-nodes\" has 2 node ( s ) [ \u2139 ] node \"ip-192-168-21-142.us-east-2.compute.internal\" is ready [ \u2139 ] node \"ip-192-168-62-117.us-east-2.compute.internal\" is ready [ \u2139 ] kubectl command should work with \"/Users/maism/.kube/config\" , try 'kubectl get nodes' [ \u2714 ] EKS cluster \"my-eks-cluster\" in \"us-east-2\" region is ready Once the cluster is created, eksctl will write the cluster credentials for the newly created cluster to your local kubeconfig file (~/.kube/config). To test the cluster credentials, you can run the following command to get the list of nodes in the cluster. kubectl get nodes Output: NAME STATUS ROLES AGE VERSION ip-192-168-21-142.us-east-2.compute.internal Ready <none> 2m35s v1.17.9-eks-4c6976 ip-192-168-62-117.us-east-2.compute.internal Ready <none> 2m34s v1.17.9-eks-4c6976","title":"Step 1.2: Create an EKS cluster using eksctl"},{"location":"setup_installation/aws/eks_ecr_integration/#step-2-create-an-instance-profile-role-on-aws","text":"You need to add permission to the instance profile you use for instances deployed by Hopsworks.ai to give them access to EKS and ECR. Go to the IAM service in the AWS management console , click Roles , search for your role, and click on it. Click on Add inline policy . Go to the JSON tab and replace the existing JSON permissions with the JSON permissions below.. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"AllowPullMainImages\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ecr:GetDownloadUrlForLayer\" , \"ecr:BatchGetImage\" ], \"Resource\" : [ \"arn:aws:ecr:*:*:repository/filebeat\" , \"arn:aws:ecr:*:*:repository/base\" ] }, { \"Sid\" : \"AllowPushandPullImages\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ecr:CreateRepository\" , \"ecr:GetDownloadUrlForLayer\" , \"ecr:BatchGetImage\" , \"ecr:CompleteLayerUpload\" , \"ecr:UploadLayerPart\" , \"ecr:InitiateLayerUpload\" , \"ecr:DeleteRepository\" , \"ecr:BatchCheckLayerAvailability\" , \"ecr:PutImage\" , \"ecr:ListImages\" , \"ecr:BatchDeleteImage\" , \"ecr:GetLifecyclePolicy\" , \"ecr:PutLifecyclePolicy\" ], \"Resource\" : [ \"arn:aws:ecr:*:*:repository/*/filebeat\" , \"arn:aws:ecr:*:*:repository/*/base\" ] }, { \"Sid\" : \"AllowGetAuthToken\" , \"Effect\" : \"Allow\" , \"Action\" : \"ecr:GetAuthorizationToken\" , \"Resource\" : \"*\" }, { \"Sid\" : \"AllowDescirbeEKS\" , \"Effect\" : \"Allow\" , \"Action\" : \"eks:DescribeCluster\" , \"Resource\" : \"arn:aws:eks:*:*:cluster/*\" } ] } Click on Review policy . Give a name to your policy and click on Create policy . Copy the Role ARN of your profile (not to be confused with the Instance Profile ARNs two lines bellow). Coppy the *Role ARN*","title":"Step 2: Create an instance profile role on AWS"},{"location":"setup_installation/aws/eks_ecr_integration/#step-3-allow-your-role-to-use-your-eks-cluster","text":"You need to configure your EKS cluster to accept connections from the role you created above. This is done by using the following kubectl command. For more details, check Managing users or IAM roles for your cluster . Note The kubectl edit command uses the vi editor by default, however, you can override this behavior by setting KUBE_EDITOR to your preferred editor . KUBE_EDITOR = \"vi\" kubectl edit configmap aws-auth -n kube-system Output: # Please edit the object below. Lines beginning with a '#' will be ignored, # and an empty file will abort the edit. If an error occurs while saving this file will be # reopened with the relevant failures. # apiVersion: v1 data: mapRoles: | - groups: - system:bootstrappers - system:nodes rolearn: arn:aws:iam::xxxxxxxxxxxx:role/eksctl-my-eks-cluster-nodegroup-m-NodeInstanceRole-FQ7L0HQI4NCC username: system:node: {{ EC2PrivateDNSName }} kind: ConfigMap metadata: creationTimestamp: \"2020-08-24T07:42:31Z\" name: aws-auth namespace: kube-system resourceVersion: \"770\" selfLink: /api/v1/namespaces/kube-system/configmaps/aws-auth uid: c794b2d8-9f10-443d-9072-c65d0f2eb552 Follow the example below (lines 13-16) to add your role to mapRoles and assign the system:masters group to your role. Make sure to replace 'YOUR ROLE RoleARN' with the Role ARN you copied in the previous step before saving. Warning Make sure to keep the same formatting as in the example below. The configuration format is sensitive to indentation and copy-pasting does not always keep the correct indentation. # Please edit the object below. Lines beginning with a '#' will be ignored, # and an empty file will abort the edit. If an error occurs while saving this file will be # reopened with the relevant failures. # apiVersion: v1 data: mapRoles: | - groups: - system:bootstrappers - system:nodes rolearn: arn:aws:iam::xxxxxxxxxxxx:role/eksctl-my-eks-cluster-nodegroup-m-NodeInstanceRole-FQ7L0HQI4NCC username: system:node: {{ EC2PrivateDNSName }} - groups: - system:masters rolearn: <YOUR ROLE RoleARN> username: hopsworks kind: ConfigMap metadata: creationTimestamp: \"2020-08-24T07:42:31Z\" name: aws-auth namespace: kube-system resourceVersion: \"770\" selfLink: /api/v1/namespaces/kube-system/configmaps/aws-auth uid: c794b2d8-9f10-443d-9072-c65d0f2eb552 Once you are done with editing the configmap, save it and exit the editor. The output should be: configmap/aws-auth edited","title":"Step 3: Allow your role to use your EKS cluster"},{"location":"setup_installation/aws/eks_ecr_integration/#step-4-setup-network-connectivity","text":"For Hopsworks to be able to start containers in the EKS cluster and for these containers to be able to use Hopsworks we need to establish network connectivity between Hopsworks and EKS. For this, we have two solutions. The first option ( A ) is to run Hopsworks and EKS in the same virtual network and security group. The second option ( B ) is to pair the EKS and Hopsworks virtual networks. If you choose this option, make sure to create the peering before starting the Hopsworks cluster as it connects to EKS at startup.","title":"Step 4: Setup network connectivity"},{"location":"setup_installation/aws/eks_ecr_integration/#option-a-run-hopsworks-and-eks-in-the-same-virtual-network","text":"Running EKS and Hopsworks in the same security group is the simplest of the two solutions when it comes to setting up the system. All you need to do is to open the ports needed by Hopsworks in the security group created by the EKS cluster. Then you can just select this security group during the Hopsworks cluster creation. We will now see how to open the ports for HTTP (80) and HTTPS (443) to allow Hopsworks to run with all its functionalities. Note It is possible not to open ports 80 and 443 at the cost of some features. See Limiting permissions for more details. First, you need to get the name of the security group of your EKS cluster by using the following eksctl command. Notice that you need to replace my-eks-cluster with the name of your cluster. eksctl utils describe-stacks --region = us-east-2 --cluster = my-eks-cluster | grep 'OutputKey: \"ClusterSecurityGroupId\"' -a1 Check the output for OutputValue , which will be the id of your EKS security group. ExportName: \"eksctl-my-eks-cluster-cluster::ClusterSecurityGroupId\" , OutputKey: \"ClusterSecurityGroupId\" , OutputValue: \"YOUR_EKS_SECURITY_GROUP_ID\" Go to the Security Groups section of EC2 in the AWS management console and search for your security group using the id obtained above. Note the VPC ID , you will need it when creating the hopsworks cluster. Then, click on it then go to the Inbound rules tab and click on Edit inbound rules . You should now see the following screen. Edit inbound rules Add two rules for HTTP and HTTPS as follows: Edit inbound rules Click Save rules to save the updated rules to the security group.","title":"Option A: run Hopsworks and EKS in the same virtual network."},{"location":"setup_installation/aws/eks_ecr_integration/#option-b-create-a-pairing-between-hopsworks-and-eks","text":"To establish virtual peering between the Kubernetes cluster and Hopsworks, you need to select or create a virtual network for Hopsworks. You can create the virtual network by following the AWS documentation steps to create the virtual private network . Make sure to configure your subnet to use an address space that does not overlap with the address space in the Kubernetes network. You then need to select or create a security group for the Hopsworks VPC. You can create the security group by following the steps in the AWS documentation . Remember to open the port for HTTP (80) and HTTPS (443) to allow Hopsworks to run with all its functionalities. Note It is possible not to open ports 80 and 443 at the cost of some features. See Limiting permissions for more details. Once the Hopsworks VPC and security group are created you need to create a peering between the Hopsworks VPC and the EKS VPC. For this follow the AWS documentation here . Finally, you need to edit the security groups for the EKS cluster and for Hopsworks to allow full communication between both VPC. This can be done following the instruction in the AWS documentation . You can get the name of the security group of your EKS cluster by using the following eksctl command. Notice that you need to replace my-eks-cluster with the name of your cluster. eksctl utils describe-stacks --region = us-east-2 --cluster = my-eks-cluster | grep 'OutputKey: \"ClusterSecurityGroupId\"' -a1 Check the output for OutputValue , which will be the id of your EKS security group. ExportName: \"eksctl-my-eks-cluster-cluster::ClusterSecurityGroupId\" , OutputKey: \"ClusterSecurityGroupId\" , OutputValue: \"YOUR_EKS_SECURITY_GROUP_ID\"","title":"Option B: create a pairing between Hopsworks and EKS"},{"location":"setup_installation/aws/eks_ecr_integration/#step-5-allow-hopsworksai-to-delete-ecr-repositories-on-your-behalf","text":"For hopsworks.ai to be able to clean up the ECR repo when terminating your hopsworks cluster, you need to add a new inline policy to the Cross-Account role or user connected to Hopsworks.ai , that you set up when connecting your AWS account to hopsworks.ai . Navigate to AWS management console , then click on Roles or Users depending on which connection method you have used in Hopsworks.ai, and then search for your role or user name and click on it. Go to the Permissions tab, click on Add inline policy and go to the JSON tab. Replace the existing JSON permissions with the JSON permissions below. Click on Review policy , name it, and click Create policy . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"AllowDeletingECRRepositories\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ecr:DeleteRepository\" ], \"Resource\" : [ \"arn:aws:ecr:*:*:repository/*/filebeat\" , \"arn:aws:ecr:*:*:repository/*/base\" ] } ] }","title":"Step 5: Allow Hopsworks.ai to delete ECR repositories on your behalf"},{"location":"setup_installation/aws/eks_ecr_integration/#step-6-create-a-hopsworks-cluster-with-eks-and-ecr-support","text":"In Hopsworks.ai, select Create cluster . Choose the region of your EKS cluster and fill in the name of your S3 bucket , then click Next: Create Hopsworks cluster Choose your preferred SSH key to use with the cluster, then click Next: Choose SSH key Choose the instance profile role that you have created in Step 2 (click on the refresh button if your instance profile is not in the list), then click Next: Choose instance profile role Choose the backup retention period and click Next: Choose the backup retention policy Choose Enabled to enable the use of Amazon EKS and ECR: Choose Enabled Add your EKS cluster name, then click Next: Add EKS cluster name If you followed option A when setting up the network Choose the VPC of your EKS cluster. Its name should have the form eksctl-YOUR-CLUSTER-NAME-cluster (click on the refresh button if the VPC is not in the list). If you followed option B choose the VPC you created during Step 4 . Choose VPC Choose any of the subnets in the VPC, then click Next. Note Avoid private subnets if you want to enjoy all the hopsworks features . Choose Subnet Choose the security group that you have updated/created in Step 4 , then click Next: Note If you followed option A select the Security Group with the same id as in Step 4 and NOT the ones containing ControlPlaneSecurity or ClusterSharedNode in their name. Choose Security Group Click Review and submit , then Create. Once the cluster is created, Hopsworks will use EKS to launch Python jobs, Jupyter servers, and ML model servings.","title":"Step 6: Create a Hopsworks cluster with EKS and ECR support"},{"location":"setup_installation/aws/getting_started/","text":"Getting started with Hopsworks.ai (AWS) # Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up Hopsworks.ai with your organization's AWS account. Step 1: Connecting your AWS account # Hopsworks.ai deploys Hopsworks clusters to your AWS account. To enable this you have to permit us to do so. This can be either achieved by using AWS cross-account roles or AWS access keys. We strongly recommend the usage of cross-account roles whenever possible due to security reasons. Option 1: Using AWS Cross-Account Roles # To create a cross-account role for Hopsworks.ai, you need our AWS account id and the external id we created for you. You can find this information on the first screen of the cross-account configuration flow. Take note of the account id and external id and go to the Roles section of the IAM service in the AWS Management Console and select Create role . Creating the cross-account role instructions Select Another AWS account as trusted entity and fill in our AWS account id and the external id generated for you: Creating the cross-account role step 1 Go to the last step of the wizard, name the role and create it: Creating the cross-account role step 2 As a next step, you need to create an access policy to give Hopsworks.ai permissions to manage clusters in your organization's AWS account. By default, Hopsworks.ai is automating all steps required to launch a new Hopsworks cluster. If you want to limit the required AWS permissions, see restrictive-permissions . Copy the permission JSON from the instructions: Adding the policy instructions Identify your newly created cross-account role in the Roles section of the IAM service in the AWS Management Console and select Add inline policy : Adding the inline policy step 1 Replace the JSON policy with the JSON from our instructions and continue in the wizard: Adding the inline policy step 2 Name and create the policy: Adding the inline policy step 3 Copy the Role ARN from the summary of your cross-account role: Adding the inline policy step 4 Paste the Role ARN into Hopsworks.ai and click on Finish : Saving the cross-account role Option 2: Using AWS Access Keys # You can either create a new IAM user or use an existing IAM user to create access keys for Hopsworks.ai. If you want to create a new IAM user, see Creating an IAM User in Your AWS Account . Warning We recommend using Cross-Account Roles instead of Access Keys whenever possible, see Option 1: Using AWS Cross-Account Roles . Hopsworks.ai requires a set of permissions to be able to launch clusters in your AWS account. The permissions can be granted by attaching an access policy to your IAM user. By default, Hopsworks.ai is automating all steps required to launch a new Hopsworks cluster. If you want to limit the required AWS permissions, see restrictive-permissions . The required permissions are shown in the instructions. Copy them if you want to create a new access policy: Configuring access key instructions Add a new Inline policy to your AWS user: Configuring the access key on AWS step 1 Replace the JSON policy with the JSON from our instructions and continue in the wizard: Adding the inline policy step 2 Name and create the policy: Adding the inline policy step 3 In the overview of your IAM user, select Create access key : Configuring the access key on AWS step 2 Copy the Access Key ID and the Secret Access Key : Configuring the access key on AWS step 3 Paste the Access Key ID and the Secret Access Key into Hopsworks.ai and click on Finish : Saving the access key pair Step 2: Creating Instance profile # Note If you prefer using terraform, you can skip this step and the remaining steps, and instead follow this guide . Hopsworks cluster nodes need access to certain resources such as S3 bucket and CloudWatch. Follow the instructions in this guide to create an IAM instance profile with access to your S3 bucket: Guide When creating the policy, paste the following in the JSON tab. Step 3: Creating storage # The Hopsworks clusters deployed by hopsworks.ai store their data in an S3 bucket in your AWS account. To enable this you need to create an S3 bucket and an instance profile to give cluster nodes access to the bucket. Proceed to the S3 Management Console and click on Create bucket : Create an S3 bucket Name your bucket and select the region where your Hopsworks cluster will run. Click on Create bucket at the bottom of the page. Create an S3 bucket Step 4: Create an SSH key # When deploying clusters, Hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. For this purpose, you need to add an ssh key to your AWS EC2 environment. This can be done in two ways: creating a new key pair or importing an existing key pair . Step 4.1: Create a new key pair # Proceed to Key pairs in the EC2 console and click on Create key pair Create a key pair Name your key, select the file format you prefer and click on Create key pair . Create a key pair Step 4.2: Import a key pair # Proceed to Key pairs in the EC2 console , click on Action and click on Import key pair Import a key pair Name your key pair, upload your public key and click on Import key pair . Import a key pair Step 5: Deploying a Hopsworks cluster # In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Select the Region in which you want your cluster to run (1), name your cluster (2). Select the Instance type (3) and Local storage (4) size for the cluster Head node . Enter the name of the S3 bucket (5) you created above in S3 bucket . Note The S3 bucket you are using must be empty. Press Next : Create a Hopsworks cluster, general information Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes . Note It is possible to add or remove workers or to enable autoscaling once the cluster is running. Press Next : Create a Hopsworks cluster, static workers configuration Select the SSH key that you want to use to access cluster instances: Choose SSH key Select the Instance Profile that you created above and click on Review and Submit : Choose the instance profile Note If you are an enterprise user you will have one more step before being able to click on Review and Create . In this step, you will be asked to set the backups retention policy. More details about this step here Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster Step 6: Next steps # Check out our other guides for how to get started with Hopsworks and the Feature Store: Make Hopsworks services accessible from outside services Get started with the Hopsworks Feature Store Get started with Machine Learning on Hopsworks: HopsML Get started with Hopsworks: User Guide Code examples and notebooks: hops-examples","title":"Getting Started"},{"location":"setup_installation/aws/getting_started/#getting-started-with-hopsworksai-aws","text":"Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up Hopsworks.ai with your organization's AWS account.","title":"Getting started with Hopsworks.ai (AWS)"},{"location":"setup_installation/aws/getting_started/#step-1-connecting-your-aws-account","text":"Hopsworks.ai deploys Hopsworks clusters to your AWS account. To enable this you have to permit us to do so. This can be either achieved by using AWS cross-account roles or AWS access keys. We strongly recommend the usage of cross-account roles whenever possible due to security reasons.","title":"Step 1: Connecting your AWS account"},{"location":"setup_installation/aws/getting_started/#option-1-using-aws-cross-account-roles","text":"To create a cross-account role for Hopsworks.ai, you need our AWS account id and the external id we created for you. You can find this information on the first screen of the cross-account configuration flow. Take note of the account id and external id and go to the Roles section of the IAM service in the AWS Management Console and select Create role . Creating the cross-account role instructions Select Another AWS account as trusted entity and fill in our AWS account id and the external id generated for you: Creating the cross-account role step 1 Go to the last step of the wizard, name the role and create it: Creating the cross-account role step 2 As a next step, you need to create an access policy to give Hopsworks.ai permissions to manage clusters in your organization's AWS account. By default, Hopsworks.ai is automating all steps required to launch a new Hopsworks cluster. If you want to limit the required AWS permissions, see restrictive-permissions . Copy the permission JSON from the instructions: Adding the policy instructions Identify your newly created cross-account role in the Roles section of the IAM service in the AWS Management Console and select Add inline policy : Adding the inline policy step 1 Replace the JSON policy with the JSON from our instructions and continue in the wizard: Adding the inline policy step 2 Name and create the policy: Adding the inline policy step 3 Copy the Role ARN from the summary of your cross-account role: Adding the inline policy step 4 Paste the Role ARN into Hopsworks.ai and click on Finish : Saving the cross-account role","title":"Option 1: Using AWS Cross-Account Roles"},{"location":"setup_installation/aws/getting_started/#option-2-using-aws-access-keys","text":"You can either create a new IAM user or use an existing IAM user to create access keys for Hopsworks.ai. If you want to create a new IAM user, see Creating an IAM User in Your AWS Account . Warning We recommend using Cross-Account Roles instead of Access Keys whenever possible, see Option 1: Using AWS Cross-Account Roles . Hopsworks.ai requires a set of permissions to be able to launch clusters in your AWS account. The permissions can be granted by attaching an access policy to your IAM user. By default, Hopsworks.ai is automating all steps required to launch a new Hopsworks cluster. If you want to limit the required AWS permissions, see restrictive-permissions . The required permissions are shown in the instructions. Copy them if you want to create a new access policy: Configuring access key instructions Add a new Inline policy to your AWS user: Configuring the access key on AWS step 1 Replace the JSON policy with the JSON from our instructions and continue in the wizard: Adding the inline policy step 2 Name and create the policy: Adding the inline policy step 3 In the overview of your IAM user, select Create access key : Configuring the access key on AWS step 2 Copy the Access Key ID and the Secret Access Key : Configuring the access key on AWS step 3 Paste the Access Key ID and the Secret Access Key into Hopsworks.ai and click on Finish : Saving the access key pair","title":"Option 2: Using AWS Access Keys"},{"location":"setup_installation/aws/getting_started/#step-2-creating-instance-profile","text":"Note If you prefer using terraform, you can skip this step and the remaining steps, and instead follow this guide . Hopsworks cluster nodes need access to certain resources such as S3 bucket and CloudWatch. Follow the instructions in this guide to create an IAM instance profile with access to your S3 bucket: Guide When creating the policy, paste the following in the JSON tab.","title":"Step 2: Creating Instance profile"},{"location":"setup_installation/aws/getting_started/#step-3-creating-storage","text":"The Hopsworks clusters deployed by hopsworks.ai store their data in an S3 bucket in your AWS account. To enable this you need to create an S3 bucket and an instance profile to give cluster nodes access to the bucket. Proceed to the S3 Management Console and click on Create bucket : Create an S3 bucket Name your bucket and select the region where your Hopsworks cluster will run. Click on Create bucket at the bottom of the page. Create an S3 bucket","title":"Step 3: Creating storage"},{"location":"setup_installation/aws/getting_started/#step-4-create-an-ssh-key","text":"When deploying clusters, Hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. For this purpose, you need to add an ssh key to your AWS EC2 environment. This can be done in two ways: creating a new key pair or importing an existing key pair .","title":"Step 4: Create an SSH key"},{"location":"setup_installation/aws/getting_started/#step-41-create-a-new-key-pair","text":"Proceed to Key pairs in the EC2 console and click on Create key pair Create a key pair Name your key, select the file format you prefer and click on Create key pair . Create a key pair","title":"Step 4.1: Create a new key pair"},{"location":"setup_installation/aws/getting_started/#step-42-import-a-key-pair","text":"Proceed to Key pairs in the EC2 console , click on Action and click on Import key pair Import a key pair Name your key pair, upload your public key and click on Import key pair . Import a key pair","title":"Step 4.2: Import a key pair"},{"location":"setup_installation/aws/getting_started/#step-5-deploying-a-hopsworks-cluster","text":"In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Select the Region in which you want your cluster to run (1), name your cluster (2). Select the Instance type (3) and Local storage (4) size for the cluster Head node . Enter the name of the S3 bucket (5) you created above in S3 bucket . Note The S3 bucket you are using must be empty. Press Next : Create a Hopsworks cluster, general information Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes . Note It is possible to add or remove workers or to enable autoscaling once the cluster is running. Press Next : Create a Hopsworks cluster, static workers configuration Select the SSH key that you want to use to access cluster instances: Choose SSH key Select the Instance Profile that you created above and click on Review and Submit : Choose the instance profile Note If you are an enterprise user you will have one more step before being able to click on Review and Create . In this step, you will be asked to set the backups retention policy. More details about this step here Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Step 5: Deploying a Hopsworks cluster"},{"location":"setup_installation/aws/getting_started/#step-6-next-steps","text":"Check out our other guides for how to get started with Hopsworks and the Feature Store: Make Hopsworks services accessible from outside services Get started with the Hopsworks Feature Store Get started with Machine Learning on Hopsworks: HopsML Get started with Hopsworks: User Guide Code examples and notebooks: hops-examples","title":"Step 6: Next steps"},{"location":"setup_installation/aws/instance_profile_permissions/","text":"Replace BUCKET_NAME with the appropriate S3 bucket name. Note Some of these permissions can be removed. Refer to this guide for more information. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"hopsworksaiInstanceProfile\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"S3:PutObject\" , \"S3:ListBucket\" , \"S3:GetBucketLocation\" , \"S3:GetObject\" , \"S3:DeleteObject\" , \"S3:AbortMultipartUpload\" , \"S3:ListBucketMultipartUploads\" , \"S3:PutLifecycleConfiguration\" , \"S3:GetLifecycleConfiguration\" , \"S3:PutBucketVersioning\" , \"S3:GetBucketVersioning\" , \"S3:ListBucketVersions\" , \"S3:DeleteObjectVersion\" ], \"Resource\" : [ \"arn:aws:s3:::BUCKET_NAME/*\" , \"arn:aws:s3:::BUCKET_NAME\" ] }, { \"Effect\" : \"Allow\" , \"Action\" : [ \"cloudwatch:PutMetricData\" , \"ec2:DescribeVolumes\" , \"ec2:DescribeTags\" , \"logs:PutLogEvents\" , \"logs:DescribeLogStreams\" , \"logs:DescribeLogGroups\" , \"logs:CreateLogStream\" , \"logs:CreateLogGroup\" ], \"Resource\" : \"*\" }, { \"Effect\" : \"Allow\" , \"Action\" : [ \"ssm:GetParameter\" ], \"Resource\" : \"arn:aws:ssm:*:*:parameter/AmazonCloudWatch-*\" }, { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" } ] }","title":"Instance profile permissions"},{"location":"setup_installation/aws/restrictive_permissions/","text":"Limiting AWS permissions # Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s AWS account. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down AWS permissions following the IT security policy principle of least privilege allowing Hopsworks.ai to only access resources in a specific VPC. Limiting the cross-account role permissions # Step 1: Create a VPC # To restrict Hopsworks.ai from accessing resources outside of a specific VPC, you need to create a new VPC connected to an Internet Gateway. This can be achieved in the AWS Management Console following this guide: Create the VPC . The option VPC with a Single Public Subnet from the Launch VPC Wizard should work out of the box. Alternatively, an existing VPC such as the default VPC can be used and Hopsworks.ai will be restricted to this VPC. Note the VPC ID of the VPC you want to use for the following steps. Note Make sure you enable DNS hostnames for your VPC After you have created the VPC either Create a Security Group or use VPC's default. Make sure that the VPC allow the following traffic. Inbound traffic # The Security Group and/or Network ACLs need to be configured so that at least port 80 is reachable from the internet otherwise you will have to use self signed certificate in your Hopsworks cluster. It is imperative the Security Group allows Inbound traffic from any Instance within the same Security Group in any (TCP) port. All VMs of the Cluster should be able to communicate with each other. Outbound traffic # Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai . The api.hopsworks.ai domain use a content delivery network for better performance. This result in the impossibility to predict which IP the request will be sent to. If you require a list of static IPs to allow outbound traffic from your security group, use the static IPs option during cluster creation . Similar to Inbound traffic, the Security Group in place must allow Outbound traffic in any (TCP) port towards any VM withing the same Security Group. Note If you intend to use the managed users option on your Hopsworks cluster you should also allow outbound traffic to cognito-idp.us-east-2.amazonaws.com and managedhopsworks-prod.auth.us-east-2.amazoncognito.com . Step 2: Create an instance profile # You need to create an instance profile that will identify all instances started by Hopsworks.ai. Follow this guide to create a role to be used by EC2 with no permissions attached: Creating a Role for an AWS Service (Console) . Take note of the ARN of the role you just created. You will need to add permissions to the instance profile to give access to the S3 bucket where Hopsworks will store its data. For more details about these permissions check our guide here . Check bellow for more information on restricting the permissions given the instance profile. Step 3: Set permissions of the cross-account role # During the account setup for Hopsworks.ai, you were asked to create and provide a cross-account role. If you don\u2019t remember which role you used then you can find it in Settings/Account Settings in Hopsworks.ai. Edit this role in the AWS Management Console and overwrite the existing inline policy with the following policy. Note that you have to replace [INSTANCE_PROFILE_NAME] and [VPC_ID] for multiple occurrences in the given policy. If you want to learn more about how this policy works check out: How to Help Lock Down a User\u2019s Amazon EC2 Capabilities to a Single VPC . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"NonResourceBasedPermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeInstances\" , \"ec2:DescribeVpcs\" , \"ec2:DescribeVolumes\" , \"ec2:DescribeSubnets\" , \"ec2:DescribeKeyPairs\" , \"ec2:DescribeInstanceStatus\" , \"iam:ListInstanceProfiles\" , \"ec2:DescribeSecurityGroups\" , \"ec2:DescribeVpcAttribute\" , \"ec2:DescribeRouteTables\" ], \"Resource\" : \"*\" }, { \"Sid\" : \"IAMPassRoleToInstance\" , \"Effect\" : \"Allow\" , \"Action\" : \"iam:PassRole\" , \"Resource\" : \"arn:aws:iam::*:role/[INSTANCE_PROFILE_NAME]\" }, { \"Sid\" : \"EC2RunInstancesOnlyWithGivenRole\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:RunInstances\" , \"Resource\" : \"arn:aws:ec2:*:*:instance/*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:InstanceProfile\" : \"arn:aws:iam::*:instance-profile/[INSTANCE_PROFILE_NAME]\" } } }, { \"Sid\" : \"EC2RunInstancesOnlyInGivenVpc\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:RunInstances\" , \"Resource\" : \"arn:aws:ec2:*:*:subnet/*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:vpc\" : \"arn:aws:ec2:*:*:vpc/[VPC_ID]\" } } }, { \"Sid\" : \"AllowInstanceActions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:StopInstances\" , \"ec2:TerminateInstances\" , \"ec2:StartInstances\" , \"ec2:CreateTags\" , \"ec2:AssociateIamInstanceProfile\" ], \"Resource\" : \"arn:aws:ec2:*:*:instance/*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:InstanceProfile\" : \"arn:aws:iam::*:instance-profile/[INSTANCE_PROFILE_NAME]\" } } }, { \"Sid\" : \"RemainingRunInstancePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:RunInstances\" , \"Resource\" : [ \"arn:aws:ec2:*:*:volume/*\" , \"arn:aws:ec2:*::image/*\" , \"arn:aws:ec2:*::snapshot/*\" , \"arn:aws:ec2:*:*:network-interface/*\" , \"arn:aws:ec2:*:*:key-pair/*\" , \"arn:aws:ec2:*:*:security-group/*\" ] }, { \"Sid\" : \"EC2VpcNonResourceSpecificActions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:AuthorizeSecurityGroupIngress\" , \"ec2:RevokeSecurityGroupIngress\" , \"ec2:DeleteSecurityGroup\" ], \"Resource\" : \"*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:vpc\" : \"arn:aws:ec2:*:*:vpc/[VPC_ID]\" } } }, { \"Sid\" : \"EC2BackupCreation\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" } ] } Step 4: Create your Hopsworks instance # You can now create a new Hopsworks instance in Hopsworks.ai by selecting the configured instance profile, VPC and security group during instance configuration. Selecting any other VPCs or instance profiles will result in permissions errors. Step 5: Supporting multiple VPCs # The policy can be extended to give Hopsworks.ai access to multiple VPCs. See: Creating a Condition with Multiple Keys or Values . Backup permissions # The following permissions are only needed for the backup feature. You can remove them if you are not going to create backups or if you do not have access to this Enterprise feature. { \"Sid\" : \"EC2BackupCreation\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" , } Other removable permissions # The following permissions are needed to give an early warning if your VPC and security groups are badly configured. You can remove them if you don't need it. \"ec2:DescribeVpcAttribute\" , \"ec2:DescribeRouteTables\" The following permissions are used to let you close and open ports on your cluster from hopswork.ai, you can remove them if you do not want to open ports on your cluster or if you want to manually open ports in EC2. { \"Sid\" : \"EC2VpcNonResourceSpecificActions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:AuthorizeSecurityGroupIngress\" , \"ec2:RevokeSecurityGroupIngress\" , \"ec2:DeleteSecurityGroup\" ], \"Resource\" : \"*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:vpc\" : \"arn:aws:ec2:*:*:vpc/[VPC_ID]\" } } } Limiting the instance profile permissions # Backups # If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring instance profile permissions . For this remove the following permissions from the instance profile: \"S3:PutLifecycleConfiguration\" , \"S3:GetLifecycleConfiguration\" , \"S3:PutBucketVersioning\" , \"S3:ListBucketVersions\" , \"S3:DeleteObjectVersion\" , CloudWatch Logs # Hopsworks put its logs in Amazon CloudWatch so that you can access them without having to ssh into the machine. If you are not interested in this feature you can remove the following from your instance profile policy: { \"Effect\" : \"Allow\" , \"Action\" : [ \"cloudwatch:PutMetricData\" , \"ec2:DescribeVolumes\" , \"ec2:DescribeTags\" , \"logs:PutLogEvents\" , \"logs:DescribeLogStreams\" , \"logs:DescribeLogGroups\" , \"logs:CreateLogStream\" , \"logs:CreateLogGroup\" ], \"Resource\" : \"*\" }, { \"Effect\" : \"Allow\" , \"Action\" : [ \"ssm:GetParameter\" ], \"Resource\" : \"arn:aws:ssm:*:*:parameter/AmazonCloudWatch-*\" } Upgrade permissions # Removing upgrade permissions # If you do not intend to upgrade your cluster to newer versions of Hopsworks, then you can remove the upgrade permissions statement from the instance profile that you have created here . For this remove the following statement from your instance profile { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" } Limiting upgrade permissions # You can use tags to restrict the upgrade permissions to only the resources created for your cluster. For this attach a tag to your cluster during the cluster creation . Then, replace the upgrade permissions with the following policy instead. First you need to replace REGION and ACCOUNT with your region and account where you run your cluster, then replace HEAD_NODE_INSTANCE_ID with your aws instance id of the head node and HEAD_NODE_VOLUME_ID with the volume id attached to the head node, and finally replace the TAG_KEY and TAG_VALUE with your the tag name and value that is used with your cluster. { \"Version\" : \"2012-10-17\" , \"Statement\" :[ { \"Sid\" : \"AllowAttachVolumeForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:AttachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:volume/HEAD_NODE_VOLUME_ID\" }, { \"Sid\" : \"AllowAttachVolumeForUpgradeOnlyTaggedInstance\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:AttachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:instance/*\" , \"Condition\" :{ \"StringEquals\" :{ \"ec2:ResourceTag/TAG_KEY\" : \"TAG_VALUE\" } } }, { \"Sid\" : \"AllowDetachVolumeForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:DetachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:volume/HEAD_NODE_VOLUME_ID\" }, { \"Sid\" : \"AllowDetachVolumeForUpgradeOnlyTaggedInstance\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:DetachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:instance/*\" , \"Condition\" :{ \"StringEquals\" :{ \"ec2:ResourceTag/TAG_KEY\" : \"TAG_VALUE\" } } }, { \"Sid\" : \"AllowModifyInstanceAttributeForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:ModifyInstanceAttribute\" , \"Resource\" :[ \"arn:aws:ec2:REGION:ACCOUNT:instance/HEAD_NODE_INSTANCE_ID\" , \"arn:aws:ec2:REGION:ACCOUNT:volume/HEAD_NODE_VOLUME_ID\" ] }, { \"Sid\" : \"AllowDescribeVolumesForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:DescribeVolumes\" , \"Resource\" : \"*\" } ] }","title":"Limiting Permissions"},{"location":"setup_installation/aws/restrictive_permissions/#limiting-aws-permissions","text":"Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s AWS account. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down AWS permissions following the IT security policy principle of least privilege allowing Hopsworks.ai to only access resources in a specific VPC.","title":"Limiting AWS permissions"},{"location":"setup_installation/aws/restrictive_permissions/#limiting-the-cross-account-role-permissions","text":"","title":"Limiting the cross-account role permissions"},{"location":"setup_installation/aws/restrictive_permissions/#step-1-create-a-vpc","text":"To restrict Hopsworks.ai from accessing resources outside of a specific VPC, you need to create a new VPC connected to an Internet Gateway. This can be achieved in the AWS Management Console following this guide: Create the VPC . The option VPC with a Single Public Subnet from the Launch VPC Wizard should work out of the box. Alternatively, an existing VPC such as the default VPC can be used and Hopsworks.ai will be restricted to this VPC. Note the VPC ID of the VPC you want to use for the following steps. Note Make sure you enable DNS hostnames for your VPC After you have created the VPC either Create a Security Group or use VPC's default. Make sure that the VPC allow the following traffic.","title":"Step 1: Create a VPC"},{"location":"setup_installation/aws/restrictive_permissions/#inbound-traffic","text":"The Security Group and/or Network ACLs need to be configured so that at least port 80 is reachable from the internet otherwise you will have to use self signed certificate in your Hopsworks cluster. It is imperative the Security Group allows Inbound traffic from any Instance within the same Security Group in any (TCP) port. All VMs of the Cluster should be able to communicate with each other.","title":"Inbound traffic"},{"location":"setup_installation/aws/restrictive_permissions/#outbound-traffic","text":"Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai . The api.hopsworks.ai domain use a content delivery network for better performance. This result in the impossibility to predict which IP the request will be sent to. If you require a list of static IPs to allow outbound traffic from your security group, use the static IPs option during cluster creation . Similar to Inbound traffic, the Security Group in place must allow Outbound traffic in any (TCP) port towards any VM withing the same Security Group. Note If you intend to use the managed users option on your Hopsworks cluster you should also allow outbound traffic to cognito-idp.us-east-2.amazonaws.com and managedhopsworks-prod.auth.us-east-2.amazoncognito.com .","title":"Outbound traffic"},{"location":"setup_installation/aws/restrictive_permissions/#step-2-create-an-instance-profile","text":"You need to create an instance profile that will identify all instances started by Hopsworks.ai. Follow this guide to create a role to be used by EC2 with no permissions attached: Creating a Role for an AWS Service (Console) . Take note of the ARN of the role you just created. You will need to add permissions to the instance profile to give access to the S3 bucket where Hopsworks will store its data. For more details about these permissions check our guide here . Check bellow for more information on restricting the permissions given the instance profile.","title":"Step 2: Create an instance profile"},{"location":"setup_installation/aws/restrictive_permissions/#step-3-set-permissions-of-the-cross-account-role","text":"During the account setup for Hopsworks.ai, you were asked to create and provide a cross-account role. If you don\u2019t remember which role you used then you can find it in Settings/Account Settings in Hopsworks.ai. Edit this role in the AWS Management Console and overwrite the existing inline policy with the following policy. Note that you have to replace [INSTANCE_PROFILE_NAME] and [VPC_ID] for multiple occurrences in the given policy. If you want to learn more about how this policy works check out: How to Help Lock Down a User\u2019s Amazon EC2 Capabilities to a Single VPC . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"NonResourceBasedPermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeInstances\" , \"ec2:DescribeVpcs\" , \"ec2:DescribeVolumes\" , \"ec2:DescribeSubnets\" , \"ec2:DescribeKeyPairs\" , \"ec2:DescribeInstanceStatus\" , \"iam:ListInstanceProfiles\" , \"ec2:DescribeSecurityGroups\" , \"ec2:DescribeVpcAttribute\" , \"ec2:DescribeRouteTables\" ], \"Resource\" : \"*\" }, { \"Sid\" : \"IAMPassRoleToInstance\" , \"Effect\" : \"Allow\" , \"Action\" : \"iam:PassRole\" , \"Resource\" : \"arn:aws:iam::*:role/[INSTANCE_PROFILE_NAME]\" }, { \"Sid\" : \"EC2RunInstancesOnlyWithGivenRole\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:RunInstances\" , \"Resource\" : \"arn:aws:ec2:*:*:instance/*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:InstanceProfile\" : \"arn:aws:iam::*:instance-profile/[INSTANCE_PROFILE_NAME]\" } } }, { \"Sid\" : \"EC2RunInstancesOnlyInGivenVpc\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:RunInstances\" , \"Resource\" : \"arn:aws:ec2:*:*:subnet/*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:vpc\" : \"arn:aws:ec2:*:*:vpc/[VPC_ID]\" } } }, { \"Sid\" : \"AllowInstanceActions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:StopInstances\" , \"ec2:TerminateInstances\" , \"ec2:StartInstances\" , \"ec2:CreateTags\" , \"ec2:AssociateIamInstanceProfile\" ], \"Resource\" : \"arn:aws:ec2:*:*:instance/*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:InstanceProfile\" : \"arn:aws:iam::*:instance-profile/[INSTANCE_PROFILE_NAME]\" } } }, { \"Sid\" : \"RemainingRunInstancePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:RunInstances\" , \"Resource\" : [ \"arn:aws:ec2:*:*:volume/*\" , \"arn:aws:ec2:*::image/*\" , \"arn:aws:ec2:*::snapshot/*\" , \"arn:aws:ec2:*:*:network-interface/*\" , \"arn:aws:ec2:*:*:key-pair/*\" , \"arn:aws:ec2:*:*:security-group/*\" ] }, { \"Sid\" : \"EC2VpcNonResourceSpecificActions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:AuthorizeSecurityGroupIngress\" , \"ec2:RevokeSecurityGroupIngress\" , \"ec2:DeleteSecurityGroup\" ], \"Resource\" : \"*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:vpc\" : \"arn:aws:ec2:*:*:vpc/[VPC_ID]\" } } }, { \"Sid\" : \"EC2BackupCreation\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" } ] }","title":"Step 3: Set permissions of the cross-account role"},{"location":"setup_installation/aws/restrictive_permissions/#step-4-create-your-hopsworks-instance","text":"You can now create a new Hopsworks instance in Hopsworks.ai by selecting the configured instance profile, VPC and security group during instance configuration. Selecting any other VPCs or instance profiles will result in permissions errors.","title":"Step 4: Create your Hopsworks instance"},{"location":"setup_installation/aws/restrictive_permissions/#step-5-supporting-multiple-vpcs","text":"The policy can be extended to give Hopsworks.ai access to multiple VPCs. See: Creating a Condition with Multiple Keys or Values .","title":"Step 5: Supporting multiple VPCs"},{"location":"setup_installation/aws/restrictive_permissions/#backup-permissions","text":"The following permissions are only needed for the backup feature. You can remove them if you are not going to create backups or if you do not have access to this Enterprise feature. { \"Sid\" : \"EC2BackupCreation\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" , }","title":"Backup permissions"},{"location":"setup_installation/aws/restrictive_permissions/#other-removable-permissions","text":"The following permissions are needed to give an early warning if your VPC and security groups are badly configured. You can remove them if you don't need it. \"ec2:DescribeVpcAttribute\" , \"ec2:DescribeRouteTables\" The following permissions are used to let you close and open ports on your cluster from hopswork.ai, you can remove them if you do not want to open ports on your cluster or if you want to manually open ports in EC2. { \"Sid\" : \"EC2VpcNonResourceSpecificActions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:AuthorizeSecurityGroupIngress\" , \"ec2:RevokeSecurityGroupIngress\" , \"ec2:DeleteSecurityGroup\" ], \"Resource\" : \"*\" , \"Condition\" : { \"ArnLike\" : { \"ec2:vpc\" : \"arn:aws:ec2:*:*:vpc/[VPC_ID]\" } } }","title":"Other removable permissions"},{"location":"setup_installation/aws/restrictive_permissions/#limiting-the-instance-profile-permissions","text":"","title":"Limiting the instance profile permissions"},{"location":"setup_installation/aws/restrictive_permissions/#backups","text":"If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring instance profile permissions . For this remove the following permissions from the instance profile: \"S3:PutLifecycleConfiguration\" , \"S3:GetLifecycleConfiguration\" , \"S3:PutBucketVersioning\" , \"S3:ListBucketVersions\" , \"S3:DeleteObjectVersion\" ,","title":"Backups"},{"location":"setup_installation/aws/restrictive_permissions/#cloudwatch-logs","text":"Hopsworks put its logs in Amazon CloudWatch so that you can access them without having to ssh into the machine. If you are not interested in this feature you can remove the following from your instance profile policy: { \"Effect\" : \"Allow\" , \"Action\" : [ \"cloudwatch:PutMetricData\" , \"ec2:DescribeVolumes\" , \"ec2:DescribeTags\" , \"logs:PutLogEvents\" , \"logs:DescribeLogStreams\" , \"logs:DescribeLogGroups\" , \"logs:CreateLogStream\" , \"logs:CreateLogGroup\" ], \"Resource\" : \"*\" }, { \"Effect\" : \"Allow\" , \"Action\" : [ \"ssm:GetParameter\" ], \"Resource\" : \"arn:aws:ssm:*:*:parameter/AmazonCloudWatch-*\" }","title":"CloudWatch Logs"},{"location":"setup_installation/aws/restrictive_permissions/#upgrade-permissions","text":"","title":"Upgrade permissions"},{"location":"setup_installation/aws/restrictive_permissions/#removing-upgrade-permissions","text":"If you do not intend to upgrade your cluster to newer versions of Hopsworks, then you can remove the upgrade permissions statement from the instance profile that you have created here . For this remove the following statement from your instance profile { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" }","title":"Removing upgrade permissions"},{"location":"setup_installation/aws/restrictive_permissions/#limiting-upgrade-permissions","text":"You can use tags to restrict the upgrade permissions to only the resources created for your cluster. For this attach a tag to your cluster during the cluster creation . Then, replace the upgrade permissions with the following policy instead. First you need to replace REGION and ACCOUNT with your region and account where you run your cluster, then replace HEAD_NODE_INSTANCE_ID with your aws instance id of the head node and HEAD_NODE_VOLUME_ID with the volume id attached to the head node, and finally replace the TAG_KEY and TAG_VALUE with your the tag name and value that is used with your cluster. { \"Version\" : \"2012-10-17\" , \"Statement\" :[ { \"Sid\" : \"AllowAttachVolumeForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:AttachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:volume/HEAD_NODE_VOLUME_ID\" }, { \"Sid\" : \"AllowAttachVolumeForUpgradeOnlyTaggedInstance\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:AttachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:instance/*\" , \"Condition\" :{ \"StringEquals\" :{ \"ec2:ResourceTag/TAG_KEY\" : \"TAG_VALUE\" } } }, { \"Sid\" : \"AllowDetachVolumeForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:DetachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:volume/HEAD_NODE_VOLUME_ID\" }, { \"Sid\" : \"AllowDetachVolumeForUpgradeOnlyTaggedInstance\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:DetachVolume\" , \"Resource\" : \"arn:aws:ec2:REGION:ACCOUNT:instance/*\" , \"Condition\" :{ \"StringEquals\" :{ \"ec2:ResourceTag/TAG_KEY\" : \"TAG_VALUE\" } } }, { \"Sid\" : \"AllowModifyInstanceAttributeForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:ModifyInstanceAttribute\" , \"Resource\" :[ \"arn:aws:ec2:REGION:ACCOUNT:instance/HEAD_NODE_INSTANCE_ID\" , \"arn:aws:ec2:REGION:ACCOUNT:volume/HEAD_NODE_VOLUME_ID\" ] }, { \"Sid\" : \"AllowDescribeVolumesForUpgrade\" , \"Effect\" : \"Allow\" , \"Action\" : \"ec2:DescribeVolumes\" , \"Resource\" : \"*\" } ] }","title":"Limiting upgrade permissions"},{"location":"setup_installation/aws/upgrade/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (AWS) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available Step 2: Add upgrade permissions to your instance profile # Note You can skip this step if you already have the following permissions in your instance profile: [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ] We require extra permissions to be added to the instance profile attached to your cluster to proceed with the upgrade. First to get the name of your instance profile, click on the Details tab as shown below: Getting the name of your instance profile Once you get your instance profile name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . Note You can restrict the upgrade permissions given to your instance profile. Refer to this guide for more information. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" } ] } Step 3: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your instance profile (hopsworks-doc) includes the following permissions: [ \"ec2:DetachVolume\", \"ec2:AttachVolume\", \"ec2:ModifyInstanceAttribute\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your instance profile, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Misconfigured upgrade permissions # During the upgrade process, Hopsworks.ai starts by validating your instance profile permissions to ensure that it includes the required upgrade permissions. If one or more permissions are missing, or if the resource is not set correctly, you will be notified with an error message and a Retry button will appear as shown below: Upgrade permissions are missing Update you instance profile accordingly, then click Retry Upgrade is running Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (AWS)"},{"location":"setup_installation/aws/upgrade/#upgrade-existing-clusters-on-hopsworksai-from-version-22-or-older-aws","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (AWS)"},{"location":"setup_installation/aws/upgrade/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/aws/upgrade/#step-2-add-upgrade-permissions-to-your-instance-profile","text":"Note You can skip this step if you already have the following permissions in your instance profile: [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ] We require extra permissions to be added to the instance profile attached to your cluster to proceed with the upgrade. First to get the name of your instance profile, click on the Details tab as shown below: Getting the name of your instance profile Once you get your instance profile name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . Note You can restrict the upgrade permissions given to your instance profile. Refer to this guide for more information. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" } ] }","title":"Step 2: Add upgrade permissions to your instance profile"},{"location":"setup_installation/aws/upgrade/#step-3-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your instance profile (hopsworks-doc) includes the following permissions: [ \"ec2:DetachVolume\", \"ec2:AttachVolume\", \"ec2:ModifyInstanceAttribute\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete","title":"Step 3: Run the upgrade process"},{"location":"setup_installation/aws/upgrade/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your instance profile, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/aws/upgrade/#error-1-misconfigured-upgrade-permissions","text":"During the upgrade process, Hopsworks.ai starts by validating your instance profile permissions to ensure that it includes the required upgrade permissions. If one or more permissions are missing, or if the resource is not set correctly, you will be notified with an error message and a Retry button will appear as shown below: Upgrade permissions are missing Update you instance profile accordingly, then click Retry Upgrade is running","title":"Error 1: Misconfigured upgrade permissions"},{"location":"setup_installation/aws/upgrade/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/aws/upgrade_2.4/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (AWS) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available Step 2: Add backup permissions to your cross account role # Note You can skip this step if you already have the following permissions in your cross account role: [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ] We require some extra permissions to be added to the role you have created when connecting your AWS account as described in getting started guide . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. First, check which role or access key you have added to Hopsworks.ai, you can go to the Settings tab, and then click Edit next to the AWS cloud account Cloud Accounts Once you have clicked on Edit , you will be able to see the current assigned role AWS Cross-Account Role Once you get your role name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"HopsworksAIBackup\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" } ] } Step 3: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your cross-account role which you have connected to Hopsworks.ai has the following permissions: [ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version on the Details tab of your cluster. Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your cross-account role, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Missing backup permissions # If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Upgrade permissions are missing Update you cross account role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again. Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (AWS)"},{"location":"setup_installation/aws/upgrade_2.4/#upgrade-existing-clusters-on-hopsworksai-from-version-24-or-newer-aws","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (AWS)"},{"location":"setup_installation/aws/upgrade_2.4/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/aws/upgrade_2.4/#step-2-add-backup-permissions-to-your-cross-account-role","text":"Note You can skip this step if you already have the following permissions in your cross account role: [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ] We require some extra permissions to be added to the role you have created when connecting your AWS account as described in getting started guide . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. First, check which role or access key you have added to Hopsworks.ai, you can go to the Settings tab, and then click Edit next to the AWS cloud account Cloud Accounts Once you have clicked on Edit , you will be able to see the current assigned role AWS Cross-Account Role Once you get your role name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"HopsworksAIBackup\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" } ] }","title":"Step 2: Add backup permissions to your cross account role"},{"location":"setup_installation/aws/upgrade_2.4/#step-3-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your cross-account role which you have connected to Hopsworks.ai has the following permissions: [ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version on the Details tab of your cluster.","title":"Step 3: Run the upgrade process"},{"location":"setup_installation/aws/upgrade_2.4/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your cross-account role, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/aws/upgrade_2.4/#error-1-missing-backup-permissions","text":"If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Upgrade permissions are missing Update you cross account role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again.","title":"Error 1: Missing backup permissions"},{"location":"setup_installation/aws/upgrade_2.4/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/azure/aks_acr_integration/","text":"Integration with Azure AKS and ACR # This guide shows how to create a cluster in hopsworks.ai with integrated support for Azure Kubernetes Service (AKS) and Azure Container Registry (ACR). This enables Hopsworks to launch Python jobs, Jupyter servers, and serve models on top of AKS. Hopsworks AKS and ACR integration have four requirements: A virtual network with access to AKS pods and the AKS API servers One Azure container registry configured in your account One AKS cluster Permissions to the ACR and AKS attached to a user-managed identity This guide provides an example setup with a private AKS cluster and public ACR. Note A public AKS cluster means the Kubernetes API server is accessible outside the virtual network it is deployed in. Similarly, a public ACR is accessible through the internet. User assigned managed identity (managed identity) # Note A user assigned managed identity (managed identity) can be created at the subscription level or to a specific resource group in a subscription. The managed identity is attached to the virtual machines that run inside your subscription (or resource group). Hence, the permissions only apply to services that run within your subscription (or resource group). The AKS and ACR integration requires some permissions to be attached to the managed identity used by the Hopsworks cluster. If you have already created a user assigned managed identity for the storage continue to Add role assignment to the managed identity using this identity. To set up the managed identity, go to the resource group where you will add the managed identity - this should be the same resource group you will deploy Hopsworks in. Click on the Add button. In the search dialog, enter \"user assigned managed identity\" . Click on Create . Then give a name to the managed identity and make sure that it is in the Region where you will deploy your cluster. Click on Review + create , and click on Create . Add role assignment to the managed identity # Go to the managed identity created above. Click on Azure role assignments in the left column. Click on Add role assignment . For the Scope select Resource group or Subscription depending on your preference. Select the Role AcrPull and click on Save . Repeat the same operation with the following roles: AcrPull AcrPush AcrDelete Azure Kubernetes Service Cluster User Role Warning You will also need to attach storage access permissions to the managed identity, see Creating and configuring a storage Once finished the role assignments should look similar to the picture below. AKS permissions Private AKS cluster and public ACR # This guide will step through setting up a private AKS cluster and a public ACR. Step 1: Create an AKS cluster # Go to Kubernetes services in the azure portal and click Add then Add Kubernetes cluster . Place the Kubernetes cluster in the same resource group and region as the Hopsworks cluster and choose a name for the Kubernetes cluster. AKS general configuration Next, click on the Authentication tab and verify the settings are as follow: Authentication method: System-assigned managed identity Role-based access control (RBAC): Enabled AKS-managed Azure Active Directory: Disabled Note Currently, AKS is only supported through managed identities. Contact the Logical Clocks sales team if you have a self-managed Kubernetes cluster. AKS authencation configuration Next, go to the networking tab and check Azure CNI . The portal will automatically fill in the IP address ranges for the Kubernetes virtual network. Take note of the virtual network name that is created, in this example the virtual network name was hopsworksstagevnet154. Lastly, check the Enable private cluster option. AKS network configuration Next, go to the Integrations tab. Under container registry click Create new. AKS create ACR Choose a name for the registry and select premium for the SKU. Then press OK . ACR configuration Next press Review + create , then click Create . To prevent the registry from filling up with unnecessary images and artifacts you can enable a retention policy. A retention policy will automatically remove untagged manifests after a specified number of days. To enable a retention policy, go to the registry you created. Go to the Retention (preview) tab and set Status from disabled to enabled . Set the retention policy for 7 days as in the figure below, then press save . ACR retention policy Step 2: create a virtual network for the Hopsworks cluster # Because the Kubernetes API service is private the Hopsworks cluster must be able to reach it over a private network. There are two options to integrate with a private AKS cluster. The first option ( A ) is to put the Hopsworks cluster in a pre-defined virtual network with a peering setup to the Kubernetes network. The second option ( B ) is to create a subnet inside the Kubernetes virtual network where the Hopsworks cluster will be placed. Option A : Peering setup # To establish virtual peering between the Kubernetes cluster and Hopsworks, you need to select or create a virtual network for Hopsworks. Go to virtual networks and press create. Choose a name for the new virtual network and select the same resource group you are planning to use for your Hopsworks cluster. Next, go to the IP Addresses tab. Create an address space that does not overlap with the address space in the Kubernetes network. In the previous example, the automatically created Kubernetes network used the address space 10.0.0.0/8 . Hence, the address space 172.18.0.0/16 can safely be used. Next click Review + Create , then Create . Next, go to the created virtual network and go to the Peerings tab. Then click Add . Virtual network peering Choose a name for the peering link. Check the Traffic to remote virtual network as Allow , and Traffic forwarded from remote virtual network to Block . Virtual network peering configuration For the virtual network select the virtual network which was created by AKS, in our example this was hopsworksstagevnet154 . Then press Add . Virtual network peering configuration continuation The last step is to set up a DNS private link to be able to use DNS resolution for the Kubernetes API servers. Go to resource groups in the Azure portal and find the resource group of the Kubernetes cluster. This will be in the form of MC_ in this example it was MC_hopsworks-stage_hopsworks-aks_northeurope . Open the resource group and click on the DNS zone. Private DNS link setup In the left plane there is a tab called Virtual network links , click on the tab. Next press Add . Private DNS link configuration Choose a name for the private link and select the virtual network you will use for the Hopsworks cluster, then press OK. Private DNS link configuration The setup is now finalized and you can create the Hopsworks cluster. Option B : Subnet in AKS network # With this setup, the Hopsworks cluster will reside in the same virtual network as the AKS cluster. The difference is that a new subnet in the virtual network will be used for the Hopsworks cluster. To set up the subnet, first, go to the virtual network that was created by AKS. In our example, this was hopsworksstagevnet154. Next, go to the subnets tab. AKS subnet setup Press + Subnet . Choose a name for the subnet, for example, \"hopsworks\" and an IP range that does not overlap with the Kubernetes network. Then save. AKS subnet setup Create the Hopsworks cluster # This step assumes you are creating your Hopsworks cluster using hopsworks.ai. The AKS configuration can be set under the Managed containers tab. Set Use Azure AKS and Azure ACR as enabled. Two new fields will pop up. Fill them with the name of the container registry and the AKS you created above. In the previous example, we created an ACR with the name hopsworksaks and an AKS cluster with the name hopsaks-cluster . Hence, the configuration should look similar to the picture below Hopsworks AKS configuration In the virtual network tab, you have to select either the virtual network you created for the peering setup or the Kubernetes virtual network depending on which approach you choose. Under the subnet tab, you have to choose the default subnet if you choose the peering approach or the subnet you created if you choose to create a new subnet inside the AKS virtual network.","title":"Integration with Azure AKS and ACR"},{"location":"setup_installation/azure/aks_acr_integration/#integration-with-azure-aks-and-acr","text":"This guide shows how to create a cluster in hopsworks.ai with integrated support for Azure Kubernetes Service (AKS) and Azure Container Registry (ACR). This enables Hopsworks to launch Python jobs, Jupyter servers, and serve models on top of AKS. Hopsworks AKS and ACR integration have four requirements: A virtual network with access to AKS pods and the AKS API servers One Azure container registry configured in your account One AKS cluster Permissions to the ACR and AKS attached to a user-managed identity This guide provides an example setup with a private AKS cluster and public ACR. Note A public AKS cluster means the Kubernetes API server is accessible outside the virtual network it is deployed in. Similarly, a public ACR is accessible through the internet.","title":"Integration with Azure AKS and ACR"},{"location":"setup_installation/azure/aks_acr_integration/#user-assigned-managed-identity-managed-identity","text":"Note A user assigned managed identity (managed identity) can be created at the subscription level or to a specific resource group in a subscription. The managed identity is attached to the virtual machines that run inside your subscription (or resource group). Hence, the permissions only apply to services that run within your subscription (or resource group). The AKS and ACR integration requires some permissions to be attached to the managed identity used by the Hopsworks cluster. If you have already created a user assigned managed identity for the storage continue to Add role assignment to the managed identity using this identity. To set up the managed identity, go to the resource group where you will add the managed identity - this should be the same resource group you will deploy Hopsworks in. Click on the Add button. In the search dialog, enter \"user assigned managed identity\" . Click on Create . Then give a name to the managed identity and make sure that it is in the Region where you will deploy your cluster. Click on Review + create , and click on Create .","title":"User assigned managed identity (managed identity)"},{"location":"setup_installation/azure/aks_acr_integration/#add-role-assignment-to-the-managed-identity","text":"Go to the managed identity created above. Click on Azure role assignments in the left column. Click on Add role assignment . For the Scope select Resource group or Subscription depending on your preference. Select the Role AcrPull and click on Save . Repeat the same operation with the following roles: AcrPull AcrPush AcrDelete Azure Kubernetes Service Cluster User Role Warning You will also need to attach storage access permissions to the managed identity, see Creating and configuring a storage Once finished the role assignments should look similar to the picture below. AKS permissions","title":"Add role assignment to the managed identity"},{"location":"setup_installation/azure/aks_acr_integration/#private-aks-cluster-and-public-acr","text":"This guide will step through setting up a private AKS cluster and a public ACR.","title":"Private AKS cluster and public ACR"},{"location":"setup_installation/azure/aks_acr_integration/#step-1-create-an-aks-cluster","text":"Go to Kubernetes services in the azure portal and click Add then Add Kubernetes cluster . Place the Kubernetes cluster in the same resource group and region as the Hopsworks cluster and choose a name for the Kubernetes cluster. AKS general configuration Next, click on the Authentication tab and verify the settings are as follow: Authentication method: System-assigned managed identity Role-based access control (RBAC): Enabled AKS-managed Azure Active Directory: Disabled Note Currently, AKS is only supported through managed identities. Contact the Logical Clocks sales team if you have a self-managed Kubernetes cluster. AKS authencation configuration Next, go to the networking tab and check Azure CNI . The portal will automatically fill in the IP address ranges for the Kubernetes virtual network. Take note of the virtual network name that is created, in this example the virtual network name was hopsworksstagevnet154. Lastly, check the Enable private cluster option. AKS network configuration Next, go to the Integrations tab. Under container registry click Create new. AKS create ACR Choose a name for the registry and select premium for the SKU. Then press OK . ACR configuration Next press Review + create , then click Create . To prevent the registry from filling up with unnecessary images and artifacts you can enable a retention policy. A retention policy will automatically remove untagged manifests after a specified number of days. To enable a retention policy, go to the registry you created. Go to the Retention (preview) tab and set Status from disabled to enabled . Set the retention policy for 7 days as in the figure below, then press save . ACR retention policy","title":"Step 1: Create an AKS cluster"},{"location":"setup_installation/azure/aks_acr_integration/#step-2-create-a-virtual-network-for-the-hopsworks-cluster","text":"Because the Kubernetes API service is private the Hopsworks cluster must be able to reach it over a private network. There are two options to integrate with a private AKS cluster. The first option ( A ) is to put the Hopsworks cluster in a pre-defined virtual network with a peering setup to the Kubernetes network. The second option ( B ) is to create a subnet inside the Kubernetes virtual network where the Hopsworks cluster will be placed.","title":"Step 2: create a virtual network for the Hopsworks cluster"},{"location":"setup_installation/azure/aks_acr_integration/#option-a-peering-setup","text":"To establish virtual peering between the Kubernetes cluster and Hopsworks, you need to select or create a virtual network for Hopsworks. Go to virtual networks and press create. Choose a name for the new virtual network and select the same resource group you are planning to use for your Hopsworks cluster. Next, go to the IP Addresses tab. Create an address space that does not overlap with the address space in the Kubernetes network. In the previous example, the automatically created Kubernetes network used the address space 10.0.0.0/8 . Hence, the address space 172.18.0.0/16 can safely be used. Next click Review + Create , then Create . Next, go to the created virtual network and go to the Peerings tab. Then click Add . Virtual network peering Choose a name for the peering link. Check the Traffic to remote virtual network as Allow , and Traffic forwarded from remote virtual network to Block . Virtual network peering configuration For the virtual network select the virtual network which was created by AKS, in our example this was hopsworksstagevnet154 . Then press Add . Virtual network peering configuration continuation The last step is to set up a DNS private link to be able to use DNS resolution for the Kubernetes API servers. Go to resource groups in the Azure portal and find the resource group of the Kubernetes cluster. This will be in the form of MC_ in this example it was MC_hopsworks-stage_hopsworks-aks_northeurope . Open the resource group and click on the DNS zone. Private DNS link setup In the left plane there is a tab called Virtual network links , click on the tab. Next press Add . Private DNS link configuration Choose a name for the private link and select the virtual network you will use for the Hopsworks cluster, then press OK. Private DNS link configuration The setup is now finalized and you can create the Hopsworks cluster.","title":"Option A: Peering setup"},{"location":"setup_installation/azure/aks_acr_integration/#option-b-subnet-in-aks-network","text":"With this setup, the Hopsworks cluster will reside in the same virtual network as the AKS cluster. The difference is that a new subnet in the virtual network will be used for the Hopsworks cluster. To set up the subnet, first, go to the virtual network that was created by AKS. In our example, this was hopsworksstagevnet154. Next, go to the subnets tab. AKS subnet setup Press + Subnet . Choose a name for the subnet, for example, \"hopsworks\" and an IP range that does not overlap with the Kubernetes network. Then save. AKS subnet setup","title":"Option B: Subnet in AKS network"},{"location":"setup_installation/azure/aks_acr_integration/#create-the-hopsworks-cluster","text":"This step assumes you are creating your Hopsworks cluster using hopsworks.ai. The AKS configuration can be set under the Managed containers tab. Set Use Azure AKS and Azure ACR as enabled. Two new fields will pop up. Fill them with the name of the container registry and the AKS you created above. In the previous example, we created an ACR with the name hopsworksaks and an AKS cluster with the name hopsaks-cluster . Hence, the configuration should look similar to the picture below Hopsworks AKS configuration In the virtual network tab, you have to select either the virtual network you created for the peering setup or the Kubernetes virtual network depending on which approach you choose. Under the subnet tab, you have to choose the default subnet if you choose the peering approach or the subnet you created if you choose to create a new subnet inside the AKS virtual network.","title":"Create the Hopsworks cluster"},{"location":"setup_installation/azure/cluster_creation/","text":"Getting started with Hopsworks.ai (Azure) # This guide goes into detail for each of the steps of the cluster creation in Hopsworks.ai Step 1 starting to create a cluster # In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Step 2 setting the General information # Select the Resource Group (1) you want to use. Note If the Resource Group does not appear in the drop-down, make sure that you properly created and set the custom role for this resource group. Name your cluster (2). Your cluster will be deployed in the Location of your Resource Group (3). Select the Instance type (4) and Local storage (5) size for the cluster Head node . To provide the capacity of adding and removing workers on demand, the Hopsworks clusters deployed by Hopsworks.ai store their data in an Azure storage container. In this step, you select which storage account and container to use for this purpose. Select the storage account (6) you want to use in Azure Storage account name . The name of the container in which the data will be stored is displayed in Azure Container name (7). You can change this name. For more details on how to create and configure a storage in Azure refer to Creating and configuring a storage Note You can choose to use a container already existing in your storage account by using the name of this container, but you need to first make sure that this container is empty. General configuration On this page, you can also choose to opt out of hopsworks.ai log collection. Hopsworks.ai collects logs about the services running in your cluster to help us improve our system and to provide support. If you choose to opt-out from the log collection and need support you will have to provide us the log by yourself, which will slow down the support process. Step 3 workers configuration # In this step, you configure the workers. There are two possible setups static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: the documentation . In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand. Static workers configuration # You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes . Create a Hopsworks cluster, static workers configuration Autoscaling workers configuration # You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You then have access to a two parts form allowing you to configure the autoscaling. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Create a Hopsworks cluster, autoscale workers configuration Step 4 select a SSH key # When deploying clusters, Hopsworks.ai installs a ssh key on the cluster's instances so that you can access them if necessary. Select the SSH key that you want to use to access cluster instances. For more detail on how to add a shh key in Azure refer to Adding a ssh key to your resource group Choose SSH key Step 5 select the User assigned managed identity: # In order to let the cluster instances access to the Azure storage we need to attach a User assigned managed identity to the virtual machines. In this step you choose which identity to use. This identity need to have access right to the storage account you selected in Step 2 . For more information about how to create this identity and give it access to the storage account refer to Creating and configuring a storage : Choose the User assigned managed identity Step 6 set the backup retention policy: # Note This step is only accessible to enterprise users. To backup the Azure blob storage data when taking a cluster backups we need to set a retention policy for the blob storage. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the backup retention policy Step 7 Virtual network selection # In this step, you can select the virtual network which will be used by the Hopsworks cluster. You can either select an existing virtual network or let Hopsworks.ai create one for you. If you decide to let Hopsworks.ai create the virtual network for you, you can choose the CIDR block for this virtual network. Refer to Create a virtual network and subnet for more details on how to create your own virtual network in Azure. Choose virtual network Step 8 Subnet selection # If you selected an existing virtual network in the previous step, this step lets you select which subnet of this virtual network to use. For more information about creating your own subnet refer to Create a virtual network and subnet . If you did not select an existing virtual network in the previous step Hopsworks.ai will create the subnet for you. You can choose the CIDR block this subnet will use. Choose subnet Step 9 Network Security group selection # In this step, you can select the network security group you want to use to manage the inbound and outbound network rules. You can either let Hopsworks.ai create a network security group for you or select an existing security group. For more information about how to create your own network security group in Azure refer to Create a network security group . Note Hopsworks.ai require some rules for inbound and outbound traffic in your security group, for more details refer to inbound traffic rules and outbound traffic rules . Note Hopsworks.ai attaches a public ip to your cluster by default. However, you can disable this behavior by unchecking the Attach Public IP checkbox. Choose security group Limiting outbound traffic to Hopsworks.ai # Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai. If you have strict regulation regarding outbound traffic, you can enable the Use static IPs to communicate with Hopsworks.ai checkbox to get the list of IPs to be allowed as shown below: Enable static IPs Step 10 User management selection # In this step, you can choose which user management system to use. You have four choices: Managed : Hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization. OAuth2 : integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail. LDAP : integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail. Disabled : let you manage users manually from within Hopsworks. Choose user management type Step 12 Managed RonDB # Hopsworks.ai users have the option to create a cluster with dedicated VMs running RonDB . For details on how to configure RonDB check our guide here . Enable Managed RonDB If you need this feature and don't see this step please contact us . Step 13 add tags to your instances. # In this step, you can define tags that will be added to the cluster virtual machines. Add tags Step 14 add an init script to your instances. # In this step, you can enter an initialization script that will be run at startup on every instance. Note this init script must be a bash script starting with #!/usr/bin/env bash Add initialization script Step 15 Review and create # Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Cluster Creation"},{"location":"setup_installation/azure/cluster_creation/#getting-started-with-hopsworksai-azure","text":"This guide goes into detail for each of the steps of the cluster creation in Hopsworks.ai","title":"Getting started with Hopsworks.ai (Azure)"},{"location":"setup_installation/azure/cluster_creation/#step-1-starting-to-create-a-cluster","text":"In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster","title":"Step 1 starting to create a cluster"},{"location":"setup_installation/azure/cluster_creation/#step-2-setting-the-general-information","text":"Select the Resource Group (1) you want to use. Note If the Resource Group does not appear in the drop-down, make sure that you properly created and set the custom role for this resource group. Name your cluster (2). Your cluster will be deployed in the Location of your Resource Group (3). Select the Instance type (4) and Local storage (5) size for the cluster Head node . To provide the capacity of adding and removing workers on demand, the Hopsworks clusters deployed by Hopsworks.ai store their data in an Azure storage container. In this step, you select which storage account and container to use for this purpose. Select the storage account (6) you want to use in Azure Storage account name . The name of the container in which the data will be stored is displayed in Azure Container name (7). You can change this name. For more details on how to create and configure a storage in Azure refer to Creating and configuring a storage Note You can choose to use a container already existing in your storage account by using the name of this container, but you need to first make sure that this container is empty. General configuration On this page, you can also choose to opt out of hopsworks.ai log collection. Hopsworks.ai collects logs about the services running in your cluster to help us improve our system and to provide support. If you choose to opt-out from the log collection and need support you will have to provide us the log by yourself, which will slow down the support process.","title":"Step 2 setting the General information"},{"location":"setup_installation/azure/cluster_creation/#step-3-workers-configuration","text":"In this step, you configure the workers. There are two possible setups static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: the documentation . In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand.","title":"Step 3 workers configuration"},{"location":"setup_installation/azure/cluster_creation/#static-workers-configuration","text":"You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes . Create a Hopsworks cluster, static workers configuration","title":"Static workers configuration"},{"location":"setup_installation/azure/cluster_creation/#autoscaling-workers-configuration","text":"You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You then have access to a two parts form allowing you to configure the autoscaling. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Create a Hopsworks cluster, autoscale workers configuration","title":"Autoscaling workers configuration"},{"location":"setup_installation/azure/cluster_creation/#step-4-select-a-ssh-key","text":"When deploying clusters, Hopsworks.ai installs a ssh key on the cluster's instances so that you can access them if necessary. Select the SSH key that you want to use to access cluster instances. For more detail on how to add a shh key in Azure refer to Adding a ssh key to your resource group Choose SSH key","title":"Step 4 select a SSH key"},{"location":"setup_installation/azure/cluster_creation/#step-5-select-the-user-assigned-managed-identity","text":"In order to let the cluster instances access to the Azure storage we need to attach a User assigned managed identity to the virtual machines. In this step you choose which identity to use. This identity need to have access right to the storage account you selected in Step 2 . For more information about how to create this identity and give it access to the storage account refer to Creating and configuring a storage : Choose the User assigned managed identity","title":"Step 5 select the User assigned managed identity:"},{"location":"setup_installation/azure/cluster_creation/#step-6-set-the-backup-retention-policy","text":"Note This step is only accessible to enterprise users. To backup the Azure blob storage data when taking a cluster backups we need to set a retention policy for the blob storage. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the backup retention policy","title":"Step 6 set the backup retention policy:"},{"location":"setup_installation/azure/cluster_creation/#step-7-virtual-network-selection","text":"In this step, you can select the virtual network which will be used by the Hopsworks cluster. You can either select an existing virtual network or let Hopsworks.ai create one for you. If you decide to let Hopsworks.ai create the virtual network for you, you can choose the CIDR block for this virtual network. Refer to Create a virtual network and subnet for more details on how to create your own virtual network in Azure. Choose virtual network","title":"Step 7 Virtual network selection"},{"location":"setup_installation/azure/cluster_creation/#step-8-subnet-selection","text":"If you selected an existing virtual network in the previous step, this step lets you select which subnet of this virtual network to use. For more information about creating your own subnet refer to Create a virtual network and subnet . If you did not select an existing virtual network in the previous step Hopsworks.ai will create the subnet for you. You can choose the CIDR block this subnet will use. Choose subnet","title":"Step 8 Subnet selection"},{"location":"setup_installation/azure/cluster_creation/#step-9-network-security-group-selection","text":"In this step, you can select the network security group you want to use to manage the inbound and outbound network rules. You can either let Hopsworks.ai create a network security group for you or select an existing security group. For more information about how to create your own network security group in Azure refer to Create a network security group . Note Hopsworks.ai require some rules for inbound and outbound traffic in your security group, for more details refer to inbound traffic rules and outbound traffic rules . Note Hopsworks.ai attaches a public ip to your cluster by default. However, you can disable this behavior by unchecking the Attach Public IP checkbox. Choose security group","title":"Step 9 Network Security group selection"},{"location":"setup_installation/azure/cluster_creation/#limiting-outbound-traffic-to-hopsworksai","text":"Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai. If you have strict regulation regarding outbound traffic, you can enable the Use static IPs to communicate with Hopsworks.ai checkbox to get the list of IPs to be allowed as shown below: Enable static IPs","title":"Limiting outbound traffic to Hopsworks.ai"},{"location":"setup_installation/azure/cluster_creation/#step-10-user-management-selection","text":"In this step, you can choose which user management system to use. You have four choices: Managed : Hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization. OAuth2 : integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail. LDAP : integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail. Disabled : let you manage users manually from within Hopsworks. Choose user management type","title":"Step 10 User management selection"},{"location":"setup_installation/azure/cluster_creation/#step-12-managed-rondb","text":"Hopsworks.ai users have the option to create a cluster with dedicated VMs running RonDB . For details on how to configure RonDB check our guide here . Enable Managed RonDB If you need this feature and don't see this step please contact us .","title":"Step 12 Managed RonDB"},{"location":"setup_installation/azure/cluster_creation/#step-13-add-tags-to-your-instances","text":"In this step, you can define tags that will be added to the cluster virtual machines. Add tags","title":"Step 13 add tags to your instances."},{"location":"setup_installation/azure/cluster_creation/#step-14-add-an-init-script-to-your-instances","text":"In this step, you can enter an initialization script that will be run at startup on every instance. Note this init script must be a bash script starting with #!/usr/bin/env bash Add initialization script","title":"Step 14 add an init script to your instances."},{"location":"setup_installation/azure/cluster_creation/#step-15-review-and-create","text":"Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Step 15 Review and create"},{"location":"setup_installation/azure/getting_started/","text":"Getting started with Hopsworks.ai (Azure) # Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up Hopsworks.ai with your organization's Azure account. Step 1: Connecting your Azure account # Hopsworks.ai deploys Hopsworks clusters to your Azure account. To enable this, you have to create a service principal and a custom role for Hopsworks.ai granting access to either a subscription or resource group. Step 1.0: Prerequisite # For Hopsworks.ai to deploy a cluster the following resource providers need to be registered on your Azure subscription. You can verify that they are registered by going to your subscription in the Azure portal and click on Resource providers . If one of the resource providers is not registered select it and click on Register . Microso ft .Ne t work Microso ft .Compu te Microso ft .S t orage Microso ft .Ma na gedIde nt i t y Step 1.1: Creating a service principal for Hopsworks.ai # On Hopsworks.ai, go to Settings/Cloud Accounts and choose to Configure Azure: Cloud account settings Select Add subscription key : Add subscription keys The Azure account configuration will show you the required steps and permissions. Ensure that you have the Azure CLI installed Install the Azure CLI and are logged in Sign in with Azure CLI . Copy the Azure CLI command from the first step and open a terminal: Connect your Azure Account Paste the command into the terminal and execute it: Add service principal At this point, you might get the following error message. This means that your Azure user does not have sufficient permissions to add the service principal. In this case, please ask your Azure administrator to add it for you or give you the required permissions. Error az ad sp create --id d4abcc44-2c40-40bd-9bba-986df591c28f When using this permission, the backing application of the service principal being created must in the local tenant. Step 1.2: Creating a custom role for Hopsworks.ai # Proceed to the Azure Portal and open either a Subscription or Resource Group that you want to use for Hopsworks.ai. Click on Access control (IAM) Select Add and choose Add custom role . Note Granting access to a Subscription will grant access to all Resource Groups in that Subscription . If you are uncertain if that is what you want, then start with a Resource Group . Add custom role Name the role and proceed to Assignable scopes : Name custom role Ensure the scope is set to the Subscription or Resource Group you want to use. You can change it here if required. Proceed to the JSON tab: Review assignable scope Select Edit and replace the actions part of the JSON with the one from Hopsworks.ai Azure account configuration workflow: Hopsworks.ai permission list Note If the access rights provided by Hopsworks.ai Azure account configuration workflow are too permissive, you can go to Limiting Azure permissions for more details on how to limit the permissions. Press Save , proceed to Review + create and create the role: Update permission JSON Step 1.3: Assigning the custom role to Hopsworks.ai # Back in the Subscription or Resource Group , in Access control (IAM) , select Add and choose Add role assignment : Add role assignment Choose the custom role you just created, select User, group, or service principal to Assign access to and select the hopsworks.ai service principal. Press Save : Configure Hopsworks.ai as role assignment Go back to the Hopsworks.ai Azure account configuration workflow and proceed to the next step. Copy the CLI command shown: Configure subscription and tenant id Paste the CLI command into your terminal and execute it. Note that you might have multiple entries listed here. If so, ensure that you pick the subscription that you want to use. Show subscription and tenant id Copy the value of id and paste it into the Subscription id field on Hopsworks.ai. Go back to the terminal and copy the value of tenantId . Ensure to NOT use the tenantId under managedByTenants . Paste the value into the Tenant ID field on Hopsworks.ai and press Finish . Congratulations, you have successfully connected you Azure account to Hopsworks.ai. Store subscription and tenant id Step 2: Creating and configuring a storage # Note If you prefer using terraform, you can skip this step and the remaining steps, and instead follow this guide . The Hopsworks clusters deployed by hopsworks.ai store their data in a container in your Azure account. To enable this you need to perform the following operations Create a restrictive role to limit access to the storage account Create a User Assigned Managed Identity Create a storage account and give Hopsworks clusters access to the storage using the restrictive role Step 2.1: Creating a Restrictive Role for Accessing Storage # Similarly to Step 1.2 create a new role named Hopsworks Storage Role . Add the following permissions to the role \"permissions\" : [ { \"actions\" : [ \"Microsoft.Storage/storageAccounts/blobServices/containers/write\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/read\" , \"Microsoft.Storage/storageAccounts/blobServices/write\" , \"Microsoft.Storage/storageAccounts/blobServices/read\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ], \"notActions\" : [], \"dataActions\" : [ \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/delete\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/move/action\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write\" ], \"notDataActions\" : [] } ] Note Some of these permissions can be removed at the cost of Hopsworks features, see Limiting Azure permissions for more details. Step 2.2: Creating a User Assigned Managed Identity # Proceed to the Azure Portal and open the Resource Group that you want to use for Hopsworks.ai. Click on Add then Marketplace . Add to resource group Search for User Assigned Managed Identity and click on it. Search User Assigned Managed Identity Click on Create . Then, select the Location you want to use and name the identity. Click on Review + create . Finally click on Create . Create a User Assigned Managed Identity Step 2.3: Creating a Storage account # Proceed to the Azure Portal and open the Resource Group that you want to use for Hopsworks.ai. Click on Add then Marketplace . Add to resource group Search for Storage account and click on it. Search Storage Account Identity Click on Create , name your storage account, select the Location you want to use and click on Review + create . Finally click on Create . Create a Storage Account Step 2.4: Give the Managed Identity access to the storage # Proceed to the Storage Account you just created and click on Access Control (IAM) (1). Click on Add (2), then click on Add role assignment (3). In Role select Hopsworks Storage Role (4). In Assign access to select User assigned managed identity (5). Select the identity you created in step 2.1 (6). Click on Save (7). Add role assignment to storage Step 3: Adding a ssh key to your resource group # When deploying clusters, Hopsworks.ai installs a ssh key on the cluster's instances so that you can access them if necessary. For this purpose you need to add a ssh key to your resource group. Proceed to the Azure Portal and open the Resource Group that you want to use for Hopsworks.ai. Click on Add then Marketplace . Add to resource group Search for SSH Key and click on it. Click on Create. Then, name your key pair and choose between Generate a new key pair and Upload existing public key . Click on Review + create . Finally click on Create . Add to resource group Step 4: Deploying a Hopsworks cluster # In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Select the Resource Group (1) in which you created your storage account and user assigned managed identity (see above). Note If the Resource Group does not appear in the drop-down, make sure that you properly created and set the custom role for this resource group. Name your cluster (2). Your cluster will be deployed in the Location of your Resource Group (3). Select the Instance type (4) and Local storage (5) size for the cluster Head node . Select the storage account (6) you created above in Azure Storage account name . The name of the container in which the data will be stored is displayed in Azure Container name (7), you can modify it if needed. Note You can choose to use a container already existing in your storage account by using the name of this container, but you need to first make sure that this container is empty. Press Next : General configuration Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes . Note It is possible to add or remove workers or to enable autoscaling once the cluster is running. Press Next : Create a Hopsworks cluster, static workers configuration Select the SSH key that you want to use to access cluster instances: Choose SSH key Select the User assigned managed identity that you created above and click on Review and Create : Choose the User assigned managed identity Note If you are an enterprise user you will have one more step before being able to click on Review and Create . In this step, you will be asked to set the backups retention policy. More details about this step here Review all information and select Create : Review cluster information Note We skipped cluster creation steps that are not mandatory. You can find more details about these steps here The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart or terminate the cluster. Running Hopsworks cluster Step 5: Next steps # Check out our other guides for how to get started with Hopsworks and the Feature Store: Make Hopsworks services accessible from outside services Get started with the Hopsworks Feature Store Get started with Machine Learning on Hopsworks: HopsML Get started with Hopsworks: User Guide Code examples and notebooks: hops-examples","title":"Getting Started"},{"location":"setup_installation/azure/getting_started/#getting-started-with-hopsworksai-azure","text":"Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up Hopsworks.ai with your organization's Azure account.","title":"Getting started with Hopsworks.ai (Azure)"},{"location":"setup_installation/azure/getting_started/#step-1-connecting-your-azure-account","text":"Hopsworks.ai deploys Hopsworks clusters to your Azure account. To enable this, you have to create a service principal and a custom role for Hopsworks.ai granting access to either a subscription or resource group.","title":"Step 1: Connecting your Azure account"},{"location":"setup_installation/azure/getting_started/#step-10-prerequisite","text":"For Hopsworks.ai to deploy a cluster the following resource providers need to be registered on your Azure subscription. You can verify that they are registered by going to your subscription in the Azure portal and click on Resource providers . If one of the resource providers is not registered select it and click on Register . Microso ft .Ne t work Microso ft .Compu te Microso ft .S t orage Microso ft .Ma na gedIde nt i t y","title":"Step 1.0: Prerequisite"},{"location":"setup_installation/azure/getting_started/#step-11-creating-a-service-principal-for-hopsworksai","text":"On Hopsworks.ai, go to Settings/Cloud Accounts and choose to Configure Azure: Cloud account settings Select Add subscription key : Add subscription keys The Azure account configuration will show you the required steps and permissions. Ensure that you have the Azure CLI installed Install the Azure CLI and are logged in Sign in with Azure CLI . Copy the Azure CLI command from the first step and open a terminal: Connect your Azure Account Paste the command into the terminal and execute it: Add service principal At this point, you might get the following error message. This means that your Azure user does not have sufficient permissions to add the service principal. In this case, please ask your Azure administrator to add it for you or give you the required permissions. Error az ad sp create --id d4abcc44-2c40-40bd-9bba-986df591c28f When using this permission, the backing application of the service principal being created must in the local tenant.","title":"Step 1.1: Creating a service principal for Hopsworks.ai"},{"location":"setup_installation/azure/getting_started/#step-12-creating-a-custom-role-for-hopsworksai","text":"Proceed to the Azure Portal and open either a Subscription or Resource Group that you want to use for Hopsworks.ai. Click on Access control (IAM) Select Add and choose Add custom role . Note Granting access to a Subscription will grant access to all Resource Groups in that Subscription . If you are uncertain if that is what you want, then start with a Resource Group . Add custom role Name the role and proceed to Assignable scopes : Name custom role Ensure the scope is set to the Subscription or Resource Group you want to use. You can change it here if required. Proceed to the JSON tab: Review assignable scope Select Edit and replace the actions part of the JSON with the one from Hopsworks.ai Azure account configuration workflow: Hopsworks.ai permission list Note If the access rights provided by Hopsworks.ai Azure account configuration workflow are too permissive, you can go to Limiting Azure permissions for more details on how to limit the permissions. Press Save , proceed to Review + create and create the role: Update permission JSON","title":"Step 1.2: Creating a custom role for Hopsworks.ai"},{"location":"setup_installation/azure/getting_started/#step-13-assigning-the-custom-role-to-hopsworksai","text":"Back in the Subscription or Resource Group , in Access control (IAM) , select Add and choose Add role assignment : Add role assignment Choose the custom role you just created, select User, group, or service principal to Assign access to and select the hopsworks.ai service principal. Press Save : Configure Hopsworks.ai as role assignment Go back to the Hopsworks.ai Azure account configuration workflow and proceed to the next step. Copy the CLI command shown: Configure subscription and tenant id Paste the CLI command into your terminal and execute it. Note that you might have multiple entries listed here. If so, ensure that you pick the subscription that you want to use. Show subscription and tenant id Copy the value of id and paste it into the Subscription id field on Hopsworks.ai. Go back to the terminal and copy the value of tenantId . Ensure to NOT use the tenantId under managedByTenants . Paste the value into the Tenant ID field on Hopsworks.ai and press Finish . Congratulations, you have successfully connected you Azure account to Hopsworks.ai. Store subscription and tenant id","title":"Step 1.3: Assigning the custom role to Hopsworks.ai"},{"location":"setup_installation/azure/getting_started/#step-2-creating-and-configuring-a-storage","text":"Note If you prefer using terraform, you can skip this step and the remaining steps, and instead follow this guide . The Hopsworks clusters deployed by hopsworks.ai store their data in a container in your Azure account. To enable this you need to perform the following operations Create a restrictive role to limit access to the storage account Create a User Assigned Managed Identity Create a storage account and give Hopsworks clusters access to the storage using the restrictive role","title":"Step 2: Creating and configuring a storage"},{"location":"setup_installation/azure/getting_started/#step-21-creating-a-restrictive-role-for-accessing-storage","text":"Similarly to Step 1.2 create a new role named Hopsworks Storage Role . Add the following permissions to the role \"permissions\" : [ { \"actions\" : [ \"Microsoft.Storage/storageAccounts/blobServices/containers/write\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/read\" , \"Microsoft.Storage/storageAccounts/blobServices/write\" , \"Microsoft.Storage/storageAccounts/blobServices/read\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ], \"notActions\" : [], \"dataActions\" : [ \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/delete\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/move/action\" , \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write\" ], \"notDataActions\" : [] } ] Note Some of these permissions can be removed at the cost of Hopsworks features, see Limiting Azure permissions for more details.","title":"Step 2.1: Creating a Restrictive Role for Accessing Storage"},{"location":"setup_installation/azure/getting_started/#step-22-creating-a-user-assigned-managed-identity","text":"Proceed to the Azure Portal and open the Resource Group that you want to use for Hopsworks.ai. Click on Add then Marketplace . Add to resource group Search for User Assigned Managed Identity and click on it. Search User Assigned Managed Identity Click on Create . Then, select the Location you want to use and name the identity. Click on Review + create . Finally click on Create . Create a User Assigned Managed Identity","title":"Step 2.2: Creating a User Assigned Managed Identity"},{"location":"setup_installation/azure/getting_started/#step-23-creating-a-storage-account","text":"Proceed to the Azure Portal and open the Resource Group that you want to use for Hopsworks.ai. Click on Add then Marketplace . Add to resource group Search for Storage account and click on it. Search Storage Account Identity Click on Create , name your storage account, select the Location you want to use and click on Review + create . Finally click on Create . Create a Storage Account","title":"Step 2.3: Creating a Storage account"},{"location":"setup_installation/azure/getting_started/#step-24-give-the-managed-identity-access-to-the-storage","text":"Proceed to the Storage Account you just created and click on Access Control (IAM) (1). Click on Add (2), then click on Add role assignment (3). In Role select Hopsworks Storage Role (4). In Assign access to select User assigned managed identity (5). Select the identity you created in step 2.1 (6). Click on Save (7). Add role assignment to storage","title":"Step 2.4: Give the Managed Identity access to the storage"},{"location":"setup_installation/azure/getting_started/#step-3-adding-a-ssh-key-to-your-resource-group","text":"When deploying clusters, Hopsworks.ai installs a ssh key on the cluster's instances so that you can access them if necessary. For this purpose you need to add a ssh key to your resource group. Proceed to the Azure Portal and open the Resource Group that you want to use for Hopsworks.ai. Click on Add then Marketplace . Add to resource group Search for SSH Key and click on it. Click on Create. Then, name your key pair and choose between Generate a new key pair and Upload existing public key . Click on Review + create . Finally click on Create . Add to resource group","title":"Step 3: Adding a ssh key to your resource group"},{"location":"setup_installation/azure/getting_started/#step-4-deploying-a-hopsworks-cluster","text":"In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Select the Resource Group (1) in which you created your storage account and user assigned managed identity (see above). Note If the Resource Group does not appear in the drop-down, make sure that you properly created and set the custom role for this resource group. Name your cluster (2). Your cluster will be deployed in the Location of your Resource Group (3). Select the Instance type (4) and Local storage (5) size for the cluster Head node . Select the storage account (6) you created above in Azure Storage account name . The name of the container in which the data will be stored is displayed in Azure Container name (7), you can modify it if needed. Note You can choose to use a container already existing in your storage account by using the name of this container, but you need to first make sure that this container is empty. Press Next : General configuration Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes . Note It is possible to add or remove workers or to enable autoscaling once the cluster is running. Press Next : Create a Hopsworks cluster, static workers configuration Select the SSH key that you want to use to access cluster instances: Choose SSH key Select the User assigned managed identity that you created above and click on Review and Create : Choose the User assigned managed identity Note If you are an enterprise user you will have one more step before being able to click on Review and Create . In this step, you will be asked to set the backups retention policy. More details about this step here Review all information and select Create : Review cluster information Note We skipped cluster creation steps that are not mandatory. You can find more details about these steps here The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart or terminate the cluster. Running Hopsworks cluster","title":"Step 4: Deploying a Hopsworks cluster"},{"location":"setup_installation/azure/getting_started/#step-5-next-steps","text":"Check out our other guides for how to get started with Hopsworks and the Feature Store: Make Hopsworks services accessible from outside services Get started with the Hopsworks Feature Store Get started with Machine Learning on Hopsworks: HopsML Get started with Hopsworks: User Guide Code examples and notebooks: hops-examples","title":"Step 5: Next steps"},{"location":"setup_installation/azure/restrictive_permissions/","text":"Limiting Azure permissions # Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s Azure resource group. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down access permissions following the IT security policy principle of least privilege. Limiting the cross-account role permissions # Step 1: Create a virtual network and subnet # To restrict Hopsworks.ai from having write and delete access on virtual networks and subnet you need to create them manually. This can be achieved in the Azure portal following this guide: Create a virtual network . Make sure to use the resource group and location in which you intend to deploy your Hopsworks cluster. For the remaining of the configuration, the default options proposed by the portal should work out of the box. Note the names of the virtual network and subnet you want to use for the following steps. Step 2: Create a network security group # To restrict Hopsworks.ai from having write and delete access on network security groups you need to create it manually. This can be achieved in the Azure portal following this guide: Create a network security group . Make sure to use the resource group and location in which you intend to deploy your Hopsworks cluster. Inbound traffic # For Hopsworks.ai to create the SSL certificates the network security group needs to allow inbound traffic on port 80. For this, you need to add an inbound security rule to your network security group. This can be achieved in the Azure portal following this guide: Create a security rule . Setting the destination port ranges to 80 and letting the default values for the other fields should work out of the box. Note If you intend to use the managed users option on your Hopsworks cluster you should also add a rule to open port 443. Outbound traffic # Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai . The api.hopsworks.ai domain use a content delivery network for better performance. This result in the impossibility to predict which IP the request will be sent to. If you require a list of static IPs to allow outbound traffic from your security group, use the static IPs option during cluster creation . Note If you intend to use the managed users option on your Hopsworks cluster you should also allow outbound traffic to cognito-idp.us-east-2.amazonaws.com and managedhopsworks-prod.auth.us-east-2.amazoncognito.com . Step 3: Set permissions of the cross-account role # During the account setup for Hopsworks.ai, you were asked to create create a custom role for your resource group. Edit this role in the Azure portal by going to your resource group, clicking on Access control (IAM) , opening the tab Roles , searching for the role you created, clicking on the three dots at the end of the role line and clicking on edit. You can then navigate to the JSON tab and overwrite the \"action\" field with the following: \"actions\" : [ \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/virtualMachines/start/action\" , \"Microsoft.Compute/virtualMachines/powerOff/action\" , \"Microsoft.Compute/virtualMachines/restart/action\" , \"Microsoft.Compute/virtualMachines/delete\" , \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/deallocate/action\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Compute/disks/delete\" , \"Microsoft.Network/networkInterfaces/read\" , \"Microsoft.Network/networkInterfaces/join/action\" , \"Microsoft.Network/networkInterfaces/write\" , \"Microsoft.Network/networkInterfaces/delete\" , \"Microsoft.Network/networkSecurityGroups/read\" , \"Microsoft.Network/networkSecurityGroups/join/action\" , \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/write\" , \"Microsoft.Network/networkSecurityGroups/securityRules/delete\" , \"Microsoft.Network/publicIPAddresses/join/action\" , \"Microsoft.Network/publicIPAddresses/read\" , \"Microsoft.Network/publicIPAddresses/write\" , \"Microsoft.Network/publicIPAddresses/delete\" , \"Microsoft.Network/virtualNetworks/read\" , \"Microsoft.Network/virtualNetworks/subnets/read\" , \"Microsoft.Network/virtualNetworks/subnets/join/action\" , \"Microsoft.Resources/subscriptions/resourceGroups/read\" , \"Microsoft.Compute/sshPublicKeys/read\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/read\" , \"Microsoft.Storage/storageAccounts/read\" , \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , \"Microsoft.Compute/disks/read\" ] Step 4: Create your Hopsworks instance # You can now create a new Hopsworks instance in Hopsworks.ai by selecting the virtual network, subnet, and network security group during the instance configuration. Backup permissions # The following permissions are only needed for the backup feature: \"actions\" : [ \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , ] If you are not going to create backups or if you do not have access to this Enterprise feature, you can further limit the permission of the cross-account role to the following: \"actions\" : [ \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/virtualMachines/start/action\" , \"Microsoft.Compute/virtualMachines/powerOff/action\" , \"Microsoft.Compute/virtualMachines/restart/action\" , \"Microsoft.Compute/virtualMachines/delete\" , \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/deallocate/action\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Compute/disks/delete\" , \"Microsoft.Network/networkInterfaces/read\" , \"Microsoft.Network/networkInterfaces/join/action\" , \"Microsoft.Network/networkInterfaces/write\" , \"Microsoft.Network/networkInterfaces/delete\" , \"Microsoft.Network/networkSecurityGroups/read\" , \"Microsoft.Network/networkSecurityGroups/join/action\" , \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/write\" , \"Microsoft.Network/networkSecurityGroups/securityRules/delete\" , \"Microsoft.Network/publicIPAddresses/join/action\" , \"Microsoft.Network/publicIPAddresses/read\" , \"Microsoft.Network/publicIPAddresses/write\" , \"Microsoft.Network/publicIPAddresses/delete\" , \"Microsoft.Network/virtualNetworks/read\" , \"Microsoft.Network/virtualNetworks/subnets/read\" , \"Microsoft.Network/virtualNetworks/subnets/join/action\" , \"Microsoft.Resources/subscriptions/resourceGroups/read\" , \"Microsoft.Compute/sshPublicKeys/read\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/read\" , \"Microsoft.Storage/storageAccounts/read\" , ] Public IP Addresses permissions # The following permissions are used to create and attach a public IP Address to the head node. If you do not want to use a public IP Address for the head node, you can remove them: \"actions\" : [ \"Microsoft.Network/publicIPAddresses/join/action\" , \"Microsoft.Network/publicIPAddresses/read\" , \"Microsoft.Network/publicIPAddresses/write\" , \"Microsoft.Network/publicIPAddresses/delete\" , ] You then have to make sure that you uncheck the Attach Public IP check box in the Security Group section of the cluster creation: Attach Public IP Other removable permissions # The following permissions are used to let you close and open ports on your cluster from hopswork.ai, you can remove them if you do not want to open ports on your cluster or if you want to manually open ports in Azure. \"actions\" : [ \"Microsoft.Network/networkSecurityGroups/securityRules/write\" , \"Microsoft.Network/networkSecurityGroups/securityRules/delete\" , ] The following permission is only needed to select the Azure Storage account through a drop-down during cluster creation. You can remove it from the cross-account role and enter the value manually \"actions\" : [ \"Microsoft.Storage/storageAccounts/read\" , ] Limiting the User Assigned Managed Identity permissions # Backups # If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring your managed identity storage permissions. For this remove the following actions from your user assigned managed identity : \"actions\" : [ \"Microsoft.Storage/storageAccounts/blobServices/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Upgrades # If you do not intend to upgrade your cluster to newer versions of Hopsworks, then you can remove the permissions required for upgrade from the custom role that you have created here . For this remove the following actions from your custom role: \"actions\" : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ]","title":"Limiting Permissions"},{"location":"setup_installation/azure/restrictive_permissions/#limiting-azure-permissions","text":"Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s Azure resource group. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down access permissions following the IT security policy principle of least privilege.","title":"Limiting Azure permissions"},{"location":"setup_installation/azure/restrictive_permissions/#limiting-the-cross-account-role-permissions","text":"","title":"Limiting the cross-account role permissions"},{"location":"setup_installation/azure/restrictive_permissions/#step-1-create-a-virtual-network-and-subnet","text":"To restrict Hopsworks.ai from having write and delete access on virtual networks and subnet you need to create them manually. This can be achieved in the Azure portal following this guide: Create a virtual network . Make sure to use the resource group and location in which you intend to deploy your Hopsworks cluster. For the remaining of the configuration, the default options proposed by the portal should work out of the box. Note the names of the virtual network and subnet you want to use for the following steps.","title":"Step 1: Create a virtual network and subnet"},{"location":"setup_installation/azure/restrictive_permissions/#step-2-create-a-network-security-group","text":"To restrict Hopsworks.ai from having write and delete access on network security groups you need to create it manually. This can be achieved in the Azure portal following this guide: Create a network security group . Make sure to use the resource group and location in which you intend to deploy your Hopsworks cluster.","title":"Step 2: Create a network security group"},{"location":"setup_installation/azure/restrictive_permissions/#inbound-traffic","text":"For Hopsworks.ai to create the SSL certificates the network security group needs to allow inbound traffic on port 80. For this, you need to add an inbound security rule to your network security group. This can be achieved in the Azure portal following this guide: Create a security rule . Setting the destination port ranges to 80 and letting the default values for the other fields should work out of the box. Note If you intend to use the managed users option on your Hopsworks cluster you should also add a rule to open port 443.","title":"Inbound traffic"},{"location":"setup_installation/azure/restrictive_permissions/#outbound-traffic","text":"Clusters created on Hopsworks.ai need to be able to send http requests to api.hopsworks.ai . The api.hopsworks.ai domain use a content delivery network for better performance. This result in the impossibility to predict which IP the request will be sent to. If you require a list of static IPs to allow outbound traffic from your security group, use the static IPs option during cluster creation . Note If you intend to use the managed users option on your Hopsworks cluster you should also allow outbound traffic to cognito-idp.us-east-2.amazonaws.com and managedhopsworks-prod.auth.us-east-2.amazoncognito.com .","title":"Outbound traffic"},{"location":"setup_installation/azure/restrictive_permissions/#step-3-set-permissions-of-the-cross-account-role","text":"During the account setup for Hopsworks.ai, you were asked to create create a custom role for your resource group. Edit this role in the Azure portal by going to your resource group, clicking on Access control (IAM) , opening the tab Roles , searching for the role you created, clicking on the three dots at the end of the role line and clicking on edit. You can then navigate to the JSON tab and overwrite the \"action\" field with the following: \"actions\" : [ \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/virtualMachines/start/action\" , \"Microsoft.Compute/virtualMachines/powerOff/action\" , \"Microsoft.Compute/virtualMachines/restart/action\" , \"Microsoft.Compute/virtualMachines/delete\" , \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/deallocate/action\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Compute/disks/delete\" , \"Microsoft.Network/networkInterfaces/read\" , \"Microsoft.Network/networkInterfaces/join/action\" , \"Microsoft.Network/networkInterfaces/write\" , \"Microsoft.Network/networkInterfaces/delete\" , \"Microsoft.Network/networkSecurityGroups/read\" , \"Microsoft.Network/networkSecurityGroups/join/action\" , \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/write\" , \"Microsoft.Network/networkSecurityGroups/securityRules/delete\" , \"Microsoft.Network/publicIPAddresses/join/action\" , \"Microsoft.Network/publicIPAddresses/read\" , \"Microsoft.Network/publicIPAddresses/write\" , \"Microsoft.Network/publicIPAddresses/delete\" , \"Microsoft.Network/virtualNetworks/read\" , \"Microsoft.Network/virtualNetworks/subnets/read\" , \"Microsoft.Network/virtualNetworks/subnets/join/action\" , \"Microsoft.Resources/subscriptions/resourceGroups/read\" , \"Microsoft.Compute/sshPublicKeys/read\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/read\" , \"Microsoft.Storage/storageAccounts/read\" , \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , \"Microsoft.Compute/disks/read\" ]","title":"Step 3: Set permissions of the cross-account role"},{"location":"setup_installation/azure/restrictive_permissions/#step-4-create-your-hopsworks-instance","text":"You can now create a new Hopsworks instance in Hopsworks.ai by selecting the virtual network, subnet, and network security group during the instance configuration.","title":"Step 4: Create your Hopsworks instance"},{"location":"setup_installation/azure/restrictive_permissions/#backup-permissions","text":"The following permissions are only needed for the backup feature: \"actions\" : [ \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , ] If you are not going to create backups or if you do not have access to this Enterprise feature, you can further limit the permission of the cross-account role to the following: \"actions\" : [ \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/virtualMachines/start/action\" , \"Microsoft.Compute/virtualMachines/powerOff/action\" , \"Microsoft.Compute/virtualMachines/restart/action\" , \"Microsoft.Compute/virtualMachines/delete\" , \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/deallocate/action\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Compute/disks/delete\" , \"Microsoft.Network/networkInterfaces/read\" , \"Microsoft.Network/networkInterfaces/join/action\" , \"Microsoft.Network/networkInterfaces/write\" , \"Microsoft.Network/networkInterfaces/delete\" , \"Microsoft.Network/networkSecurityGroups/read\" , \"Microsoft.Network/networkSecurityGroups/join/action\" , \"Microsoft.Network/networkSecurityGroups/defaultSecurityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/read\" , \"Microsoft.Network/networkSecurityGroups/securityRules/write\" , \"Microsoft.Network/networkSecurityGroups/securityRules/delete\" , \"Microsoft.Network/publicIPAddresses/join/action\" , \"Microsoft.Network/publicIPAddresses/read\" , \"Microsoft.Network/publicIPAddresses/write\" , \"Microsoft.Network/publicIPAddresses/delete\" , \"Microsoft.Network/virtualNetworks/read\" , \"Microsoft.Network/virtualNetworks/subnets/read\" , \"Microsoft.Network/virtualNetworks/subnets/join/action\" , \"Microsoft.Resources/subscriptions/resourceGroups/read\" , \"Microsoft.Compute/sshPublicKeys/read\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\" , \"Microsoft.ManagedIdentity/userAssignedIdentities/read\" , \"Microsoft.Storage/storageAccounts/read\" , ]","title":"Backup permissions"},{"location":"setup_installation/azure/restrictive_permissions/#public-ip-addresses-permissions","text":"The following permissions are used to create and attach a public IP Address to the head node. If you do not want to use a public IP Address for the head node, you can remove them: \"actions\" : [ \"Microsoft.Network/publicIPAddresses/join/action\" , \"Microsoft.Network/publicIPAddresses/read\" , \"Microsoft.Network/publicIPAddresses/write\" , \"Microsoft.Network/publicIPAddresses/delete\" , ] You then have to make sure that you uncheck the Attach Public IP check box in the Security Group section of the cluster creation: Attach Public IP","title":"Public IP Addresses permissions"},{"location":"setup_installation/azure/restrictive_permissions/#other-removable-permissions","text":"The following permissions are used to let you close and open ports on your cluster from hopswork.ai, you can remove them if you do not want to open ports on your cluster or if you want to manually open ports in Azure. \"actions\" : [ \"Microsoft.Network/networkSecurityGroups/securityRules/write\" , \"Microsoft.Network/networkSecurityGroups/securityRules/delete\" , ] The following permission is only needed to select the Azure Storage account through a drop-down during cluster creation. You can remove it from the cross-account role and enter the value manually \"actions\" : [ \"Microsoft.Storage/storageAccounts/read\" , ]","title":"Other removable permissions"},{"location":"setup_installation/azure/restrictive_permissions/#limiting-the-user-assigned-managed-identity-permissions","text":"","title":"Limiting the User Assigned Managed Identity permissions"},{"location":"setup_installation/azure/restrictive_permissions/#backups","text":"If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring your managed identity storage permissions. For this remove the following actions from your user assigned managed identity : \"actions\" : [ \"Microsoft.Storage/storageAccounts/blobServices/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ]","title":"Backups"},{"location":"setup_installation/azure/restrictive_permissions/#upgrades","text":"If you do not intend to upgrade your cluster to newer versions of Hopsworks, then you can remove the permissions required for upgrade from the custom role that you have created here . For this remove the following actions from your custom role: \"actions\" : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ]","title":"Upgrades"},{"location":"setup_installation/azure/upgrade/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (Azure) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available Step 2: Add upgrade permissions to your user assigned managed identity # Note You can skip this step if you already have the following permissions in your user assigned managed identity : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Make sure that the scope of these permissions is your resource group. We require extra permissions to be added to the user assigned managed identity attached to your cluster to proceed with the upgrade. First to get the name of your user assigned managed identity and the resource group of your cluster, click on the Details tab as shown below: Get the resource group name (1) and the user assigned managed identity (2) of your cluster Step 2.1: Add custom role for upgrade permissions # Once you get the names of the resource group and user-assigned managed identity, follow the same steps as in getting started to add a custom role . First, navigate to Azure portal , then click on Resource groups and then search for your resource group and click on it. Go to the Access control (IAM) tab, select Add , and click on Add custom role Add a custom role for upgrade Name the custom role and then click on next till you reach the JSON tab. Name the custom role for upgrade Once you reach the JSON tab, click on Edit to edit the role permissions: Edit the JSON permissions for the custom role for upgrade Once you have clicked on Edit , replace the permissions array with the following snippet: \"permissions\" : [ { \"actions\" : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ], \"notActions\" : [], \"dataActions\" : [], \"notDataActions\" : [] } ] Then, click on Save to save the updated permissions Save permissions for the custom role for upgrade Click on Review and create and then click on Create to create the custom role: Save permissions for the custom role for upgrade Step 2.2: Assign the custom role to your user-assigned managed identity # Navigate back to the your Resource group home page at Azure portal , click on Add and then click on Add role assignment Assign upgrade role to your user assigned managed identity (1) choose the upgrade role that you have just created in Step 2.1 , (2) choose User Assigned Managed Identity , (3) search for the user assigned managed identity attached to your cluster and select it. Finally, (4) click on Save to save the role assignment. Assign upgrade role to your user assigned managed identity Warning When you assign roles or remove role assignments, it can take up to 30 minutes for changes to take effect. Step 3: Add disk read permissions to your role connected to Hopsworks.ai # We require extra permission (\"Microsoft.Compute/disks/read\") to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai Now, add the missing permission \"Microsoft.Compute/disks/read\" to the list of actions, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai Step 4: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your user assigned managed identity (hopsworks-doc-identity) includes the following permissions: [ \"Microsoft.Compute/virtualMachines/read\", \"Microsoft.Compute/virtualMachines/write\", \"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\", \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Missing permissions error # If you encounter the following permission error right after starting an upgrade, then you need to make sure that the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 , have permissions to read and write disks (\"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\") . Missing permission error If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai In our example, we were missing only the read permission (\"Microsoft.Compute/disks/read\"). First, add the missing permission, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai Once you have updated your role, click on Retry to retry the upgrade process. Retry the upgrade process Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (Azure)"},{"location":"setup_installation/azure/upgrade/#upgrade-existing-clusters-on-hopsworksai-from-version-22-or-older-azure","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (Azure)"},{"location":"setup_installation/azure/upgrade/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/azure/upgrade/#step-2-add-upgrade-permissions-to-your-user-assigned-managed-identity","text":"Note You can skip this step if you already have the following permissions in your user assigned managed identity : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Make sure that the scope of these permissions is your resource group. We require extra permissions to be added to the user assigned managed identity attached to your cluster to proceed with the upgrade. First to get the name of your user assigned managed identity and the resource group of your cluster, click on the Details tab as shown below: Get the resource group name (1) and the user assigned managed identity (2) of your cluster","title":"Step 2: Add upgrade permissions to your user assigned managed identity"},{"location":"setup_installation/azure/upgrade/#step-21-add-custom-role-for-upgrade-permissions","text":"Once you get the names of the resource group and user-assigned managed identity, follow the same steps as in getting started to add a custom role . First, navigate to Azure portal , then click on Resource groups and then search for your resource group and click on it. Go to the Access control (IAM) tab, select Add , and click on Add custom role Add a custom role for upgrade Name the custom role and then click on next till you reach the JSON tab. Name the custom role for upgrade Once you reach the JSON tab, click on Edit to edit the role permissions: Edit the JSON permissions for the custom role for upgrade Once you have clicked on Edit , replace the permissions array with the following snippet: \"permissions\" : [ { \"actions\" : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ], \"notActions\" : [], \"dataActions\" : [], \"notDataActions\" : [] } ] Then, click on Save to save the updated permissions Save permissions for the custom role for upgrade Click on Review and create and then click on Create to create the custom role: Save permissions for the custom role for upgrade","title":"Step 2.1: Add custom role for upgrade permissions"},{"location":"setup_installation/azure/upgrade/#step-22-assign-the-custom-role-to-your-user-assigned-managed-identity","text":"Navigate back to the your Resource group home page at Azure portal , click on Add and then click on Add role assignment Assign upgrade role to your user assigned managed identity (1) choose the upgrade role that you have just created in Step 2.1 , (2) choose User Assigned Managed Identity , (3) search for the user assigned managed identity attached to your cluster and select it. Finally, (4) click on Save to save the role assignment. Assign upgrade role to your user assigned managed identity Warning When you assign roles or remove role assignments, it can take up to 30 minutes for changes to take effect.","title":"Step 2.2: Assign the custom role to your user-assigned managed identity"},{"location":"setup_installation/azure/upgrade/#step-3-add-disk-read-permissions-to-your-role-connected-to-hopsworksai","text":"We require extra permission (\"Microsoft.Compute/disks/read\") to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai Now, add the missing permission \"Microsoft.Compute/disks/read\" to the list of actions, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai","title":"Step 3: Add disk read permissions to your role connected to Hopsworks.ai"},{"location":"setup_installation/azure/upgrade/#step-4-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your user assigned managed identity (hopsworks-doc-identity) includes the following permissions: [ \"Microsoft.Compute/virtualMachines/read\", \"Microsoft.Compute/virtualMachines/write\", \"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\", \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete","title":"Step 4: Run the upgrade process"},{"location":"setup_installation/azure/upgrade/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/azure/upgrade/#error-1-missing-permissions-error","text":"If you encounter the following permission error right after starting an upgrade, then you need to make sure that the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 , have permissions to read and write disks (\"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\") . Missing permission error If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai In our example, we were missing only the read permission (\"Microsoft.Compute/disks/read\"). First, add the missing permission, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai Once you have updated your role, click on Retry to retry the upgrade process. Retry the upgrade process","title":"Error 1: Missing permissions error"},{"location":"setup_installation/azure/upgrade/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/azure/upgrade_2.4/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (Azure) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available Step 2: Add backup permissions to your role connected to Hopsworks.ai # We require extra permission to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. \"actions\" : [ \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , ] If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopsworks.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopsworks.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopsworks.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopsworks.ai Now, add the following permissions to the list of actions, then click on Save , click on Review + update , and finally click on Update . \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , Add missing permissions to your role connected to hopsworks.ai Step 3: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your custom role which you have connected to Hopsworks.ai has the following permissions: [ \"Microsoft.Compute/snapshots/write\", \"Microsoft.Compute/snapshots/read\", \"Microsoft.Compute/snapshots/delete\", \"Microsoft.Compute/disks/beginGetAccess/action\", ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version number on the Details tab of your cluster. Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Missing permissions error # If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Missing permission error Update your cross custom role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again. Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (Azure)"},{"location":"setup_installation/azure/upgrade_2.4/#upgrade-existing-clusters-on-hopsworksai-from-version-24-or-newer-azure","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (Azure)"},{"location":"setup_installation/azure/upgrade_2.4/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/azure/upgrade_2.4/#step-2-add-backup-permissions-to-your-role-connected-to-hopsworksai","text":"We require extra permission to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. \"actions\" : [ \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , ] If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopsworks.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopsworks.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopsworks.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopsworks.ai Now, add the following permissions to the list of actions, then click on Save , click on Review + update , and finally click on Update . \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , Add missing permissions to your role connected to hopsworks.ai","title":"Step 2: Add backup permissions to your role connected to Hopsworks.ai"},{"location":"setup_installation/azure/upgrade_2.4/#step-3-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your custom role which you have connected to Hopsworks.ai has the following permissions: [ \"Microsoft.Compute/snapshots/write\", \"Microsoft.Compute/snapshots/read\", \"Microsoft.Compute/snapshots/delete\", \"Microsoft.Compute/disks/beginGetAccess/action\", ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version number on the Details tab of your cluster.","title":"Step 3: Run the upgrade process"},{"location":"setup_installation/azure/upgrade_2.4/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/azure/upgrade_2.4/#error-1-missing-permissions-error","text":"If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Missing permission error Update your cross custom role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again.","title":"Error 1: Missing permissions error"},{"location":"setup_installation/azure/upgrade_2.4/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/common/","text":"Hopsworks.ai # Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker, and KubeFlow. Getting started # To get started with deploying a cluster in you Azure or AWS environment, follow these guides: Azure , AWS . If you need more details about hopsworks.ai cluster creation steps you can check the following guides: Azure , AWS . Limiting permissions # Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s cloud account. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. The following guides explain how you can reduce the permissions you give to hopsworks.ai by doing some of the cluster creation steps manually: Azure , AWS . Integration with managed Kubernetes # When deploying a cluster you can set it up to use managed Kubernetes to run python jobs, Jupyter servers, and ML model serving in a scalable way. This guide provides step-by-step instructions on how to set up Kubernetes and start a cluster using it: AWS . Integration with third-party platforms # Once you have deployed a cluster with hopsworks.ai you can connect to it from third-party platforms such as Databricks , AWS Sagemaker , Azure HDInsight , etc. Go to integrations for more third-party platforms and details. Other # You can find more information on the following topics by clicking on the links: GPU support Ading and removing workers User management","title":"Hopsworks.ai"},{"location":"setup_installation/common/#hopsworksai","text":"Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker, and KubeFlow.","title":"Hopsworks.ai"},{"location":"setup_installation/common/#getting-started","text":"To get started with deploying a cluster in you Azure or AWS environment, follow these guides: Azure , AWS . If you need more details about hopsworks.ai cluster creation steps you can check the following guides: Azure , AWS .","title":"Getting started"},{"location":"setup_installation/common/#limiting-permissions","text":"Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s cloud account. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. The following guides explain how you can reduce the permissions you give to hopsworks.ai by doing some of the cluster creation steps manually: Azure , AWS .","title":"Limiting permissions"},{"location":"setup_installation/common/#integration-with-managed-kubernetes","text":"When deploying a cluster you can set it up to use managed Kubernetes to run python jobs, Jupyter servers, and ML model serving in a scalable way. This guide provides step-by-step instructions on how to set up Kubernetes and start a cluster using it: AWS .","title":"Integration with managed Kubernetes"},{"location":"setup_installation/common/#integration-with-third-party-platforms","text":"Once you have deployed a cluster with hopsworks.ai you can connect to it from third-party platforms such as Databricks , AWS Sagemaker , Azure HDInsight , etc. Go to integrations for more third-party platforms and details.","title":"Integration with third-party platforms"},{"location":"setup_installation/common/#other","text":"You can find more information on the following topics by clicking on the links: GPU support Ading and removing workers User management","title":"Other"},{"location":"setup_installation/common/adding_removing_workers/","text":"Adding and removing workers # Once you have started a hopsworks cluster you can add and remove workers from the cluster to accommodate your workload. Adding workers # If the computation you are running is using all the resources of your Hopsworks cluster you can add workers to your cluster. To add workers to a cluster, go to the Details tab of this cluster and click on Add workers . Add worker Select the number of workers you want to add (1). Select the type of instance you want the workers to run on (2). Select the local storage size for the workers (3). Click on Next . Add workers Review your request and click Add . Add workers Hopsworks.ai will start the new workers and you will be able to use them in your cluster as soon as they have finished starting. Removing workers # If the load on your Hopsworks cluster is low, you can decide to remove worker nodes from your cluster. Warning When removing workers Hopsworks.ai will try to select workers that can be removed while interfering as little as possible with any ongoing computation. It will also wait for the workers to be done with their computation before stopping them. But, if this computation lasts too long, the worker may get stopped before the computation properly finish. This could interfere with your ongoing computation. Note You can remove all the workers of your cluster. If you do so the cluster will be able to store data but not run any computations. This may affect feature store functionality. To remove workers from a cluster, go to the Details tab of this cluster and click on Remove workers Remove workers For each of the types of instances existing in your cluster select the number of workers you want to remove and click on Next . Remove workers Review your request and click Remove . Remove workers Hopsworks.ai will select the workers corresponding to your criteria which can be stopped with as little interferences as possible with any ongoing computation. It will set them to decommission and stop them when they have finished decommissioning.","title":"Adding and Removing workers"},{"location":"setup_installation/common/adding_removing_workers/#adding-and-removing-workers","text":"Once you have started a hopsworks cluster you can add and remove workers from the cluster to accommodate your workload.","title":"Adding and removing workers"},{"location":"setup_installation/common/adding_removing_workers/#adding-workers","text":"If the computation you are running is using all the resources of your Hopsworks cluster you can add workers to your cluster. To add workers to a cluster, go to the Details tab of this cluster and click on Add workers . Add worker Select the number of workers you want to add (1). Select the type of instance you want the workers to run on (2). Select the local storage size for the workers (3). Click on Next . Add workers Review your request and click Add . Add workers Hopsworks.ai will start the new workers and you will be able to use them in your cluster as soon as they have finished starting.","title":"Adding workers"},{"location":"setup_installation/common/adding_removing_workers/#removing-workers","text":"If the load on your Hopsworks cluster is low, you can decide to remove worker nodes from your cluster. Warning When removing workers Hopsworks.ai will try to select workers that can be removed while interfering as little as possible with any ongoing computation. It will also wait for the workers to be done with their computation before stopping them. But, if this computation lasts too long, the worker may get stopped before the computation properly finish. This could interfere with your ongoing computation. Note You can remove all the workers of your cluster. If you do so the cluster will be able to store data but not run any computations. This may affect feature store functionality. To remove workers from a cluster, go to the Details tab of this cluster and click on Remove workers Remove workers For each of the types of instances existing in your cluster select the number of workers you want to remove and click on Next . Remove workers Review your request and click Remove . Remove workers Hopsworks.ai will select the workers corresponding to your criteria which can be stopped with as little interferences as possible with any ongoing computation. It will set them to decommission and stop them when they have finished decommissioning.","title":"Removing workers"},{"location":"setup_installation/common/api_key/","text":"Hopsworks.ai API Key # Hopsworks.ai allows users to generate an API Key that can be used to authenticate and access the Hopsworks.ai REST APIs. Generate an API Key # First, login to your Hopsworks.ai account, then click on the Settings tab as shown below: Click on the Settings tab Click on the API Key tab, and then click on the Generate API Key button: Generate an API Key Copy the generated API Key and store it in a secure location. Warning Make sure to copy your API Key now. You won\u2019t be able to see it again. However, you can always delete it and generate a new one. Copy the generated API Key Use the API Key # To access the Hopsworks.ai REST APIs, you should pass the API key as a header x-api-key when executing requests on Hopsworks.ai as shown below: curl -XGET -H \"x-api-key: <YOUR API KEY>\" https://api.hopsworks.ai/api/clusters Alternatively, you can use your API Key with the Hopsworks.ai terraform provider to manage your Hopsworks clusters using terraform . Delete your API Key # First, login to your Hopsworks.ai account, click on the Settings tab, then click on the API Key tab, and finally click on Delete API Key as shown below: Delete your API Key","title":"API Key"},{"location":"setup_installation/common/api_key/#hopsworksai-api-key","text":"Hopsworks.ai allows users to generate an API Key that can be used to authenticate and access the Hopsworks.ai REST APIs.","title":"Hopsworks.ai API Key"},{"location":"setup_installation/common/api_key/#generate-an-api-key","text":"First, login to your Hopsworks.ai account, then click on the Settings tab as shown below: Click on the Settings tab Click on the API Key tab, and then click on the Generate API Key button: Generate an API Key Copy the generated API Key and store it in a secure location. Warning Make sure to copy your API Key now. You won\u2019t be able to see it again. However, you can always delete it and generate a new one. Copy the generated API Key","title":"Generate an API Key"},{"location":"setup_installation/common/api_key/#use-the-api-key","text":"To access the Hopsworks.ai REST APIs, you should pass the API key as a header x-api-key when executing requests on Hopsworks.ai as shown below: curl -XGET -H \"x-api-key: <YOUR API KEY>\" https://api.hopsworks.ai/api/clusters Alternatively, you can use your API Key with the Hopsworks.ai terraform provider to manage your Hopsworks clusters using terraform .","title":"Use the API Key"},{"location":"setup_installation/common/api_key/#delete-your-api-key","text":"First, login to your Hopsworks.ai account, click on the Settings tab, then click on the API Key tab, and finally click on Delete API Key as shown below: Delete your API Key","title":"Delete your API Key"},{"location":"setup_installation/common/autoscaling/","text":"Autoscaling # If you run a Hopsworks cluster version 2.2 or above you can enable autoscaling to let hopsworks.ai start and stop workers depending on the demand. Enabling and configuring the autoscaling # Once you have created a cluster you can enable autoscaling by going to the Details tab and clicking on Configure autoscale . You can also set up autoscaling during the cluster creation. For more details about this see the cluster creation documentation ( AWS , AZURE ). Configure autoscale Once you have clicked on Configure autoscale you will access a form allowing you to configure the autoscaling. This form is in two parts. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Configure autoscale details Once you have set your configuration you can review it and enable the autoscaling. Note There are two scenarios if you already have workers in your cluster when enabling the autoscaling: The preexisting workers have the same instance type as the one you set up in the autoscaling. In this case, the autoscaling system will manage these workers and start or stop them automatically. The preexisting workers have a different instance type from the one you set up in the autoscaling. In this case, the autoscaling will not manage these nodes but you will still be able to remove them manually. Configure autoscale review Modifying the autoscaling configuration # You can update the autoscale configuration by going to the Details tab of the cluster and clicking on Configure autoscale . You will then go through the same steps as above. Note that if you change the instance type , nodes that currently exist in the cluster with a different instance type will not be managed by the autoscale system anymore and you will have to remove them manually. Disabling the autoscaling # To disable the autoscaling go to the Details tab, click on Disable autoscale and confirm your action. When you disable autoscaling the nodes that are currently running will keep running. You will need to stop them manually. Disable autoscale","title":"Autoscaling"},{"location":"setup_installation/common/autoscaling/#autoscaling","text":"If you run a Hopsworks cluster version 2.2 or above you can enable autoscaling to let hopsworks.ai start and stop workers depending on the demand.","title":"Autoscaling"},{"location":"setup_installation/common/autoscaling/#enabling-and-configuring-the-autoscaling","text":"Once you have created a cluster you can enable autoscaling by going to the Details tab and clicking on Configure autoscale . You can also set up autoscaling during the cluster creation. For more details about this see the cluster creation documentation ( AWS , AZURE ). Configure autoscale Once you have clicked on Configure autoscale you will access a form allowing you to configure the autoscaling. This form is in two parts. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Configure autoscale details Once you have set your configuration you can review it and enable the autoscaling. Note There are two scenarios if you already have workers in your cluster when enabling the autoscaling: The preexisting workers have the same instance type as the one you set up in the autoscaling. In this case, the autoscaling system will manage these workers and start or stop them automatically. The preexisting workers have a different instance type from the one you set up in the autoscaling. In this case, the autoscaling will not manage these nodes but you will still be able to remove them manually. Configure autoscale review","title":"Enabling and configuring the autoscaling"},{"location":"setup_installation/common/autoscaling/#modifying-the-autoscaling-configuration","text":"You can update the autoscale configuration by going to the Details tab of the cluster and clicking on Configure autoscale . You will then go through the same steps as above. Note that if you change the instance type , nodes that currently exist in the cluster with a different instance type will not be managed by the autoscale system anymore and you will have to remove them manually.","title":"Modifying the autoscaling configuration"},{"location":"setup_installation/common/autoscaling/#disabling-the-autoscaling","text":"To disable the autoscaling go to the Details tab, click on Disable autoscale and confirm your action. When you disable autoscaling the nodes that are currently running will keep running. You will need to stop them manually. Disable autoscale","title":"Disabling the autoscaling"},{"location":"setup_installation/common/gpu_support/","text":"GPU support # Hopsworks can harness the power of GPUs to speed up machine learning processes. You can take advantage of this feature in Hopsworks.ai by adding GPU equipped workers to your cluster. This can be done in two way: creating a cluster with GPU equipped workers or adding GPU equipped workers to an existing cluster. Creating a cluster with GPU equipped workers # When selecting the workers' instance type during the cluster creation, you can select an instance type equipped with GPUs. The cluster will then be created and Hopsworks will automatically detect the GPU resource. Create cluster with GPUs Adding GPU equipped workers to an existing cluster. # When adding workers to a cluster, you can select an instance type equipped with GPUs. The workers will then be added to the cluster and Hopsworks will automatically detect the new GPU resource. Add GPUs to cluster Using the GPUs # Once workers with GPUs have been added to your cluster you can use them by allocating GPUs to JupyterLab or Jobs. Using GPUs in JupyterLab Using GPUs in jobs For more information about using GPUs in Hopsworks you can consult Hopsworks Experiments documentation .","title":"GPU support"},{"location":"setup_installation/common/gpu_support/#gpu-support","text":"Hopsworks can harness the power of GPUs to speed up machine learning processes. You can take advantage of this feature in Hopsworks.ai by adding GPU equipped workers to your cluster. This can be done in two way: creating a cluster with GPU equipped workers or adding GPU equipped workers to an existing cluster.","title":"GPU support"},{"location":"setup_installation/common/gpu_support/#creating-a-cluster-with-gpu-equipped-workers","text":"When selecting the workers' instance type during the cluster creation, you can select an instance type equipped with GPUs. The cluster will then be created and Hopsworks will automatically detect the GPU resource. Create cluster with GPUs","title":"Creating a cluster with GPU equipped workers"},{"location":"setup_installation/common/gpu_support/#adding-gpu-equipped-workers-to-an-existing-cluster","text":"When adding workers to a cluster, you can select an instance type equipped with GPUs. The workers will then be added to the cluster and Hopsworks will automatically detect the new GPU resource. Add GPUs to cluster","title":"Adding GPU equipped workers to an existing cluster."},{"location":"setup_installation/common/gpu_support/#using-the-gpus","text":"Once workers with GPUs have been added to your cluster you can use them by allocating GPUs to JupyterLab or Jobs. Using GPUs in JupyterLab Using GPUs in jobs For more information about using GPUs in Hopsworks you can consult Hopsworks Experiments documentation .","title":"Using the GPUs"},{"location":"setup_installation/common/rondb/","text":"Managed RonDB # For applications where Feature Store's performance and scalability is paramount we give users the option to create clusters with Managed RonDB . You don't need to worry about configuration as hopsworks.ai will automatically pick the best options for your setup. Enabling RonDB # To setup a cluster with RonDB, select RonDB cluster during cluster creation. If you don't see this option contact us . Enable Managed RonDB General # If you enable Managed RonDB you will see a basic configuration page where you can configure the database nodes. RonDB basic configuration Data node # First, you need to select the instance type and local storage size for the data nodes. These are the database nodes that will store data. RonDB is an in-memory database, so in order to fit more data you need to choose an instance type with more memory. Local storage is used for offline storage of recovery data, and requires a disk at least 40 GiB plus 1.8 times the memory size of the data node VM. Number of replicas # Next you need to select the number of replicas . This is the number of copies the cluster will maintain of your data. Choosing 1 replica is the cheapest option since it requires the lowest number of nodes, but this way you don't have High Availability. Whenever any of the nodes in the cluster fails the cluster will also fail, so only choose 1 replica if you are willing to accept cluster failure. The default and recommended is 2 replicas, which allows the cluster to continue operating after any one node fails. With 3 replicas, the cluster can continue operating after any two node failures that happen after each other. MySQLd nodes # Next you can configure the number of MySQLd nodes. These are dedicated nodes for performing SQL queries against your RonDB cluster. In many use cases you can choose zero, since the cluster's Head node already comes with a MySQL server. If you expect high load on MySQL servers, for example if you intend to run a custom streaming application that performs SQL queries in short intervals, then you can add more. If you select at least one MySQLd node, you then get to select the instance type and local storage size for the MySQLd nodes. Advanced # The advanced tab offers less common options. We recommend keeping the defaults unless you know what you are doing. RonDB advanced configuration RonDB Data node groups # You can choose the number of node groups, also known as database shards. The default is 1 node group, which means that all nodes will have a complete copy of all data. Increasing the number of node groups will split the data evenly. This way, you can create a cluster with higher capacity than a single node. For use cases where it is possible, we recommend using 1 node group and choose an instance type with enough memory to fit all data. Below the number of node groups, you will see a summary of cluster resources. The number of data nodes is an important consideration for the cost of the cluster. It is calculated as the number of node groups multiplied by the number of replicas. The memory available to the cluster is calculated as the number of node groups multiplied by the memory per node. Note that the number replicas does not affect the available memory. The CPUs available to the cluster is calculated as the number of node groups multiplied by the number of CPUs per node. Note that the number replicas does not affect the available CPUs. API nodes # API nodes are specialized nodes which can run user code connecting directly to RonDB datanodes for increased performance. You can choose the number of nodes, the instance type and local storage size. There is also a checkbox to grant access to benchmark tools. This will let a benchmark user access specific database tables, so that you can benchmark RonDB safely. RonDB details # Once the cluster is created you can view some details by clicking on the RonDB tab as shown in the picture below. RonDB cluster details","title":"Managed RonDB"},{"location":"setup_installation/common/rondb/#managed-rondb","text":"For applications where Feature Store's performance and scalability is paramount we give users the option to create clusters with Managed RonDB . You don't need to worry about configuration as hopsworks.ai will automatically pick the best options for your setup.","title":"Managed RonDB"},{"location":"setup_installation/common/rondb/#enabling-rondb","text":"To setup a cluster with RonDB, select RonDB cluster during cluster creation. If you don't see this option contact us . Enable Managed RonDB","title":"Enabling RonDB"},{"location":"setup_installation/common/rondb/#general","text":"If you enable Managed RonDB you will see a basic configuration page where you can configure the database nodes. RonDB basic configuration","title":"General"},{"location":"setup_installation/common/rondb/#data-node","text":"First, you need to select the instance type and local storage size for the data nodes. These are the database nodes that will store data. RonDB is an in-memory database, so in order to fit more data you need to choose an instance type with more memory. Local storage is used for offline storage of recovery data, and requires a disk at least 40 GiB plus 1.8 times the memory size of the data node VM.","title":"Data node"},{"location":"setup_installation/common/rondb/#number-of-replicas","text":"Next you need to select the number of replicas . This is the number of copies the cluster will maintain of your data. Choosing 1 replica is the cheapest option since it requires the lowest number of nodes, but this way you don't have High Availability. Whenever any of the nodes in the cluster fails the cluster will also fail, so only choose 1 replica if you are willing to accept cluster failure. The default and recommended is 2 replicas, which allows the cluster to continue operating after any one node fails. With 3 replicas, the cluster can continue operating after any two node failures that happen after each other.","title":"Number of replicas"},{"location":"setup_installation/common/rondb/#mysqld-nodes","text":"Next you can configure the number of MySQLd nodes. These are dedicated nodes for performing SQL queries against your RonDB cluster. In many use cases you can choose zero, since the cluster's Head node already comes with a MySQL server. If you expect high load on MySQL servers, for example if you intend to run a custom streaming application that performs SQL queries in short intervals, then you can add more. If you select at least one MySQLd node, you then get to select the instance type and local storage size for the MySQLd nodes.","title":"MySQLd nodes"},{"location":"setup_installation/common/rondb/#advanced","text":"The advanced tab offers less common options. We recommend keeping the defaults unless you know what you are doing. RonDB advanced configuration","title":"Advanced"},{"location":"setup_installation/common/rondb/#rondb-data-node-groups","text":"You can choose the number of node groups, also known as database shards. The default is 1 node group, which means that all nodes will have a complete copy of all data. Increasing the number of node groups will split the data evenly. This way, you can create a cluster with higher capacity than a single node. For use cases where it is possible, we recommend using 1 node group and choose an instance type with enough memory to fit all data. Below the number of node groups, you will see a summary of cluster resources. The number of data nodes is an important consideration for the cost of the cluster. It is calculated as the number of node groups multiplied by the number of replicas. The memory available to the cluster is calculated as the number of node groups multiplied by the memory per node. Note that the number replicas does not affect the available memory. The CPUs available to the cluster is calculated as the number of node groups multiplied by the number of CPUs per node. Note that the number replicas does not affect the available CPUs.","title":"RonDB Data node groups"},{"location":"setup_installation/common/rondb/#api-nodes","text":"API nodes are specialized nodes which can run user code connecting directly to RonDB datanodes for increased performance. You can choose the number of nodes, the instance type and local storage size. There is also a checkbox to grant access to benchmark tools. This will let a benchmark user access specific database tables, so that you can benchmark RonDB safely.","title":"API nodes"},{"location":"setup_installation/common/rondb/#rondb-details","text":"Once the cluster is created you can view some details by clicking on the RonDB tab as shown in the picture below. RonDB cluster details","title":"RonDB details"},{"location":"setup_installation/common/scalingup/","text":"Scaling up # If you run into limitations due to the instance types you chose during a cluster creation it is possible to scale up the instances to overcome these limitations. Scaling up the workers # If spark jobs are not starting in your cluster it may come from the fact that you don't have worker resources to run them. As workers are stateless the best way to solve this problem is to add new workers with enough resources to handle your job. Or to configure autoscalling to automatically add the workers when needed. Scaling up the head node # You may run into the need to scale up the head node for different reasons. For example: You are running a cluster without dedicated RonDB nodes and have a workload with a high demand on the online feature store. You are running a cluster without managed containers and want to run an important number of jupyter notebooks simultaneously. While we are working on implementing a solution to add these features to an existing cluster you can use the following approach to run your head node on an instance with more vcores and memory to handle more load. To scale up the head node you first have to stop your cluster. Stop the cluster Once the cluster is stopped you can go to the Details tab and click on the head node instance type . Go to details tab an click on the head node instance type This will open a new window. Select the type of instance you want to change to and click on Review and submit Select the new instance type for the heade node Verify your choice and click on Modify Note If you set up your account with AWS in a period predating the introduction of this feature you may need to add the indicated permission to your hopsworks.ai role. Validate your choice You can now start your cluster. The head node will be started on an instance type of the new type you chose. Scaling up the RonDB nodes # If you are running a cluster with dedicated RonDB nodes and have a workload with a high demand on the online feature store you may need to scale up the RonDB Datanodes and MySQLd nodes. For this stop the cluster. Stop the cluster Once the cluster is stopped you can go to the RonDB tab. To scale MySQLd or API nodes, click on the instance type for the node you want to scale up. To scale all datanodes, click on the Change button over their instance types. Datanodes cannot be scaled individually. Go to RonDB tab and click on the instance type you want to change or, for datanodes, click on the Change button This will open a new window. Select the type of instance you want to change to and click on Review and submit Select the new instance type for the heade node Verify your choice and click on Modify Note If you set up your account with AWS in a period predating the introduction of this feature you may need to add the indicated permission to your hopsworks.ai role. Validate your choice You can now start your cluster. The nodes will be started on an instance type of the new type you chose.","title":"Scaling up"},{"location":"setup_installation/common/scalingup/#scaling-up","text":"If you run into limitations due to the instance types you chose during a cluster creation it is possible to scale up the instances to overcome these limitations.","title":"Scaling up"},{"location":"setup_installation/common/scalingup/#scaling-up-the-workers","text":"If spark jobs are not starting in your cluster it may come from the fact that you don't have worker resources to run them. As workers are stateless the best way to solve this problem is to add new workers with enough resources to handle your job. Or to configure autoscalling to automatically add the workers when needed.","title":"Scaling up the workers"},{"location":"setup_installation/common/scalingup/#scaling-up-the-head-node","text":"You may run into the need to scale up the head node for different reasons. For example: You are running a cluster without dedicated RonDB nodes and have a workload with a high demand on the online feature store. You are running a cluster without managed containers and want to run an important number of jupyter notebooks simultaneously. While we are working on implementing a solution to add these features to an existing cluster you can use the following approach to run your head node on an instance with more vcores and memory to handle more load. To scale up the head node you first have to stop your cluster. Stop the cluster Once the cluster is stopped you can go to the Details tab and click on the head node instance type . Go to details tab an click on the head node instance type This will open a new window. Select the type of instance you want to change to and click on Review and submit Select the new instance type for the heade node Verify your choice and click on Modify Note If you set up your account with AWS in a period predating the introduction of this feature you may need to add the indicated permission to your hopsworks.ai role. Validate your choice You can now start your cluster. The head node will be started on an instance type of the new type you chose.","title":"Scaling up the head node"},{"location":"setup_installation/common/scalingup/#scaling-up-the-rondb-nodes","text":"If you are running a cluster with dedicated RonDB nodes and have a workload with a high demand on the online feature store you may need to scale up the RonDB Datanodes and MySQLd nodes. For this stop the cluster. Stop the cluster Once the cluster is stopped you can go to the RonDB tab. To scale MySQLd or API nodes, click on the instance type for the node you want to scale up. To scale all datanodes, click on the Change button over their instance types. Datanodes cannot be scaled individually. Go to RonDB tab and click on the instance type you want to change or, for datanodes, click on the Change button This will open a new window. Select the type of instance you want to change to and click on Review and submit Select the new instance type for the heade node Verify your choice and click on Modify Note If you set up your account with AWS in a period predating the introduction of this feature you may need to add the indicated permission to your hopsworks.ai role. Validate your choice You can now start your cluster. The nodes will be started on an instance type of the new type you chose.","title":"Scaling up the RonDB nodes"},{"location":"setup_installation/common/services/","text":"Services # Hopsworks clusters provide several services that can be accessed from outside Hopsworks. In this documentation, we first show how to make these services accessible to external networks. We will then go through the different services to give a short introduction and link to the associated documentation. Outside Access to the Feature Store # By default, only the Hopsworks UI is made available to clients on external networks, like the Internet. To integrate with external platforms and access APIs for services such as the Feature Store, you have to open the service's ports. Open ports by going to the Services tab, selecting a service, and pressing Update . This will update the Security Group attached to the Hopsworks cluster to allow incoming traffic on the relevant ports. Outside Access to the Feature Store If you do not want the ports to be open to the internet you can set up VPC peering between the Hopsworks VPC and your client VPC. You then need to make sure that the ports associated with the services you want to use are open between the two VPCs. The ports associated with each of the services are indicated in the descriptions of the services below. Feature store # The Feature Store is a data management system for managing machine learning features, including the feature engineering code and the feature data. The Feature Store helps ensure that features used during training and serving are consistent and that features are documented and reused within enterprises. You can find the full feature store documentation here and information about how to connect to the Feature Store from different external services here Ports: 8020, 30010, 9083 and 9085 Online Feature store # The online Feature store is required for online applications, where the goal is to retrieve a single feature vector with low latency and the same logic as was applied to generate the training dataset, such that the vector can subsequently be passed to a machine learning model in production to compute a prediction. You can find a more detailed explanation of the difference between Online and Offline Feature Store here . Once you have opened the ports, the Online Feature store can be used with the same library as the offline feature store. You can find the full documentation here . Port: 3306 Kafka # Hopsworks provides Kafka-as-a-Service for streaming applications and to ingest data. You can find more information about how to use Kafka in Hopsworks in this documentation Port: 9092 SSH # If you want to be able to SSH into the virtual machines running the Hopsworks cluster, you can open the ports using the Services tab. You can then SSH into the machine using your cluster operation system ( ubuntu or centos ) as the user name and the ssh key you selected during the cluster creation. Port: 22. Limiting outbound traffic to Hopsworks.ai # If you have enabled the use of static IPs to communicate with Hopsworks.ai as described in AWS and AZURE , you need to ensure that your security group allow outbound traffic to the two IPs indicated in the service page. Limiting outbound traffic to Hopsworks.ai","title":"Services"},{"location":"setup_installation/common/services/#services","text":"Hopsworks clusters provide several services that can be accessed from outside Hopsworks. In this documentation, we first show how to make these services accessible to external networks. We will then go through the different services to give a short introduction and link to the associated documentation.","title":"Services"},{"location":"setup_installation/common/services/#outside-access-to-the-feature-store","text":"By default, only the Hopsworks UI is made available to clients on external networks, like the Internet. To integrate with external platforms and access APIs for services such as the Feature Store, you have to open the service's ports. Open ports by going to the Services tab, selecting a service, and pressing Update . This will update the Security Group attached to the Hopsworks cluster to allow incoming traffic on the relevant ports. Outside Access to the Feature Store If you do not want the ports to be open to the internet you can set up VPC peering between the Hopsworks VPC and your client VPC. You then need to make sure that the ports associated with the services you want to use are open between the two VPCs. The ports associated with each of the services are indicated in the descriptions of the services below.","title":"Outside Access to the Feature Store"},{"location":"setup_installation/common/services/#feature-store","text":"The Feature Store is a data management system for managing machine learning features, including the feature engineering code and the feature data. The Feature Store helps ensure that features used during training and serving are consistent and that features are documented and reused within enterprises. You can find the full feature store documentation here and information about how to connect to the Feature Store from different external services here Ports: 8020, 30010, 9083 and 9085","title":"Feature store"},{"location":"setup_installation/common/services/#online-feature-store","text":"The online Feature store is required for online applications, where the goal is to retrieve a single feature vector with low latency and the same logic as was applied to generate the training dataset, such that the vector can subsequently be passed to a machine learning model in production to compute a prediction. You can find a more detailed explanation of the difference between Online and Offline Feature Store here . Once you have opened the ports, the Online Feature store can be used with the same library as the offline feature store. You can find the full documentation here . Port: 3306","title":"Online Feature store"},{"location":"setup_installation/common/services/#kafka","text":"Hopsworks provides Kafka-as-a-Service for streaming applications and to ingest data. You can find more information about how to use Kafka in Hopsworks in this documentation Port: 9092","title":"Kafka"},{"location":"setup_installation/common/services/#ssh","text":"If you want to be able to SSH into the virtual machines running the Hopsworks cluster, you can open the ports using the Services tab. You can then SSH into the machine using your cluster operation system ( ubuntu or centos ) as the user name and the ssh key you selected during the cluster creation. Port: 22.","title":"SSH"},{"location":"setup_installation/common/services/#limiting-outbound-traffic-to-hopsworksai","text":"If you have enabled the use of static IPs to communicate with Hopsworks.ai as described in AWS and AZURE , you need to ensure that your security group allow outbound traffic to the two IPs indicated in the service page. Limiting outbound traffic to Hopsworks.ai","title":"Limiting outbound traffic to Hopsworks.ai"},{"location":"setup_installation/common/terraform/","text":"Hopsworks.ai Terraform Provider # Hopsworks.ai allows users to create and manage their clusters using the Hopsworks.ai terraform provider . In this guide, we first provide brief description on how to get started on AWS and AZURE, then we show how to import an existing cluster to be managed by terraform. Getting Started with AWS # Complete the following steps to start using Hopsworks.ai Terraform Provider on AWS. Create a Hopsworks.ai API KEY as described in details here , and export the API KEY as follows export HOPSWORKSAI_API_KEY = <YOUR_API_KEY> Download the proper Terraform CLI for your os from here . Install the AWS CLI and run aws configurre to configure your AWS credentials. Example # In this section, we provide a simple example to create a Hopsworks cluster on AWS along with all its required resources (ssh key, S3 bucket, and instance profile with the required permissions). In your terminal, run the following to create a demo directory and cd to it mkdir demo cd demo In this empty directory, create an empty file main.tf . Open the file and paste the following configurations to it then save it. terraform { required_providers { aws = { source = \"hashicorp/aws\" version = \">=3.42.0\" } hopsworksai = { source = \"logicalclocks/hopsworksai\" } } } variable \"region\" { type = string default = \"us-east-2\" } provider \"aws\" { region = var.region } provider \"hopsworksai\" { } # Create the required aws resources, an ssh key, an s3 bucket, and an instance profile with the required hopsworks permissions module \"aws\" { source = \"logicalclocks/helpers/hopsworksai//modules/aws\" region = var.region } # Create a cluster with no workers resource \"hopsworksai_cluster\" \"cluster\" { name = \"tf-hopsworks-cluster\" ssh_key = module.aws.ssh_key_pair_name head { } aws_attributes { region = var.region bucket_name = module.aws.bucket_name instance_profile_arn = module.aws.instance_profile_arn } open_ports { ssh = true } } output \"hopsworks_cluster_url\" { value = hopsworksai_cluster.cluster.url } Initialize the terraform directory by running the following command terraform init Now you can apply the changes to create all required resources terraform apply Once terraform finishes creating the resources, it will output the url to the newly created cluster. Notice that for now, you have to navigate to your Hopsworks.ai dashboard to get your login credentials. After you finish working with the cluster, you can terminate it along with the other AWS resources using the following command terraform destroy Getting Started with AZURE # Complete the following steps to start using Hopsworks.ai Terraform Provider on AZURE. Create a Hopsworks.ai API KEY as described in details here , and export the API KEY as follows export HOPSWORKSAI_API_KEY = <YOUR_API_KEY> Download the proper Terraform CLI for your os from here . Install the AZURE CLI and run az login to configure your AZURE credentials. Example # In this section, we provide a simple example to create a Hopsworks cluster on AWS along with all its required resources (ssh key, S3 bucket, and instance profile with the required permissions). In your terminal, run the following to create a demo directory and cd to it mkdir demo cd demo In this empty directory, create an empty file main.tf . Open the file and paste the following configurations to it then save it. terraform { required_providers { azurerm = { source = \"hashicorp/azurerm\" version = \">= 2.60.0\" } hopsworksai = { source = \"logicalclocks/hopsworksai\" } } } variable \"resource_group\" { type = string } provider \"azurerm\" { features {} skip_provider_registration = true } provider \"hopsworksai\" { } data \"azurerm_resource_group\" \"rg\" { name = var.resource_group } # Create the required azure resources, an ssh key, a storage account, and an user assigned managed identity with the required hopsworks permissions module \"azure\" { source = \"logicalclocks/helpers/hopsworksai//modules/azure\" resource_group = var.resource_group } # Create a cluster with no workers resource \"hopsworksai_cluster\" \"cluster\" { name = \"tf-hopsworks-cluster\" ssh_key = module.azure.ssh_key_pair_name head { } azure_attributes { location = module.azure.location resource_group = module.azure.resource_group storage_account = module.azure.storage_account_name user_assigned_managed_identity = module.azure.user_assigned_identity_name } open_ports { ssh = true } } output \"hopsworks_cluster_url\" { value = hopsworksai_cluster.cluster.url } Initialize the terraform directory by running the following command terraform init Now you can apply the changes to create all required resources terraform apply Once terraform finishes creating the resources, it will output the url to the newly created cluster. Notice that for now, you have to navigate to your Hopsworks.ai dashboard to get your login credentials. After you finish working with the cluster, you can terminate it along with the other AZURE resources using the following command terraform destroy Importing an existing cluster to terraform # In this section, we show how to use terraform import to manage your existing Hopsworks cluster. Step 1 : In your Hopsworks.ai dashboard , choose the cluster you want to import to terraform, then go to the Details tab and copy the Id as shown in the figure below Click on the Details tab and copy the Id Step 2 : In your terminal, create an empty directory and cd to it. mkdir import-demo cd import-demo Step 3 : In this empty directory, create an empty file versions.tf . Open the file and paste the following configurations. Note Notice that you need to change these configurations depending on your cluster, in this example, the Hopsworks cluster reside in region us-east-2 on AWS. terraform { required_providers { aws = { source = \"hashicorp/aws\" version = \">=3.42.0\" } hopsworksai = { source = \"logicalclocks/hopsworksai\" } } } provider \"aws\" { region = us-east-2 } provider \"hopsworksai\" { } Step 4 : Initialize the terraform directory by running the following command terraform init Step 5 : Create another file main.tf . Open the file and paste the following configuration. resource \"hopsworksai_cluster\" \"cluster\" { } Step 6 : Import the cluster state using terraform import , in this step you need the cluster id from Step 1 (33ae7ae0-d03c-11eb-84e2-af555fb63565). terraform import hopsworksai_cluster.cluster 33ae7ae0-d03c-11eb-84e2-af555fb63565 The output should be similar to the following snippet hopsworksai_cluster.cluster: Importing from ID \"33ae7ae0-d03c-11eb-84e2-af555fb63565\" ... hopsworksai_cluster.cluster: Import prepared! Prepared hopsworksai_cluster for import hopsworksai_cluster.cluster: Refreshing state... [ id = 33ae7ae0-d03c-11eb-84e2-af555fb63565 ] Import successful! The resources that were imported are shown above. These resources are now in your Terraform state and will henceforth be managed by Terraform. Step 7 : At that moment the local terraform state is updated, however, if we try to run terraform plan or terraform apply it will complain about missing configurations. The reason is that our local resource configuration in main.tf is empty, we should populate it using the terraform state commands as shown below: terraform show -no-color > main.tf Step 8 : If you try to run terraform plan again, the command will complain that the read-only attributes are set (Computed attributes) as shown below. The solution is to remove these attributes from the main.tf and retry again until you have no errors. Error: Computed attributes cannot be set on main.tf line 3 , in resource \"hopsworksai_cluster\" \"cluster\" : 3 : activation_state = \"stoppable\" Computed attributes cannot be set, but a value was set for \"activation_state\" . Error: Computed attributes cannot be set on main.tf line 6 , in resource \"hopsworksai_cluster\" \"cluster\" : 6 : cluster_id = \"33ae7ae0-d03c-11eb-84e2-af555fb63565\" Computed attributes cannot be set, but a value was set for \"cluster_id\" . Error: Computed attributes cannot be set on main.tf line 7 , in resource \"hopsworksai_cluster\" \"cluster\" : 7 : creation_date = \"2021-06-18T15:51:07+02:00\" Computed attributes cannot be set, but a value was set for \"creation_date\" . Error: Invalid or unknown key on main.tf line 8 , in resource \"hopsworksai_cluster\" \"cluster\" : 8 : id = \"33ae7ae0-d03c-11eb-84e2-af555fb63565\" Error: Computed attributes cannot be set on main.tf line 13 , in resource \"hopsworksai_cluster\" \"cluster\" : 13 : start_date = \"2021-06-18T15:51:07+02:00\" Computed attributes cannot be set, but a value was set for \"start_date\" . Error: Computed attributes cannot be set on main.tf line 14 , in resource \"hopsworksai_cluster\" \"cluster\" : 14 : state = \"running\" Computed attributes cannot be set, but a value was set for \"state\" . Error: Computed attributes cannot be set on main.tf line 17 , in resource \"hopsworksai_cluster\" \"cluster\" : 17 : url = \"https://33ae7ae0-d03c-11eb-84e2-af555fb63565.dev-cloud.hopsworks.ai/hopsworks/#!/\" Computed attributes cannot be set, but a value was set for \"url\" . Step 9 : Once you have fixed all the errors, you should get the following output when running terraform plan . With that, you can proceed as normal to manage this cluster locally using terraform. hopsworksai_cluster.cluster: Refreshing state... [ id = 33ae7ae0-d03c-11eb-84e2-af555fb63565 ] No changes. Infrastructure is up-to-date. This means that Terraform did not detect any differences between your configuration and real physical resources that exist. As a result, no actions need to be performed. Next Steps # Check the Hopsworks.ai terraform provider documentation for more details about the different resources and data sources supported by the provider and a description of their attributes. Check the Hopsworks.ai terraform AWS examples , each example contains a README file describing how to run it and more details about configuring it. Check the Hopsworks.ai terraform AZURE examples , each example contains a README file describing how to run it and more details about configuring it.","title":"Terraform"},{"location":"setup_installation/common/terraform/#hopsworksai-terraform-provider","text":"Hopsworks.ai allows users to create and manage their clusters using the Hopsworks.ai terraform provider . In this guide, we first provide brief description on how to get started on AWS and AZURE, then we show how to import an existing cluster to be managed by terraform.","title":"Hopsworks.ai Terraform Provider"},{"location":"setup_installation/common/terraform/#getting-started-with-aws","text":"Complete the following steps to start using Hopsworks.ai Terraform Provider on AWS. Create a Hopsworks.ai API KEY as described in details here , and export the API KEY as follows export HOPSWORKSAI_API_KEY = <YOUR_API_KEY> Download the proper Terraform CLI for your os from here . Install the AWS CLI and run aws configurre to configure your AWS credentials.","title":"Getting Started with AWS"},{"location":"setup_installation/common/terraform/#example","text":"In this section, we provide a simple example to create a Hopsworks cluster on AWS along with all its required resources (ssh key, S3 bucket, and instance profile with the required permissions). In your terminal, run the following to create a demo directory and cd to it mkdir demo cd demo In this empty directory, create an empty file main.tf . Open the file and paste the following configurations to it then save it. terraform { required_providers { aws = { source = \"hashicorp/aws\" version = \">=3.42.0\" } hopsworksai = { source = \"logicalclocks/hopsworksai\" } } } variable \"region\" { type = string default = \"us-east-2\" } provider \"aws\" { region = var.region } provider \"hopsworksai\" { } # Create the required aws resources, an ssh key, an s3 bucket, and an instance profile with the required hopsworks permissions module \"aws\" { source = \"logicalclocks/helpers/hopsworksai//modules/aws\" region = var.region } # Create a cluster with no workers resource \"hopsworksai_cluster\" \"cluster\" { name = \"tf-hopsworks-cluster\" ssh_key = module.aws.ssh_key_pair_name head { } aws_attributes { region = var.region bucket_name = module.aws.bucket_name instance_profile_arn = module.aws.instance_profile_arn } open_ports { ssh = true } } output \"hopsworks_cluster_url\" { value = hopsworksai_cluster.cluster.url } Initialize the terraform directory by running the following command terraform init Now you can apply the changes to create all required resources terraform apply Once terraform finishes creating the resources, it will output the url to the newly created cluster. Notice that for now, you have to navigate to your Hopsworks.ai dashboard to get your login credentials. After you finish working with the cluster, you can terminate it along with the other AWS resources using the following command terraform destroy","title":"Example"},{"location":"setup_installation/common/terraform/#getting-started-with-azure","text":"Complete the following steps to start using Hopsworks.ai Terraform Provider on AZURE. Create a Hopsworks.ai API KEY as described in details here , and export the API KEY as follows export HOPSWORKSAI_API_KEY = <YOUR_API_KEY> Download the proper Terraform CLI for your os from here . Install the AZURE CLI and run az login to configure your AZURE credentials.","title":"Getting Started with AZURE"},{"location":"setup_installation/common/terraform/#example_1","text":"In this section, we provide a simple example to create a Hopsworks cluster on AWS along with all its required resources (ssh key, S3 bucket, and instance profile with the required permissions). In your terminal, run the following to create a demo directory and cd to it mkdir demo cd demo In this empty directory, create an empty file main.tf . Open the file and paste the following configurations to it then save it. terraform { required_providers { azurerm = { source = \"hashicorp/azurerm\" version = \">= 2.60.0\" } hopsworksai = { source = \"logicalclocks/hopsworksai\" } } } variable \"resource_group\" { type = string } provider \"azurerm\" { features {} skip_provider_registration = true } provider \"hopsworksai\" { } data \"azurerm_resource_group\" \"rg\" { name = var.resource_group } # Create the required azure resources, an ssh key, a storage account, and an user assigned managed identity with the required hopsworks permissions module \"azure\" { source = \"logicalclocks/helpers/hopsworksai//modules/azure\" resource_group = var.resource_group } # Create a cluster with no workers resource \"hopsworksai_cluster\" \"cluster\" { name = \"tf-hopsworks-cluster\" ssh_key = module.azure.ssh_key_pair_name head { } azure_attributes { location = module.azure.location resource_group = module.azure.resource_group storage_account = module.azure.storage_account_name user_assigned_managed_identity = module.azure.user_assigned_identity_name } open_ports { ssh = true } } output \"hopsworks_cluster_url\" { value = hopsworksai_cluster.cluster.url } Initialize the terraform directory by running the following command terraform init Now you can apply the changes to create all required resources terraform apply Once terraform finishes creating the resources, it will output the url to the newly created cluster. Notice that for now, you have to navigate to your Hopsworks.ai dashboard to get your login credentials. After you finish working with the cluster, you can terminate it along with the other AZURE resources using the following command terraform destroy","title":"Example"},{"location":"setup_installation/common/terraform/#importing-an-existing-cluster-to-terraform","text":"In this section, we show how to use terraform import to manage your existing Hopsworks cluster. Step 1 : In your Hopsworks.ai dashboard , choose the cluster you want to import to terraform, then go to the Details tab and copy the Id as shown in the figure below Click on the Details tab and copy the Id Step 2 : In your terminal, create an empty directory and cd to it. mkdir import-demo cd import-demo Step 3 : In this empty directory, create an empty file versions.tf . Open the file and paste the following configurations. Note Notice that you need to change these configurations depending on your cluster, in this example, the Hopsworks cluster reside in region us-east-2 on AWS. terraform { required_providers { aws = { source = \"hashicorp/aws\" version = \">=3.42.0\" } hopsworksai = { source = \"logicalclocks/hopsworksai\" } } } provider \"aws\" { region = us-east-2 } provider \"hopsworksai\" { } Step 4 : Initialize the terraform directory by running the following command terraform init Step 5 : Create another file main.tf . Open the file and paste the following configuration. resource \"hopsworksai_cluster\" \"cluster\" { } Step 6 : Import the cluster state using terraform import , in this step you need the cluster id from Step 1 (33ae7ae0-d03c-11eb-84e2-af555fb63565). terraform import hopsworksai_cluster.cluster 33ae7ae0-d03c-11eb-84e2-af555fb63565 The output should be similar to the following snippet hopsworksai_cluster.cluster: Importing from ID \"33ae7ae0-d03c-11eb-84e2-af555fb63565\" ... hopsworksai_cluster.cluster: Import prepared! Prepared hopsworksai_cluster for import hopsworksai_cluster.cluster: Refreshing state... [ id = 33ae7ae0-d03c-11eb-84e2-af555fb63565 ] Import successful! The resources that were imported are shown above. These resources are now in your Terraform state and will henceforth be managed by Terraform. Step 7 : At that moment the local terraform state is updated, however, if we try to run terraform plan or terraform apply it will complain about missing configurations. The reason is that our local resource configuration in main.tf is empty, we should populate it using the terraform state commands as shown below: terraform show -no-color > main.tf Step 8 : If you try to run terraform plan again, the command will complain that the read-only attributes are set (Computed attributes) as shown below. The solution is to remove these attributes from the main.tf and retry again until you have no errors. Error: Computed attributes cannot be set on main.tf line 3 , in resource \"hopsworksai_cluster\" \"cluster\" : 3 : activation_state = \"stoppable\" Computed attributes cannot be set, but a value was set for \"activation_state\" . Error: Computed attributes cannot be set on main.tf line 6 , in resource \"hopsworksai_cluster\" \"cluster\" : 6 : cluster_id = \"33ae7ae0-d03c-11eb-84e2-af555fb63565\" Computed attributes cannot be set, but a value was set for \"cluster_id\" . Error: Computed attributes cannot be set on main.tf line 7 , in resource \"hopsworksai_cluster\" \"cluster\" : 7 : creation_date = \"2021-06-18T15:51:07+02:00\" Computed attributes cannot be set, but a value was set for \"creation_date\" . Error: Invalid or unknown key on main.tf line 8 , in resource \"hopsworksai_cluster\" \"cluster\" : 8 : id = \"33ae7ae0-d03c-11eb-84e2-af555fb63565\" Error: Computed attributes cannot be set on main.tf line 13 , in resource \"hopsworksai_cluster\" \"cluster\" : 13 : start_date = \"2021-06-18T15:51:07+02:00\" Computed attributes cannot be set, but a value was set for \"start_date\" . Error: Computed attributes cannot be set on main.tf line 14 , in resource \"hopsworksai_cluster\" \"cluster\" : 14 : state = \"running\" Computed attributes cannot be set, but a value was set for \"state\" . Error: Computed attributes cannot be set on main.tf line 17 , in resource \"hopsworksai_cluster\" \"cluster\" : 17 : url = \"https://33ae7ae0-d03c-11eb-84e2-af555fb63565.dev-cloud.hopsworks.ai/hopsworks/#!/\" Computed attributes cannot be set, but a value was set for \"url\" . Step 9 : Once you have fixed all the errors, you should get the following output when running terraform plan . With that, you can proceed as normal to manage this cluster locally using terraform. hopsworksai_cluster.cluster: Refreshing state... [ id = 33ae7ae0-d03c-11eb-84e2-af555fb63565 ] No changes. Infrastructure is up-to-date. This means that Terraform did not detect any differences between your configuration and real physical resources that exist. As a result, no actions need to be performed.","title":"Importing an existing cluster to terraform"},{"location":"setup_installation/common/terraform/#next-steps","text":"Check the Hopsworks.ai terraform provider documentation for more details about the different resources and data sources supported by the provider and a description of their attributes. Check the Hopsworks.ai terraform AWS examples , each example contains a README file describing how to run it and more details about configuring it. Check the Hopsworks.ai terraform AZURE examples , each example contains a README file describing how to run it and more details about configuring it.","title":"Next Steps"},{"location":"setup_installation/common/user_management/","text":"User management # In Hopsworks.ai users can be grouped into organizations to access the same resources. When a new user registers with Hopsworks.ai a new organization is created. This user later on can invite other registered users to their organization so they can share access to the same clusters. Cloud Accounts configuration is also shared among users of the same organization. So if user Alice has configured her account with her credentials, all member of her organization will automatically deploy clusters in her cloud account. Credits and cluster usage are also grouped to ease reporting. Adding members to an organization # Organization membership can be edited by clicking Members on the left of Hopsworks.ai Dashboard page. Organization membership To add a new member to your organization add the user's email and click Add . The invited user will receive an email with the invitation. An invited user must accept the invitation to be part of the organization. An invitation will show up in the invited member's Dashboard. In this example Alice has invited Bob to her organization, but Bob hasn't accepted the invitation yet. Alice has sent the invitation Bob's dashboard Sharing resources # Once Bob has accepted the invitation he does not have to configure his account, they share the same configuration. Also, he will be able to view the same Dashboard as Alice, so he can start, stop or terminate clusters in the organization. Alice's dashboard Bob's dashboard If Alice had existing clusters running and she had selected Managed user management during cluster creation, an account will be automatically created for Bob on these clusters. Removing members from an organization # To remove a member from your organization simply go to Members page and click the Remove button next to the user you want to remove. You will stop sharing any resource and the user will be blocked from any shared cluster. Delete organization member","title":"User management"},{"location":"setup_installation/common/user_management/#user-management","text":"In Hopsworks.ai users can be grouped into organizations to access the same resources. When a new user registers with Hopsworks.ai a new organization is created. This user later on can invite other registered users to their organization so they can share access to the same clusters. Cloud Accounts configuration is also shared among users of the same organization. So if user Alice has configured her account with her credentials, all member of her organization will automatically deploy clusters in her cloud account. Credits and cluster usage are also grouped to ease reporting.","title":"User management"},{"location":"setup_installation/common/user_management/#adding-members-to-an-organization","text":"Organization membership can be edited by clicking Members on the left of Hopsworks.ai Dashboard page. Organization membership To add a new member to your organization add the user's email and click Add . The invited user will receive an email with the invitation. An invited user must accept the invitation to be part of the organization. An invitation will show up in the invited member's Dashboard. In this example Alice has invited Bob to her organization, but Bob hasn't accepted the invitation yet. Alice has sent the invitation Bob's dashboard","title":"Adding members to an organization"},{"location":"setup_installation/common/user_management/#sharing-resources","text":"Once Bob has accepted the invitation he does not have to configure his account, they share the same configuration. Also, he will be able to view the same Dashboard as Alice, so he can start, stop or terminate clusters in the organization. Alice's dashboard Bob's dashboard If Alice had existing clusters running and she had selected Managed user management during cluster creation, an account will be automatically created for Bob on these clusters.","title":"Sharing resources"},{"location":"setup_installation/common/user_management/#removing-members-from-an-organization","text":"To remove a member from your organization simply go to Members page and click the Remove button next to the user you want to remove. You will stop sharing any resource and the user will be blocked from any shared cluster. Delete organization member","title":"Removing members from an organization"},{"location":"setup_installation/common/aws/upgrade/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (AWS) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available Step 2: Add upgrade permissions to your instance profile # Note You can skip this step if you already have the following permissions in your instance profile: [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ] We require extra permissions to be added to the instance profile attached to your cluster to proceed with the upgrade. First to get the name of your instance profile, click on the Details tab as shown below: Getting the name of your instance profile Once you get your instance profile name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . Note You can restrict the upgrade permissions given to your instance profile. Refer to this guide for more information. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" } ] } Step 3: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your instance profile (hopsworks-doc) includes the following permissions: [ \"ec2:DetachVolume\", \"ec2:AttachVolume\", \"ec2:ModifyInstanceAttribute\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your instance profile, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Misconfigured upgrade permissions # During the upgrade process, Hopsworks.ai starts by validating your instance profile permissions to ensure that it includes the required upgrade permissions. If one or more permissions are missing, or if the resource is not set correctly, you will be notified with an error message and a Retry button will appear as shown below: Upgrade permissions are missing Update you instance profile accordingly, then click Retry Upgrade is running Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"AWS"},{"location":"setup_installation/common/aws/upgrade/#upgrade-existing-clusters-on-hopsworksai-from-version-22-or-older-aws","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (AWS)"},{"location":"setup_installation/common/aws/upgrade/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/common/aws/upgrade/#step-2-add-upgrade-permissions-to-your-instance-profile","text":"Note You can skip this step if you already have the following permissions in your instance profile: [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ] We require extra permissions to be added to the instance profile attached to your cluster to proceed with the upgrade. First to get the name of your instance profile, click on the Details tab as shown below: Getting the name of your instance profile Once you get your instance profile name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . Note You can restrict the upgrade permissions given to your instance profile. Refer to this guide for more information. { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"UpgradePermissions\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:DescribeVolumes\" , \"ec2:DetachVolume\" , \"ec2:AttachVolume\" , \"ec2:ModifyInstanceAttribute\" ], \"Resource\" : \"*\" } ] }","title":"Step 2: Add upgrade permissions to your instance profile"},{"location":"setup_installation/common/aws/upgrade/#step-3-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your instance profile (hopsworks-doc) includes the following permissions: [ \"ec2:DetachVolume\", \"ec2:AttachVolume\", \"ec2:ModifyInstanceAttribute\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete","title":"Step 3: Run the upgrade process"},{"location":"setup_installation/common/aws/upgrade/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your instance profile, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/common/aws/upgrade/#error-1-misconfigured-upgrade-permissions","text":"During the upgrade process, Hopsworks.ai starts by validating your instance profile permissions to ensure that it includes the required upgrade permissions. If one or more permissions are missing, or if the resource is not set correctly, you will be notified with an error message and a Retry button will appear as shown below: Upgrade permissions are missing Update you instance profile accordingly, then click Retry Upgrade is running","title":"Error 1: Misconfigured upgrade permissions"},{"location":"setup_installation/common/aws/upgrade/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/common/aws/upgrade_2.4/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (AWS) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available Step 2: Add backup permissions to your cross account role # Note You can skip this step if you already have the following permissions in your cross account role: [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ] We require some extra permissions to be added to the role you have created when connecting your AWS account as described in getting started guide . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. First, check which role or access key you have added to Hopsworks.ai, you can go to the Settings tab, and then click Edit next to the AWS cloud account Cloud Accounts Once you have clicked on Edit , you will be able to see the current assigned role AWS Cross-Account Role Once you get your role name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"HopsworksAIBackup\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" } ] } Step 3: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your cross-account role which you have connected to Hopsworks.ai has the following permissions: [ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version on the Details tab of your cluster. Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your cross-account role, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Missing backup permissions # If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Upgrade permissions are missing Update you cross account role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again. Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"AWS"},{"location":"setup_installation/common/aws/upgrade_2.4/#upgrade-existing-clusters-on-hopsworksai-from-version-24-or-newer-aws","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (AWS)"},{"location":"setup_installation/common/aws/upgrade_2.4/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear. You can proceed by clicking the Upgrade button. A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/common/aws/upgrade_2.4/#step-2-add-backup-permissions-to-your-cross-account-role","text":"Note You can skip this step if you already have the following permissions in your cross account role: [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ] We require some extra permissions to be added to the role you have created when connecting your AWS account as described in getting started guide . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. First, check which role or access key you have added to Hopsworks.ai, you can go to the Settings tab, and then click Edit next to the AWS cloud account Cloud Accounts Once you have clicked on Edit , you will be able to see the current assigned role AWS Cross-Account Role Once you get your role name, navigate to AWS management console , then click on Roles and then search for your role name and click on it. Go to the Permissions tab, click on Add inline policy , and then go to the JSON tab. Paste the following snippet, click on Review policy , name it, and click Create policy . { \"Version\" : \"2012-10-17\" , \"Statement\" : [ { \"Sid\" : \"HopsworksAIBackup\" , \"Effect\" : \"Allow\" , \"Action\" : [ \"ec2:RegisterImage\" , \"ec2:DeregisterImage\" , \"ec2:DescribeImages\" , \"ec2:CreateSnapshot\" , \"ec2:DeleteSnapshot\" , \"ec2:DescribeSnapshots\" ], \"Resource\" : \"*\" } ] }","title":"Step 2: Add backup permissions to your cross account role"},{"location":"setup_installation/common/aws/upgrade_2.4/#step-3-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your cross-account role which you have connected to Hopsworks.ai has the following permissions: [ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version on the Details tab of your cluster.","title":"Step 3: Run the upgrade process"},{"location":"setup_installation/common/aws/upgrade_2.4/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your cross-account role, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/common/aws/upgrade_2.4/#error-1-missing-backup-permissions","text":"If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Upgrade permissions are missing Update you cross account role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again.","title":"Error 1: Missing backup permissions"},{"location":"setup_installation/common/aws/upgrade_2.4/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/common/azure/upgrade/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (Azure) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available Step 2: Add upgrade permissions to your user assigned managed identity # Note You can skip this step if you already have the following permissions in your user assigned managed identity : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Make sure that the scope of these permissions is your resource group. We require extra permissions to be added to the user assigned managed identity attached to your cluster to proceed with the upgrade. First to get the name of your user assigned managed identity and the resource group of your cluster, click on the Details tab as shown below: Get the resource group name (1) and the user assigned managed identity (2) of your cluster Step 2.1: Add custom role for upgrade permissions # Once you get the names of the resource group and user-assigned managed identity, follow the same steps as in getting started to add a custom role . First, navigate to Azure portal , then click on Resource groups and then search for your resource group and click on it. Go to the Access control (IAM) tab, select Add , and click on Add custom role Add a custom role for upgrade Name the custom role and then click on next till you reach the JSON tab. Name the custom role for upgrade Once you reach the JSON tab, click on Edit to edit the role permissions: Edit the JSON permissions for the custom role for upgrade Once you have clicked on Edit , replace the permissions array with the following snippet: \"permissions\" : [ { \"actions\" : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ], \"notActions\" : [], \"dataActions\" : [], \"notDataActions\" : [] } ] Then, click on Save to save the updated permissions Save permissions for the custom role for upgrade Click on Review and create and then click on Create to create the custom role: Save permissions for the custom role for upgrade Step 2.2: Assign the custom role to your user-assigned managed identity # Navigate back to the your Resource group home page at Azure portal , click on Add and then click on Add role assignment Assign upgrade role to your user assigned managed identity (1) choose the upgrade role that you have just created in Step 2.1 , (2) choose User Assigned Managed Identity , (3) search for the user assigned managed identity attached to your cluster and select it. Finally, (4) click on Save to save the role assignment. Assign upgrade role to your user assigned managed identity Warning When you assign roles or remove role assignments, it can take up to 30 minutes for changes to take effect. Step 3: Add disk read permissions to your role connected to Hopsworks.ai # We require extra permission (\"Microsoft.Compute/disks/read\") to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai Now, add the missing permission \"Microsoft.Compute/disks/read\" to the list of actions, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai Step 4: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your user assigned managed identity (hopsworks-doc-identity) includes the following permissions: [ \"Microsoft.Compute/virtualMachines/read\", \"Microsoft.Compute/virtualMachines/write\", \"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\", \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Missing permissions error # If you encounter the following permission error right after starting an upgrade, then you need to make sure that the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 , have permissions to read and write disks (\"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\") . Missing permission error If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai In our example, we were missing only the read permission (\"Microsoft.Compute/disks/read\"). First, add the missing permission, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai Once you have updated your role, click on Retry to retry the upgrade process. Retry the upgrade process Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Azure"},{"location":"setup_installation/common/azure/upgrade/#upgrade-existing-clusters-on-hopsworksai-from-version-22-or-older-azure","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.2 or older (Azure)"},{"location":"setup_installation/common/azure/upgrade/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/common/azure/upgrade/#step-2-add-upgrade-permissions-to-your-user-assigned-managed-identity","text":"Note You can skip this step if you already have the following permissions in your user assigned managed identity : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Make sure that the scope of these permissions is your resource group. We require extra permissions to be added to the user assigned managed identity attached to your cluster to proceed with the upgrade. First to get the name of your user assigned managed identity and the resource group of your cluster, click on the Details tab as shown below: Get the resource group name (1) and the user assigned managed identity (2) of your cluster","title":"Step 2: Add upgrade permissions to your user assigned managed identity"},{"location":"setup_installation/common/azure/upgrade/#step-21-add-custom-role-for-upgrade-permissions","text":"Once you get the names of the resource group and user-assigned managed identity, follow the same steps as in getting started to add a custom role . First, navigate to Azure portal , then click on Resource groups and then search for your resource group and click on it. Go to the Access control (IAM) tab, select Add , and click on Add custom role Add a custom role for upgrade Name the custom role and then click on next till you reach the JSON tab. Name the custom role for upgrade Once you reach the JSON tab, click on Edit to edit the role permissions: Edit the JSON permissions for the custom role for upgrade Once you have clicked on Edit , replace the permissions array with the following snippet: \"permissions\" : [ { \"actions\" : [ \"Microsoft.Compute/virtualMachines/read\" , \"Microsoft.Compute/virtualMachines/write\" , \"Microsoft.Compute/disks/read\" , \"Microsoft.Compute/disks/write\" , \"Microsoft.Storage/storageAccounts/listKeys/action\" ], \"notActions\" : [], \"dataActions\" : [], \"notDataActions\" : [] } ] Then, click on Save to save the updated permissions Save permissions for the custom role for upgrade Click on Review and create and then click on Create to create the custom role: Save permissions for the custom role for upgrade","title":"Step 2.1: Add custom role for upgrade permissions"},{"location":"setup_installation/common/azure/upgrade/#step-22-assign-the-custom-role-to-your-user-assigned-managed-identity","text":"Navigate back to the your Resource group home page at Azure portal , click on Add and then click on Add role assignment Assign upgrade role to your user assigned managed identity (1) choose the upgrade role that you have just created in Step 2.1 , (2) choose User Assigned Managed Identity , (3) search for the user assigned managed identity attached to your cluster and select it. Finally, (4) click on Save to save the role assignment. Assign upgrade role to your user assigned managed identity Warning When you assign roles or remove role assignments, it can take up to 30 minutes for changes to take effect.","title":"Step 2.2: Assign the custom role to your user-assigned managed identity"},{"location":"setup_installation/common/azure/upgrade/#step-3-add-disk-read-permissions-to-your-role-connected-to-hopsworksai","text":"We require extra permission (\"Microsoft.Compute/disks/read\") to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai Now, add the missing permission \"Microsoft.Compute/disks/read\" to the list of actions, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai","title":"Step 3: Add disk read permissions to your role connected to Hopsworks.ai"},{"location":"setup_installation/common/azure/upgrade/#step-4-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your user assigned managed identity (hopsworks-doc-identity) includes the following permissions: [ \"Microsoft.Compute/virtualMachines/read\", \"Microsoft.Compute/virtualMachines/write\", \"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\", \"Microsoft.Storage/storageAccounts/listKeys/action\" ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below: Upgrade is complete","title":"Step 4: Run the upgrade process"},{"location":"setup_installation/common/azure/upgrade/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/common/azure/upgrade/#error-1-missing-permissions-error","text":"If you encounter the following permission error right after starting an upgrade, then you need to make sure that the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 , have permissions to read and write disks (\"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\") . Missing permission error If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopswork.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopswork.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopswork.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopswork.ai In our example, we were missing only the read permission (\"Microsoft.Compute/disks/read\"). First, add the missing permission, then click on Save , click on Review + update , and finally click on Update . Add missing permissions to your role connected to hopswork.ai Once you have updated your role, click on Retry to retry the upgrade process. Retry the upgrade process","title":"Error 1: Missing permissions error"},{"location":"setup_installation/common/azure/upgrade/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/common/azure/upgrade_2.4/","text":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (Azure) # This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks. Step 1: Make sure your cluster is running # It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available Step 2: Add backup permissions to your role connected to Hopsworks.ai # We require extra permission to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. \"actions\" : [ \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , ] If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopsworks.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopsworks.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopsworks.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopsworks.ai Now, add the following permissions to the list of actions, then click on Save , click on Review + update , and finally click on Update . \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , Add missing permissions to your role connected to hopsworks.ai Step 3: Run the upgrade process # You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your custom role which you have connected to Hopsworks.ai has the following permissions: [ \"Microsoft.Compute/snapshots/write\", \"Microsoft.Compute/snapshots/read\", \"Microsoft.Compute/snapshots/delete\", \"Microsoft.Compute/disks/beginGetAccess/action\", ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version number on the Details tab of your cluster. Error handling # There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 . Error 1: Missing permissions error # If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Missing permission error Update your cross custom role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again. Error 2: Upgrade process error # If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (Azure)"},{"location":"setup_installation/common/azure/upgrade_2.4/#upgrade-existing-clusters-on-hopsworksai-from-version-24-or-newer-azure","text":"This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.","title":"Upgrade existing clusters on Hopsworks.ai from version 2.4 or newer (Azure)"},{"location":"setup_installation/common/azure/upgrade_2.4/#step-1-make-sure-your-cluster-is-running","text":"It is important that your cluster is Running . Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear: A new Hopsworks version is available","title":"Step 1: Make sure your cluster is running"},{"location":"setup_installation/common/azure/upgrade_2.4/#step-2-add-backup-permissions-to-your-role-connected-to-hopsworksai","text":"We require extra permission to be added to the role you used to connect to Hopsworks.ai, the one that you have created in Getting started Step 1.2 . These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. \"actions\" : [ \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , ] If you don't remember the name of the role that you have created in Getting started Step 1.2 , you can navigate to your Resource group, (1) click on Access Control , (2) navigate to the Check Access tab, (3) search for hopsworks.ai , (4) click on it, (5) now you have the name of your custom role used to connect to hopsworks.ai. Get your role connected to hopsworks.ai To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ... , (4) click on Edit . Edit your role connected to hopsworks.ai You will arrive at the Update a custom role page as shown below: Edit your role connected to hopsworks.ai Navigate to the JSON tab, then click on Edit , as shown below: Edit your role connected to hopsworks.ai Now, add the following permissions to the list of actions, then click on Save , click on Review + update , and finally click on Update . \"Microsoft.Compute/snapshots/write\" , \"Microsoft.Compute/snapshots/read\" , \"Microsoft.Compute/snapshots/delete\" , \"Microsoft.Compute/disks/beginGetAccess/action\" , Add missing permissions to your role connected to hopsworks.ai","title":"Step 2: Add backup permissions to your role connected to Hopsworks.ai"},{"location":"setup_installation/common/azure/upgrade_2.4/#step-3-run-the-upgrade-process","text":"You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: Note No need to worry about the following message since this is done already in Step 2 Make sure that your custom role which you have connected to Hopsworks.ai has the following permissions: [ \"Microsoft.Compute/snapshots/write\", \"Microsoft.Compute/snapshots/read\", \"Microsoft.Compute/snapshots/delete\", \"Microsoft.Compute/disks/beginGetAccess/action\", ] Upgrade confirmation Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below: Warning Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. Upgrade confirmation Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion. Note We don't delete your old cluster until the upgrade process is successfully completed. Upgrade is running Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version number on the Details tab of your cluster.","title":"Step 3: Run the upgrade process"},{"location":"setup_installation/common/azure/upgrade_2.4/#error-handling","text":"There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to Hopsworks.ai, see Error 1 . Second, an error during the upgrade process running on your cluster, see Error 2 .","title":"Error handling"},{"location":"setup_installation/common/azure/upgrade_2.4/#error-1-missing-permissions-error","text":"If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below: Missing permission error Update your cross custom role as described in Step 2 , then click Start . Once the cluster is up and running, you can try running the upgrade again.","title":"Error 1: Missing permissions error"},{"location":"setup_installation/common/azure/upgrade_2.4/#error-2-upgrade-process-error","text":"If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: Error occurred during upgrade Click on Rollback to recover your old cluster before upgrade. Upgrade rollback confirmation Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below: Upgrade rollback confirmation Once the rollback is completed, you will be able to continue working as normal with your old cluster. Note The old cluster will be stopped after the rollback. You have to click on the Start button.","title":"Error 2: Upgrade process error"},{"location":"setup_installation/common/sso/ldap/","text":"Configure your hopsworks cluster to use LDAP for user management. # If you want to use your organization's LDAP as an identity provider to manage users in your Hopsworks cluster this document will guide you through the necessary steps to configure Hopsworks.ai to use LDAP. The LDAP attributes below are used to configure JNDI resources in the hopsworks server. The JNDI resource will communicate with your LDAP server to perform the authentication. Setup LDAP jndilookupname : should contain the LDAP domain. java.naming.provider.url : url of your LDAP server with port. java.naming.ldap.attributes.binary : is the binary unique identifier that will be used in subsequent logins to identify the user. java.naming.security.authentication : how to authenticate to the LDAP server. java.naming.security.principal : contains the username of the user that will be used to query LDAP. java.naming.security.credentials : contains the password of the user that will be used to query LDAP. java.naming.referral : whether to follow or ignore an alternate location in which an LDAP Request may be processed. After configuring LDAP and creating your cluster you can log into your hopsworks cluster and edit the LDAP attributes to field names to match your server. By default all attributes to field names are set to the values in OpenLDAP . See Configure LDAP on how to edit the LDAP default configurations.","title":"LDAP"},{"location":"setup_installation/common/sso/ldap/#configure-your-hopsworks-cluster-to-use-ldap-for-user-management","text":"If you want to use your organization's LDAP as an identity provider to manage users in your Hopsworks cluster this document will guide you through the necessary steps to configure Hopsworks.ai to use LDAP. The LDAP attributes below are used to configure JNDI resources in the hopsworks server. The JNDI resource will communicate with your LDAP server to perform the authentication. Setup LDAP jndilookupname : should contain the LDAP domain. java.naming.provider.url : url of your LDAP server with port. java.naming.ldap.attributes.binary : is the binary unique identifier that will be used in subsequent logins to identify the user. java.naming.security.authentication : how to authenticate to the LDAP server. java.naming.security.principal : contains the username of the user that will be used to query LDAP. java.naming.security.credentials : contains the password of the user that will be used to query LDAP. java.naming.referral : whether to follow or ignore an alternate location in which an LDAP Request may be processed. After configuring LDAP and creating your cluster you can log into your hopsworks cluster and edit the LDAP attributes to field names to match your server. By default all attributes to field names are set to the values in OpenLDAP . See Configure LDAP on how to edit the LDAP default configurations.","title":"Configure your hopsworks cluster to use LDAP for user management."},{"location":"setup_installation/common/sso/oauth/","text":"Configure your hopsworks cluster to use OAuth2 for user management. # If you want to use your organization's OAuth 2.0 identity provider to manage users in your hopsworks cluster this document will guide you through the necessary steps to register your identity provider in Hopsworks.ai. Before registering your identity provider in Hopsworks you need to create a client application in your identity provider and acquire a client id and a client secret . Examples on how to create a client using Okta and Azure Active Directory identity providers can be found here and here respectively. In the User management step of cluster creation ( AWS , Azure ) you can choose which user management system to use. Select OAuth2 (OpenId) from the dropdown and configure your identity provider. Setup OAuth Register your identity provider by setting the following fields: ClientId : the client id generated when registering hopsworks in your identity provider. Client Secret : the client secret generated when registering hopsworks in your identity provider. Provider URI : is the base uri of the identity provider (URI should contain scheme http:// or https://). Provider Name : a unique name to identify the identity provider in your hopsworks cluster. This name will be used in the login page as an alternative login method if Provider DisplayName is not set. Optionally you can also set: Provider DisplayName : the name to display for the alternative login method (if not set Provider Name will be used) Provider Logo URI : a logo URL to an image. The logo will be shown on the login page with the provider name. Code Challenge Method : if your identity provider requires a code challenge for authorization request check the code challenge check box. This will allow you to choose a code challenge method that can be either plain or S256. Group Mapping : will allow you to map groups in your identity provider to groups in hopsworks. You can choose to map all users to HOPS_USER or HOPS_ADMIN. Alternatively you can add mappings as in the example below. IT->HOPS_ADMIN;DATA_SCIENCE->HOPS_USER This will map users in the IT group in your identity provider to HOPS_ADMIN and users in the DATA_SCIENCE group to HOPS_USER. Verify Email : if checked only users with verified email address (in the identity provider) can log in to Hopsworks. Activate user : if not checked an administrator in hopsworks needs to activate users before they can login. Need consent : if checked, users will be asked for consent when logging in for the first time. Disable registration : if unchecked users will have the possibility to create accounts in the hopsworks cluster using user name and password instead of OAuth. Provider Metadata Endpoint Supported : if your provider defines a discovery mechanism, called OpenID Connect Discovery, where it publishes its metadata at a well-known URL, typically https://server.com/.well-known/openid-configuration you can check this and the metadata will be discovered by hopsworks. If your provider does not publish its metadata you need to supply these values manually. Setup Provider Authorization Endpoint : the authorization endpoint of your identity provider, typically https://server.com/oauth2/authorize End Session Endpoint : the logout endpoint of your identity provider, typically https://server.com/oauth2/logout Token Endpoint : the token endpoint of your identity provider, typically https://server.com/oauth2/token UserInfo Endpoint : the user info endpoint of your identity provider, typically https://server.com/oauth2/userinfo JWKS URI : the JSON Web Key Set endpoint of your identity provider, typically https://server.com/oauth2/keys After configuring OAuth2 you can click on Next to configure the rest of your cluster. You can also configure OAuth2 once you have created a Hopsworks cluster. For instructions on how to configure OAUth2 on Hopsworks see Authentication Methods .","title":"OAuth2"},{"location":"setup_installation/common/sso/oauth/#configure-your-hopsworks-cluster-to-use-oauth2-for-user-management","text":"If you want to use your organization's OAuth 2.0 identity provider to manage users in your hopsworks cluster this document will guide you through the necessary steps to register your identity provider in Hopsworks.ai. Before registering your identity provider in Hopsworks you need to create a client application in your identity provider and acquire a client id and a client secret . Examples on how to create a client using Okta and Azure Active Directory identity providers can be found here and here respectively. In the User management step of cluster creation ( AWS , Azure ) you can choose which user management system to use. Select OAuth2 (OpenId) from the dropdown and configure your identity provider. Setup OAuth Register your identity provider by setting the following fields: ClientId : the client id generated when registering hopsworks in your identity provider. Client Secret : the client secret generated when registering hopsworks in your identity provider. Provider URI : is the base uri of the identity provider (URI should contain scheme http:// or https://). Provider Name : a unique name to identify the identity provider in your hopsworks cluster. This name will be used in the login page as an alternative login method if Provider DisplayName is not set. Optionally you can also set: Provider DisplayName : the name to display for the alternative login method (if not set Provider Name will be used) Provider Logo URI : a logo URL to an image. The logo will be shown on the login page with the provider name. Code Challenge Method : if your identity provider requires a code challenge for authorization request check the code challenge check box. This will allow you to choose a code challenge method that can be either plain or S256. Group Mapping : will allow you to map groups in your identity provider to groups in hopsworks. You can choose to map all users to HOPS_USER or HOPS_ADMIN. Alternatively you can add mappings as in the example below. IT->HOPS_ADMIN;DATA_SCIENCE->HOPS_USER This will map users in the IT group in your identity provider to HOPS_ADMIN and users in the DATA_SCIENCE group to HOPS_USER. Verify Email : if checked only users with verified email address (in the identity provider) can log in to Hopsworks. Activate user : if not checked an administrator in hopsworks needs to activate users before they can login. Need consent : if checked, users will be asked for consent when logging in for the first time. Disable registration : if unchecked users will have the possibility to create accounts in the hopsworks cluster using user name and password instead of OAuth. Provider Metadata Endpoint Supported : if your provider defines a discovery mechanism, called OpenID Connect Discovery, where it publishes its metadata at a well-known URL, typically https://server.com/.well-known/openid-configuration you can check this and the metadata will be discovered by hopsworks. If your provider does not publish its metadata you need to supply these values manually. Setup Provider Authorization Endpoint : the authorization endpoint of your identity provider, typically https://server.com/oauth2/authorize End Session Endpoint : the logout endpoint of your identity provider, typically https://server.com/oauth2/logout Token Endpoint : the token endpoint of your identity provider, typically https://server.com/oauth2/token UserInfo Endpoint : the user info endpoint of your identity provider, typically https://server.com/oauth2/userinfo JWKS URI : the JSON Web Key Set endpoint of your identity provider, typically https://server.com/oauth2/keys After configuring OAuth2 you can click on Next to configure the rest of your cluster. You can also configure OAuth2 once you have created a Hopsworks cluster. For instructions on how to configure OAUth2 on Hopsworks see Authentication Methods .","title":"Configure your hopsworks cluster to use OAuth2 for user management."},{"location":"setup_installation/common/sso/sso/","text":"Hopsworks.ai Single Sign-On # We will see here how to set up Single Sign-On for Hopsworks.ai. Once this is set up users from your organization will be able to directly sign in to Hopsworks.ai using your identity provider and without the need to manually create an account. They will then be able to manage the clusters of your organization and if you set up user management on your clusters an account will automatically be created for them in the clusters. Note See Hopsworks Single Sing-On if you do not want to give users the rights to manage your organization clusters but want to use your identity provider to manage access to your Hopsworks clusters. Configure your identity provider. # We will give here the examples of Azure Active Directory and AWS Single Sign-On but a similar setup can be done with any identity provider supporting SAML. Azure Active Directory # Go to your hopsworks.ai dashboard . Click on Settings . Click on SSO . Click on Setup SSO . Setup SSO Click on Azure Active Directory . You will need the two copyable entries on this page in the following steps. Azure Active Directory Go to the Azure Portal then proceed to the Active Directory and click on Enterprise applications . Click on New application . New application Search for hopsworks.ai . Click on it then click on create . Create your own application Click on Single sign-on . Then click on SAML . SAML Click on Edit in the Basic SAML Configuration section. Paste the Identifier (Entity ID) and Reply URL that you copied from the Hopsworks.ai setup page. Delete the wild card Identifier (Entity ID) that is already set. For the Sign on URL copy the provided pattern ( https://managed.hopsworks.ai/sso-open/ ) and replace ORGANIZATION by the name of your organization. Click on Save . Configure SAML In the SAML Signing Certificate section copy the App Federation Metadata URL . App Federation Metadata URL Click on Users and groups , in the left column, and add the users and groups you want to have access to hopsworks.ai. Go back to Hopsworks.ai. Click on Next step and keep following the documentation at Configure Hopsworks.ai . Next step Set the organization name you chose above. This name will be used in your login URL so choose something you will remember. Here we will use hopsworks-demo . Paste the Metadata URL you copied above and click Finish . Configure Hopsworks.ai Note if the organization name you chose is already used you will need to set a new one and to update the Sign on URL in Azure. If you go back to the SSO tab of Settings you will get a logging page link. By using this link you will automatically be redirected to your identity provider to login. An account will automatically be created in hopsworks.ai for users of your organization when they log in for the first time. Configure Hopsworks.ai AWS Single Sign-On # Go to your hopsworks.ai dashboard . Click on Settings . Click on SSO . Click on Setup SSO . Setup SSO Click on AWS SSO . You will need the copyable entries on this page in the following steps. AWS SSO Go to AWS Single Sign-On in the AWS Management Console and click on Applications , then click on Add New Application . Add New application Click on Add a custom SAML 2.0 application . Add a custom SAML 2.0 application Give a name to your application, for example, hopsworks_sso . Scroll to the bottom and click on If you don't have a metadata file, you can manually type your metadata values . Application configuration Paste the Application ACS URL and Application SAML audience that you copy from the Hopsworks.ai setup page. Click on Save changes . Application configuration 2 Go to the Attribute mappings tab. On the first line enter the value Subject and select unspecified for the format. then, Click on Add new attribute mapping 3 times. Attribute mapping For each of the created lines enter the following values in the first and second columns and let the format as unspecified. First: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress , second: ${user:email} First: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname , Second: ${user:familyName} First: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname , Second: ${user:givenName} Click on Save changes . Attribute mapping 2 Return to the Configuration tab and click on Edit configuration . Edit configuration Click on Copy URL on the AWS SSO SAML metadata file line. We will call this URL Metadata URL in the coming steps. Metadata URL Go back to Hopsworks.ai. Click on Next step . Next step Give a name to your organization. This name will be used in your login URL so choose something you will remember. Here we will use hopsworks-demo . Paste the Metadata URL you copied above and click Finish . Configure Hopsworks.ai If you go back to the SSO tab of Settings you will get a logging page link. By using this link you will automatically be redirected to your identity provider to login. An account will automatically be created in hopsworks.ai for users of your organization when they log in for the first time. Configure Hopsworks.ai","title":"Hopsworks.ai"},{"location":"setup_installation/common/sso/sso/#hopsworksai-single-sign-on","text":"We will see here how to set up Single Sign-On for Hopsworks.ai. Once this is set up users from your organization will be able to directly sign in to Hopsworks.ai using your identity provider and without the need to manually create an account. They will then be able to manage the clusters of your organization and if you set up user management on your clusters an account will automatically be created for them in the clusters. Note See Hopsworks Single Sing-On if you do not want to give users the rights to manage your organization clusters but want to use your identity provider to manage access to your Hopsworks clusters.","title":"Hopsworks.ai Single Sign-On"},{"location":"setup_installation/common/sso/sso/#configure-your-identity-provider","text":"We will give here the examples of Azure Active Directory and AWS Single Sign-On but a similar setup can be done with any identity provider supporting SAML.","title":"Configure your identity provider."},{"location":"setup_installation/common/sso/sso/#azure-active-directory","text":"Go to your hopsworks.ai dashboard . Click on Settings . Click on SSO . Click on Setup SSO . Setup SSO Click on Azure Active Directory . You will need the two copyable entries on this page in the following steps. Azure Active Directory Go to the Azure Portal then proceed to the Active Directory and click on Enterprise applications . Click on New application . New application Search for hopsworks.ai . Click on it then click on create . Create your own application Click on Single sign-on . Then click on SAML . SAML Click on Edit in the Basic SAML Configuration section. Paste the Identifier (Entity ID) and Reply URL that you copied from the Hopsworks.ai setup page. Delete the wild card Identifier (Entity ID) that is already set. For the Sign on URL copy the provided pattern ( https://managed.hopsworks.ai/sso-open/ ) and replace ORGANIZATION by the name of your organization. Click on Save . Configure SAML In the SAML Signing Certificate section copy the App Federation Metadata URL . App Federation Metadata URL Click on Users and groups , in the left column, and add the users and groups you want to have access to hopsworks.ai. Go back to Hopsworks.ai. Click on Next step and keep following the documentation at Configure Hopsworks.ai . Next step Set the organization name you chose above. This name will be used in your login URL so choose something you will remember. Here we will use hopsworks-demo . Paste the Metadata URL you copied above and click Finish . Configure Hopsworks.ai Note if the organization name you chose is already used you will need to set a new one and to update the Sign on URL in Azure. If you go back to the SSO tab of Settings you will get a logging page link. By using this link you will automatically be redirected to your identity provider to login. An account will automatically be created in hopsworks.ai for users of your organization when they log in for the first time. Configure Hopsworks.ai","title":"Azure Active Directory"},{"location":"setup_installation/common/sso/sso/#aws-single-sign-on","text":"Go to your hopsworks.ai dashboard . Click on Settings . Click on SSO . Click on Setup SSO . Setup SSO Click on AWS SSO . You will need the copyable entries on this page in the following steps. AWS SSO Go to AWS Single Sign-On in the AWS Management Console and click on Applications , then click on Add New Application . Add New application Click on Add a custom SAML 2.0 application . Add a custom SAML 2.0 application Give a name to your application, for example, hopsworks_sso . Scroll to the bottom and click on If you don't have a metadata file, you can manually type your metadata values . Application configuration Paste the Application ACS URL and Application SAML audience that you copy from the Hopsworks.ai setup page. Click on Save changes . Application configuration 2 Go to the Attribute mappings tab. On the first line enter the value Subject and select unspecified for the format. then, Click on Add new attribute mapping 3 times. Attribute mapping For each of the created lines enter the following values in the first and second columns and let the format as unspecified. First: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress , second: ${user:email} First: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname , Second: ${user:familyName} First: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname , Second: ${user:givenName} Click on Save changes . Attribute mapping 2 Return to the Configuration tab and click on Edit configuration . Edit configuration Click on Copy URL on the AWS SSO SAML metadata file line. We will call this URL Metadata URL in the coming steps. Metadata URL Go back to Hopsworks.ai. Click on Next step . Next step Give a name to your organization. This name will be used in your login URL so choose something you will remember. Here we will use hopsworks-demo . Paste the Metadata URL you copied above and click Finish . Configure Hopsworks.ai If you go back to the SSO tab of Settings you will get a logging page link. By using this link you will automatically be redirected to your identity provider to login. An account will automatically be created in hopsworks.ai for users of your organization when they log in for the first time. Configure Hopsworks.ai","title":"AWS Single Sign-On"},{"location":"setup_installation/gcp/cluster_creation/","text":"Cluster creation in Hopsworks.ai (GCP) # This guide goes into detail for each of the steps of the cluster creation in Hopsworks.ai Step 1 starting to create a cluster # In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster Step 2 setting the General information # Select the GCP Project (1) in which you want the cluster to run. Note If the Project does not appear in the drop-down, make sure that you properly Connected your GCP account for this project. Name your cluster (2). Choose the Region (3) and Zone (4) in which to deploy the cluster. Select the Instance type (5) and Local storage (6) size for the cluster Head node . Enter the name of the bucket in which the hopsworks cluster will store its data in Cloud Storage Bucket (7) Warning The bucket must be empty and must be in a region accessible from the region in which the cluster is deployed. General configuration Step 3 workers configuration # In this step, you configure the workers. There are two possible setups: static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: documentation . In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand, for more details: documentation . Static workers configuration # You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes . Create a Hopsworks cluster, static workers configuration Autoscaling workers configuration # You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You then have access to a two parts form, allowing you to configure the autoscaling. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources on standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the number of workers you want to be on standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook requests the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Create a Hopsworks cluster, autoscale workers configuration Step 4 select the Service Account # Hopsworks cluster store their data in a storage bucket. To let the cluster instances access the bucket we need to attach a Service Account to the virtual machines. In this step, you set which Service Account to use by entering its Email . This Service Account needs to have access right to the bucket you selected in Step 2 . For more details on how to create the Service Account and give it access to the bucket refer to Creating and configuring a storage Set the instance service account Step 5 set the backup retention policy # Note This step is only accessible to enterprise users. To backup the storage bucket data when taking a cluster backup we need to set a retention policy for the bucket. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the backup retention policy Step 6 VPC and Subnet selection # You can select the VPC which will be used by the Hopsworks cluster. You can either select an existing VPC or let Hopsworks.ai create one for you. If you decide to use restricted hopsworks.ai permissions (see restrictive-permissions for more details) you will need to select an existing VPC here. Select the vpc If you selected an existing VPC in the previous step, this step lets you select which subnet of this VPC to use. If you did not select an existing virtual network in the previous step Hopsworks.ai will create a subnet for you. You can choose the CIDR block this subnet will use. Select the Subnet to be used by your cluster and press Next . Select the subnet Step 7 User management selection # In this step, you can choose which user management system to use. You have three choices: Managed : Hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization. LDAP : integrate the cluster with your organization's LDAP/ActiveDirectory server. Disabled : let you manage users manually from within Hopsworks. Choose user management type Step 8 Managed RonDB # Hopsworks.ai users have the option to create a cluster with dedicated VMs running RonDB . For details on how to configure RonDB check our guide here . Enable Managed RonDB If you need this feature and don't see this step please contact us . Step 9 add tags to your instances. # In this step, you can define tags that will be added to the cluster virtual machines. Add tags Step 10 add an init script to your instances. # In this step, you can enter an initialization script that will be run at startup on every instance. You can select whether this script will run before or after the VM configuration. Be cautious if you select to run it before the VM configuration as this might affect Cluster creation. Note this init script must be a bash script starting with #!/usr/bin/env bash Add initialization script Step 11 Review and create # Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Cluster Creation"},{"location":"setup_installation/gcp/cluster_creation/#cluster-creation-in-hopsworksai-gcp","text":"This guide goes into detail for each of the steps of the cluster creation in Hopsworks.ai","title":"Cluster creation in Hopsworks.ai (GCP)"},{"location":"setup_installation/gcp/cluster_creation/#step-1-starting-to-create-a-cluster","text":"In Hopsworks.ai, select Create cluster : Create a Hopsworks cluster","title":"Step 1 starting to create a cluster"},{"location":"setup_installation/gcp/cluster_creation/#step-2-setting-the-general-information","text":"Select the GCP Project (1) in which you want the cluster to run. Note If the Project does not appear in the drop-down, make sure that you properly Connected your GCP account for this project. Name your cluster (2). Choose the Region (3) and Zone (4) in which to deploy the cluster. Select the Instance type (5) and Local storage (6) size for the cluster Head node . Enter the name of the bucket in which the hopsworks cluster will store its data in Cloud Storage Bucket (7) Warning The bucket must be empty and must be in a region accessible from the region in which the cluster is deployed. General configuration","title":"Step 2 setting the General information"},{"location":"setup_installation/gcp/cluster_creation/#step-3-workers-configuration","text":"In this step, you configure the workers. There are two possible setups: static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: documentation . In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand, for more details: documentation .","title":"Step 3 workers configuration"},{"location":"setup_installation/gcp/cluster_creation/#static-workers-configuration","text":"You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes . Create a Hopsworks cluster, static workers configuration","title":"Static workers configuration"},{"location":"setup_installation/gcp/cluster_creation/#autoscaling-workers-configuration","text":"You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You then have access to a two parts form, allowing you to configure the autoscaling. In the first part, you configure the autoscaling for general-purpose compute nodes. In the second part, you configure the autoscaling for nodes equipped with GPUs. In both parts you will have to set up the following: The instance type you want to use. You can decide to not enable the autoscaling for GPU nodes by selecting No GPU autoscale . The size of the instances' disk. The minimum number of workers. The maximum number of workers. The targeted number of standby workers. Setting some resources on standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the number of workers you want to be on standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook requests the resources. The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system. Note The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources. Create a Hopsworks cluster, autoscale workers configuration","title":"Autoscaling workers configuration"},{"location":"setup_installation/gcp/cluster_creation/#step-4-select-the-service-account","text":"Hopsworks cluster store their data in a storage bucket. To let the cluster instances access the bucket we need to attach a Service Account to the virtual machines. In this step, you set which Service Account to use by entering its Email . This Service Account needs to have access right to the bucket you selected in Step 2 . For more details on how to create the Service Account and give it access to the bucket refer to Creating and configuring a storage Set the instance service account","title":"Step 4 select the Service Account"},{"location":"setup_installation/gcp/cluster_creation/#step-5-set-the-backup-retention-policy","text":"Note This step is only accessible to enterprise users. To backup the storage bucket data when taking a cluster backup we need to set a retention policy for the bucket. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the backup retention policy","title":"Step 5 set the backup retention policy"},{"location":"setup_installation/gcp/cluster_creation/#step-6-vpc-and-subnet-selection","text":"You can select the VPC which will be used by the Hopsworks cluster. You can either select an existing VPC or let Hopsworks.ai create one for you. If you decide to use restricted hopsworks.ai permissions (see restrictive-permissions for more details) you will need to select an existing VPC here. Select the vpc If you selected an existing VPC in the previous step, this step lets you select which subnet of this VPC to use. If you did not select an existing virtual network in the previous step Hopsworks.ai will create a subnet for you. You can choose the CIDR block this subnet will use. Select the Subnet to be used by your cluster and press Next . Select the subnet","title":"Step 6 VPC and Subnet selection"},{"location":"setup_installation/gcp/cluster_creation/#step-7-user-management-selection","text":"In this step, you can choose which user management system to use. You have three choices: Managed : Hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization. LDAP : integrate the cluster with your organization's LDAP/ActiveDirectory server. Disabled : let you manage users manually from within Hopsworks. Choose user management type","title":"Step 7 User management selection"},{"location":"setup_installation/gcp/cluster_creation/#step-8-managed-rondb","text":"Hopsworks.ai users have the option to create a cluster with dedicated VMs running RonDB . For details on how to configure RonDB check our guide here . Enable Managed RonDB If you need this feature and don't see this step please contact us .","title":"Step 8 Managed RonDB"},{"location":"setup_installation/gcp/cluster_creation/#step-9-add-tags-to-your-instances","text":"In this step, you can define tags that will be added to the cluster virtual machines. Add tags","title":"Step 9 add tags to your instances."},{"location":"setup_installation/gcp/cluster_creation/#step-10-add-an-init-script-to-your-instances","text":"In this step, you can enter an initialization script that will be run at startup on every instance. You can select whether this script will run before or after the VM configuration. Be cautious if you select to run it before the VM configuration as this might affect Cluster creation. Note this init script must be a bash script starting with #!/usr/bin/env bash Add initialization script","title":"Step 10 add an init script to your instances."},{"location":"setup_installation/gcp/cluster_creation/#step-11-review-and-create","text":"Review all information and select Create : Review cluster information The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster. Running Hopsworks cluster","title":"Step 11 Review and create"},{"location":"setup_installation/gcp/getting_started/","text":"Getting started with Hopsworks.ai (Google Cloud Platform) # Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up Hopsworks.ai with your organization's Google Cloud Platform's (GCP) account. Prerequisite # To follow the instruction of this page you will need the following: - A GCP project in which the hopsworks cluster will be deployed. - The gcloud CLI - The gsutil tool Step 1: Connecting your GCP account # Hopsworks.ai deploys Hopsworks clusters to a project in your GCP account. Hopsworks.ai uses service account keys to connect to your GCP project. To enable this, you need to create a service account in your GCP project. Assign to the service account the required permissions. And, create a service account key JSON. For more details about creating and managing service accounts steps in GCP, see documentation . In Hopsworks.ai click on Connect to GCP or go to Settings and click on Configure next to GCP . This will direct you to a page with the instructions needed to create the service account and set up the connection. Follow the instructions. Note it is possible to limit the permissions that step up during this phase. For more details see restrictive-permissions . GCP configuration page Step 2: Creating and configuring a storage # The Hopsworks clusters deployed by Hopsworks.ai store their data in a bucket in your GCP account. To enable this you need to create a bucket and to create a service account with permissions to access the storage. Step 2.1: Creating a custom role for accessing storage # Create a file named hopsworksai_instances_role.yaml with the following content: title : Hopsworks AI Instances description : Role that allows Hopsworks AI Instances to access resources stage : GA includedPermissions : - storage.buckets.get - storage.buckets.update - storage.multipartUploads.abort - storage.multipartUploads.create - storage.multipartUploads.list - storage.multipartUploads.listParts - storage.objects.create - storage.objects.delete - storage.objects.get - storage.objects.list - storage.objects.update Note it is possible to limit the permissions that set up during this phase. For more details see restrictive-permissions . Execute the following gcloud command to create a custom role from the file. Replace [PROJECT_ID] with your GCP project id: gcloud iam roles create hopsworksai_instances \\ --project=[PROJECT_ID] \\ --file=hopsworksai_instances_role.yaml Step 2.2: Creating a service account # Execute the following gcloud command to create a service account for Hopsworks AI instances. Replace [PROJECT_ID] with your GCP project id: gcloud iam service-accounts create hopsworks-ai-instances \\ --project=[PROJECT_ID] \\ --description=\"Service account for Hopsworks AI instances\" \\ --display-name=\"Hopsworks AI instances\" Execute the following gcloud command to bind the custom role to the service account. Replace all occurrences [PROJECT_ID] with your GCP project id: gcloud projects add-iam-policy-binding [PROJECT_ID] \\ --member=\"serviceAccount:hopsworks-ai-instances@[PROJECT_ID].iam.gserviceaccount.com\" \\ --role=\"projects/[PROJECT_ID]/roles/hopsworksai_instances\" Step 2.3: Creating a Bucket # Execute the following gsutil command to create a bucket. Replace all occurrences [PROJECT_ID] with your GCP project id and [BUCKET_NAME] by the name you want to give to your bucket: gsutil mb -p [PROJECT_ID] gs://[BUCKET_NAME] Note The hopsworks cluster created by Hopsworks.ai must be in the same region as the bucket. The above command will create the bucket in the US so in the following steps, you must deploy your cluster in a US region. If you want to deploy your cluster in another part of the word us the -l option of gsutil md . For more detail about creating buckets with gsutil see the documentation Step 4: Deploying a Hopsworks cluster # In Hopsworks.ai , select Create cluster : Create a Hopsworks cluster Select the Project (1) in which you created your Bucket and Service Account (see above). Note If the Project does not appear in the drop-down, make sure that you properly Connected your GCP account for this project. Name your cluster (2). Choose the Region (3) and Zone (4) in which to deploy the cluster. Warning The cluster must be deployed in a region having access to the bucket you created above. Select the Instance type (5) and Local storage (6) size for the cluster Head node . Enter the name of the bucket you created above in Cloud Storage Bucket (7) Press Next : General configuration Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes . Note It is possible to add or remove workers or to enable autoscaling once the cluster is running. Press Next : Create a Hopsworks cluster, static workers configuration Enter Email of the instances service account that you created above . If you followed the instruction it should be hopsworks-ai-instances@[PROJECT_ID].iam.gserviceaccount.com with [PROJECT_ID] the name of your project Press Review and submit : Set the instance service account Note If you are an enterprise user you will have one more step before the Subnet selection. In this step, you will be asked to set the backups retention policy. More details about this step here Review all information and select Create : Review cluster information Note We skipped cluster creation steps that are not mandatory. The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart or terminate the cluster. Running Hopsworks cluster Step 5: Next steps # Check out our other guides for how to get started with Hopsworks and the Feature Store: Make Hopsworks services accessible from outside services Get started with the Hopsworks Feature Store Get started with Machine Learning on Hopsworks: HopsML Get started with Hopsworks: User Guide Code examples and notebooks: hops-examples","title":"Getting Started"},{"location":"setup_installation/gcp/getting_started/#getting-started-with-hopsworksai-google-cloud-platform","text":"Hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up Hopsworks.ai with your organization's Google Cloud Platform's (GCP) account.","title":"Getting started with Hopsworks.ai (Google Cloud Platform)"},{"location":"setup_installation/gcp/getting_started/#prerequisite","text":"To follow the instruction of this page you will need the following: - A GCP project in which the hopsworks cluster will be deployed. - The gcloud CLI - The gsutil tool","title":"Prerequisite"},{"location":"setup_installation/gcp/getting_started/#step-1-connecting-your-gcp-account","text":"Hopsworks.ai deploys Hopsworks clusters to a project in your GCP account. Hopsworks.ai uses service account keys to connect to your GCP project. To enable this, you need to create a service account in your GCP project. Assign to the service account the required permissions. And, create a service account key JSON. For more details about creating and managing service accounts steps in GCP, see documentation . In Hopsworks.ai click on Connect to GCP or go to Settings and click on Configure next to GCP . This will direct you to a page with the instructions needed to create the service account and set up the connection. Follow the instructions. Note it is possible to limit the permissions that step up during this phase. For more details see restrictive-permissions . GCP configuration page","title":"Step 1: Connecting your GCP account"},{"location":"setup_installation/gcp/getting_started/#step-2-creating-and-configuring-a-storage","text":"The Hopsworks clusters deployed by Hopsworks.ai store their data in a bucket in your GCP account. To enable this you need to create a bucket and to create a service account with permissions to access the storage.","title":"Step 2: Creating and configuring a storage"},{"location":"setup_installation/gcp/getting_started/#step-21-creating-a-custom-role-for-accessing-storage","text":"Create a file named hopsworksai_instances_role.yaml with the following content: title : Hopsworks AI Instances description : Role that allows Hopsworks AI Instances to access resources stage : GA includedPermissions : - storage.buckets.get - storage.buckets.update - storage.multipartUploads.abort - storage.multipartUploads.create - storage.multipartUploads.list - storage.multipartUploads.listParts - storage.objects.create - storage.objects.delete - storage.objects.get - storage.objects.list - storage.objects.update Note it is possible to limit the permissions that set up during this phase. For more details see restrictive-permissions . Execute the following gcloud command to create a custom role from the file. Replace [PROJECT_ID] with your GCP project id: gcloud iam roles create hopsworksai_instances \\ --project=[PROJECT_ID] \\ --file=hopsworksai_instances_role.yaml","title":"Step 2.1: Creating a custom role for accessing storage"},{"location":"setup_installation/gcp/getting_started/#step-22-creating-a-service-account","text":"Execute the following gcloud command to create a service account for Hopsworks AI instances. Replace [PROJECT_ID] with your GCP project id: gcloud iam service-accounts create hopsworks-ai-instances \\ --project=[PROJECT_ID] \\ --description=\"Service account for Hopsworks AI instances\" \\ --display-name=\"Hopsworks AI instances\" Execute the following gcloud command to bind the custom role to the service account. Replace all occurrences [PROJECT_ID] with your GCP project id: gcloud projects add-iam-policy-binding [PROJECT_ID] \\ --member=\"serviceAccount:hopsworks-ai-instances@[PROJECT_ID].iam.gserviceaccount.com\" \\ --role=\"projects/[PROJECT_ID]/roles/hopsworksai_instances\"","title":"Step 2.2: Creating a service account"},{"location":"setup_installation/gcp/getting_started/#step-23-creating-a-bucket","text":"Execute the following gsutil command to create a bucket. Replace all occurrences [PROJECT_ID] with your GCP project id and [BUCKET_NAME] by the name you want to give to your bucket: gsutil mb -p [PROJECT_ID] gs://[BUCKET_NAME] Note The hopsworks cluster created by Hopsworks.ai must be in the same region as the bucket. The above command will create the bucket in the US so in the following steps, you must deploy your cluster in a US region. If you want to deploy your cluster in another part of the word us the -l option of gsutil md . For more detail about creating buckets with gsutil see the documentation","title":"Step 2.3: Creating a Bucket"},{"location":"setup_installation/gcp/getting_started/#step-4-deploying-a-hopsworks-cluster","text":"In Hopsworks.ai , select Create cluster : Create a Hopsworks cluster Select the Project (1) in which you created your Bucket and Service Account (see above). Note If the Project does not appear in the drop-down, make sure that you properly Connected your GCP account for this project. Name your cluster (2). Choose the Region (3) and Zone (4) in which to deploy the cluster. Warning The cluster must be deployed in a region having access to the bucket you created above. Select the Instance type (5) and Local storage (6) size for the cluster Head node . Enter the name of the bucket you created above in Cloud Storage Bucket (7) Press Next : General configuration Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes . Note It is possible to add or remove workers or to enable autoscaling once the cluster is running. Press Next : Create a Hopsworks cluster, static workers configuration Enter Email of the instances service account that you created above . If you followed the instruction it should be hopsworks-ai-instances@[PROJECT_ID].iam.gserviceaccount.com with [PROJECT_ID] the name of your project Press Review and submit : Set the instance service account Note If you are an enterprise user you will have one more step before the Subnet selection. In this step, you will be asked to set the backups retention policy. More details about this step here Review all information and select Create : Review cluster information Note We skipped cluster creation steps that are not mandatory. The cluster will start. This will take a few minutes: Booting Hopsworks cluster As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart or terminate the cluster. Running Hopsworks cluster","title":"Step 4: Deploying a Hopsworks cluster"},{"location":"setup_installation/gcp/getting_started/#step-5-next-steps","text":"Check out our other guides for how to get started with Hopsworks and the Feature Store: Make Hopsworks services accessible from outside services Get started with the Hopsworks Feature Store Get started with Machine Learning on Hopsworks: HopsML Get started with Hopsworks: User Guide Code examples and notebooks: hops-examples","title":"Step 5: Next steps"},{"location":"setup_installation/gcp/restrictive_permissions/","text":"Limiting GCP permissions # Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s GCP project. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down access permissions following the IT security policy principle of least privilege. Limiting the Account Service Account permissions # Some of the permissions set up when connection your GCP account to Hopsworks.ai ( here ) can be removed under certain conditions. Backup permissions # The following permissions are only needed for the backup feature. If you are not going to create backups or if you do not have access to this Enterprise feature, you can limit the permission of the Service Account by removing them. - compute.disks.createSnapshot - compute.snapshots.create - compute.snapshots.delete - compute.snapshots.setLabels - compute.snapshots.get - compute.snapshots.useReadOnly Instance type modification permissions # The following permission is only needed to be able to change the head node and RonDB nodes instance type on an existing cluster ( documentation ). If you are not going to use this feature, you can limit the permission of the Service Account by removing it. - compute.instances.setMachineType Create a VPC permissions # The following permissions are only needed if you want Hopsworks.ai to create VPC and subnet for you. If you choose an existing VPC and subnet, you can limit the permission of the Service Account by removing them. - compute.networks.create - compute.networks.delete - compute.networks.get ... - compute.subnetworks.create - compute.subnetworks.delete - compute.subnetworks.get Limiting the Instances Service Account permissions # Some of the permissions set up for the instances service account used during cluster creation ( here ) can be removed under certain conditions. Backups # If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring your instances service account. For this remove the following permission from your instances service account : storage.buckets.update","title":"Limiting Permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#limiting-gcp-permissions","text":"Hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s GCP project. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down access permissions following the IT security policy principle of least privilege.","title":"Limiting GCP permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#limiting-the-account-service-account-permissions","text":"Some of the permissions set up when connection your GCP account to Hopsworks.ai ( here ) can be removed under certain conditions.","title":"Limiting the Account Service Account permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#backup-permissions","text":"The following permissions are only needed for the backup feature. If you are not going to create backups or if you do not have access to this Enterprise feature, you can limit the permission of the Service Account by removing them. - compute.disks.createSnapshot - compute.snapshots.create - compute.snapshots.delete - compute.snapshots.setLabels - compute.snapshots.get - compute.snapshots.useReadOnly","title":"Backup permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#instance-type-modification-permissions","text":"The following permission is only needed to be able to change the head node and RonDB nodes instance type on an existing cluster ( documentation ). If you are not going to use this feature, you can limit the permission of the Service Account by removing it. - compute.instances.setMachineType","title":"Instance type modification permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#create-a-vpc-permissions","text":"The following permissions are only needed if you want Hopsworks.ai to create VPC and subnet for you. If you choose an existing VPC and subnet, you can limit the permission of the Service Account by removing them. - compute.networks.create - compute.networks.delete - compute.networks.get ... - compute.subnetworks.create - compute.subnetworks.delete - compute.subnetworks.get","title":"Create a VPC permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#limiting-the-instances-service-account-permissions","text":"Some of the permissions set up for the instances service account used during cluster creation ( here ) can be removed under certain conditions.","title":"Limiting the Instances Service Account permissions"},{"location":"setup_installation/gcp/restrictive_permissions/#backups","text":"If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring your instances service account. For this remove the following permission from your instances service account : storage.buckets.update","title":"Backups"},{"location":"setup_installation/on_prem/hopsworks_installer/","text":"Hopsworks Installer # The hopsworks-installer.sh script downloads, configures, and installs Hopsworks. It is typically run interactively, prompting the user about details of what to be is installed and where. It can also be run non-interactively (no user prompts) using the '-ni' switch. Requirements # You need at least one server or virtual machine on which Hopsworks will be installed with at least the following specification: Centos/RHEL 7.x or Ubuntu 18.04; at least 32GB RAM, at least 8 CPUs, 100 GB of free hard-disk space, outside Internet access (if this server is air-gapped, contact us for support), a UNIX user account with sudo privileges. Quickstart # To install on your single server or VM, run the following bash commands from your user account with sudo privileges: wget https://raw.githubusercontent.com/logicalclocks/karamel-chef/master/hopsworks-installer.sh chmod +x hopsworks-installer.sh ./hopsworks-installer.sh Installation takes roughly 1 hr, or slower if your server/VM has a low-bandwidth Internet connection. Once your installation is finished, you can stop (and start) Hopsworks using the commands: sudo /srv/hops/kagent/kagent/bin/shutdown-all-local-services.sh sudo /srv/hops/kagent/kagent/bin/start-all-local-services.sh Note that all services in Hopsworks are systemd services that are enabled by default, that is, they will restart when VM/server is rebooted. Multi-node installation # Configure installer ssh access # You need to identify a set of servers/VMs and create the same user account with sudo privileges on all the servers. You should identify one server as the head server from which you will perform the installation. You need to ensure that the nodes can communicate with each other on every port and to configure password-less SSH Access from the Head node to Worker nodes. First, on the head node, you should create an openssh keypair without a password: cat /dev/zero | ssh-keygen -m PEM -q -N \"\" cat ~/.ssh/id_rsa.pub The second line above will print the public key for the sudo account on the head node. Copy that public key, and append it to the ~/.ssh/authorized_keys files on all worker nodes, so that that the sudo account on the head node can SSH into the worker nodes without a password. It may be that you need to configure your sshd daemon (sshd_config and sshlogin) to allow openssh-key based login, depending on how your server is configured: How to setup passwordless ssh For both Ubuntu and Centos/RHEL, and assuming the sudo account is 'ubuntu' and our three worker nodes have hostnames 'vm1', 'vm2', and 'vm3', then you could run the following: ssh-copy-id -i $HOME /.ssh/id_rsa.pub ubuntu@vm1 ssh-copy-id -i $HOME /.ssh/id_rsa.pub ubuntu@vm2 ssh-copy-id -i $HOME /.ssh/id_rsa.pub ubuntu@vm3 Test that you now have passwordless SSH access to all the worker nodes from the head node (assuming 'ubuntu' is the sudo account): # from the head VM ssh ubuntu@vm1 ssh ubuntu@vm2 ssh ubuntu@vm3 Start installation # On the head node, in the sudo account, download and run this script that installs Hopsworks on all hosts. It will ask you to enter the IP address of all the workers during installation: wget https://raw.githubusercontent.com/logicalclocks/karamel-chef/master/hopsworks-installer.sh chmod +x hopsworks-installer.sh ./hopsworks-installer.sh The above script will download and install Karamel on the same server that runs the script. Karamel will install Hopsworks across all hosts. Installation takes roughly 1 hr, slightly longer for large clusters. To find out more about Karamel, read more below. Purge an Existing Cluster Installation # ./hopsworks-installer.sh -i purge -ni Installation from behind an HTTP Proxy (firewall) # Installation will not work if your http proxy has a self-signed certificate. You can explicitly specify the http proxy by passing the '-p' switch to the installer. ./hopsworks-installer.sh -p https://1.2.3.4:3283 If you have set the environment variable http_proxy or https_proxy, hopsworks-installer.sh will use it, even if you don't specify the '-p-' switch. The '-p' switch overrides the environment variable, if both are set. If both http_proxy and https_proxy environment variables are set, it will favour the http_proxy environment variable. You can change this behavior using the following arguments '-p $https_proxy'. Air-gapped installation # Hopsworks can be installed in an air-gapped environment. We recommend that you submit a contact form for help in installing in an environment without outbound Internet access. Installation Script Options # usage: [ sudo ] ./hopsworks-installer.sh [ -h | --help ] help message [ -i | --install-action localhost | localhost-tls | cluster | enterprise | karamel | purge | purge-all ] 'localhost' installs a localhost Hopsworks cluster 'localhost-tls' installs a localhost Hopsworks cluster with TLS enabled 'cluster' installs a multi-host Hopsworks cluster 'enterprise' installs a multi-host Enterprise Hopsworks cluster 'kubernetes' installs a multi-host Enterprise Hopsworks cluster with Kubernetes 'karamel' installs and starts Karamel 'purge' removes Hopsworks completely from this host 'purge-all' removes Hopsworks completely from ALL hosts [ -cl | --clean ] removes the karamel installation [ -dr | --dry-run ] does not run karamel, just generates YML file [ -nvme | --nvme num_disks ] Number of NVMe disks on worker nodes ( for NDB/HopsFS ) [ -c | --cloud on-premises | gcp | aws | azure ] [ -w | --workers IP1,IP2,...,IPN | none ] install on workers with IPs in supplied list ( or none ) . Uses default mem/cpu/gpus for the workers. [ -de | --download-enterprise-url url ] downloads enterprise binaries from this URL. [ -dc | --download-opensource-url url ] downloads open-source binaries from this URL. [ -du | --download-user username ] Username for downloading enterprise binaries. [ -dp | --download-password password ] Password for downloading enterprise binaries. [ -gs | --gem-server ] Run a local gem server for chef-solo ( for air-gapped installations ) . [ -ni | --non-interactive )] skip license/terms acceptance and all confirmation screens. [ -p | --http-proxy ) url ] URL of the http ( s ) proxy server. Only https proxies with valid certs supported. [ -pwd | --password password ] sudo password for user running chef recipes. [ -y | --yml yaml_file ] yaml file to run Karamel against.","title":"Hopsworks Installer"},{"location":"setup_installation/on_prem/hopsworks_installer/#hopsworks-installer","text":"The hopsworks-installer.sh script downloads, configures, and installs Hopsworks. It is typically run interactively, prompting the user about details of what to be is installed and where. It can also be run non-interactively (no user prompts) using the '-ni' switch.","title":"Hopsworks Installer"},{"location":"setup_installation/on_prem/hopsworks_installer/#requirements","text":"You need at least one server or virtual machine on which Hopsworks will be installed with at least the following specification: Centos/RHEL 7.x or Ubuntu 18.04; at least 32GB RAM, at least 8 CPUs, 100 GB of free hard-disk space, outside Internet access (if this server is air-gapped, contact us for support), a UNIX user account with sudo privileges.","title":"Requirements"},{"location":"setup_installation/on_prem/hopsworks_installer/#quickstart","text":"To install on your single server or VM, run the following bash commands from your user account with sudo privileges: wget https://raw.githubusercontent.com/logicalclocks/karamel-chef/master/hopsworks-installer.sh chmod +x hopsworks-installer.sh ./hopsworks-installer.sh Installation takes roughly 1 hr, or slower if your server/VM has a low-bandwidth Internet connection. Once your installation is finished, you can stop (and start) Hopsworks using the commands: sudo /srv/hops/kagent/kagent/bin/shutdown-all-local-services.sh sudo /srv/hops/kagent/kagent/bin/start-all-local-services.sh Note that all services in Hopsworks are systemd services that are enabled by default, that is, they will restart when VM/server is rebooted.","title":"Quickstart"},{"location":"setup_installation/on_prem/hopsworks_installer/#multi-node-installation","text":"","title":"Multi-node installation"},{"location":"setup_installation/on_prem/hopsworks_installer/#configure-installer-ssh-access","text":"You need to identify a set of servers/VMs and create the same user account with sudo privileges on all the servers. You should identify one server as the head server from which you will perform the installation. You need to ensure that the nodes can communicate with each other on every port and to configure password-less SSH Access from the Head node to Worker nodes. First, on the head node, you should create an openssh keypair without a password: cat /dev/zero | ssh-keygen -m PEM -q -N \"\" cat ~/.ssh/id_rsa.pub The second line above will print the public key for the sudo account on the head node. Copy that public key, and append it to the ~/.ssh/authorized_keys files on all worker nodes, so that that the sudo account on the head node can SSH into the worker nodes without a password. It may be that you need to configure your sshd daemon (sshd_config and sshlogin) to allow openssh-key based login, depending on how your server is configured: How to setup passwordless ssh For both Ubuntu and Centos/RHEL, and assuming the sudo account is 'ubuntu' and our three worker nodes have hostnames 'vm1', 'vm2', and 'vm3', then you could run the following: ssh-copy-id -i $HOME /.ssh/id_rsa.pub ubuntu@vm1 ssh-copy-id -i $HOME /.ssh/id_rsa.pub ubuntu@vm2 ssh-copy-id -i $HOME /.ssh/id_rsa.pub ubuntu@vm3 Test that you now have passwordless SSH access to all the worker nodes from the head node (assuming 'ubuntu' is the sudo account): # from the head VM ssh ubuntu@vm1 ssh ubuntu@vm2 ssh ubuntu@vm3","title":"Configure installer ssh access"},{"location":"setup_installation/on_prem/hopsworks_installer/#start-installation","text":"On the head node, in the sudo account, download and run this script that installs Hopsworks on all hosts. It will ask you to enter the IP address of all the workers during installation: wget https://raw.githubusercontent.com/logicalclocks/karamel-chef/master/hopsworks-installer.sh chmod +x hopsworks-installer.sh ./hopsworks-installer.sh The above script will download and install Karamel on the same server that runs the script. Karamel will install Hopsworks across all hosts. Installation takes roughly 1 hr, slightly longer for large clusters. To find out more about Karamel, read more below.","title":"Start installation"},{"location":"setup_installation/on_prem/hopsworks_installer/#purge-an-existing-cluster-installation","text":"./hopsworks-installer.sh -i purge -ni","title":"Purge an Existing Cluster Installation"},{"location":"setup_installation/on_prem/hopsworks_installer/#installation-from-behind-an-http-proxy-firewall","text":"Installation will not work if your http proxy has a self-signed certificate. You can explicitly specify the http proxy by passing the '-p' switch to the installer. ./hopsworks-installer.sh -p https://1.2.3.4:3283 If you have set the environment variable http_proxy or https_proxy, hopsworks-installer.sh will use it, even if you don't specify the '-p-' switch. The '-p' switch overrides the environment variable, if both are set. If both http_proxy and https_proxy environment variables are set, it will favour the http_proxy environment variable. You can change this behavior using the following arguments '-p $https_proxy'.","title":"Installation from behind an HTTP Proxy (firewall)"},{"location":"setup_installation/on_prem/hopsworks_installer/#air-gapped-installation","text":"Hopsworks can be installed in an air-gapped environment. We recommend that you submit a contact form for help in installing in an environment without outbound Internet access.","title":"Air-gapped installation"},{"location":"setup_installation/on_prem/hopsworks_installer/#installation-script-options","text":"usage: [ sudo ] ./hopsworks-installer.sh [ -h | --help ] help message [ -i | --install-action localhost | localhost-tls | cluster | enterprise | karamel | purge | purge-all ] 'localhost' installs a localhost Hopsworks cluster 'localhost-tls' installs a localhost Hopsworks cluster with TLS enabled 'cluster' installs a multi-host Hopsworks cluster 'enterprise' installs a multi-host Enterprise Hopsworks cluster 'kubernetes' installs a multi-host Enterprise Hopsworks cluster with Kubernetes 'karamel' installs and starts Karamel 'purge' removes Hopsworks completely from this host 'purge-all' removes Hopsworks completely from ALL hosts [ -cl | --clean ] removes the karamel installation [ -dr | --dry-run ] does not run karamel, just generates YML file [ -nvme | --nvme num_disks ] Number of NVMe disks on worker nodes ( for NDB/HopsFS ) [ -c | --cloud on-premises | gcp | aws | azure ] [ -w | --workers IP1,IP2,...,IPN | none ] install on workers with IPs in supplied list ( or none ) . Uses default mem/cpu/gpus for the workers. [ -de | --download-enterprise-url url ] downloads enterprise binaries from this URL. [ -dc | --download-opensource-url url ] downloads open-source binaries from this URL. [ -du | --download-user username ] Username for downloading enterprise binaries. [ -dp | --download-password password ] Password for downloading enterprise binaries. [ -gs | --gem-server ] Run a local gem server for chef-solo ( for air-gapped installations ) . [ -ni | --non-interactive )] skip license/terms acceptance and all confirmation screens. [ -p | --http-proxy ) url ] URL of the http ( s ) proxy server. Only https proxies with valid certs supported. [ -pwd | --password password ] sudo password for user running chef recipes. [ -y | --yml yaml_file ] yaml file to run Karamel against.","title":"Installation Script Options"},{"location":"user_guides/common/dummy/","text":"","title":"Hops File System (HopsFS)"},{"location":"user_guides/fs/dummy/","text":"How To [Install/Configure/Do Something] on [Distribution] # Introduction # Introductory paragraph about the topic that explains what this topic is about and why the reader should care; what problem does it solve? In this guide, you will [configure/set up/build/deploy] [some thing]... When you're finished, you'll be able to... Prerequisites # Before you begin this guide you'll need the following: [number of servers] server(s) A non-root user with sudo privileges ( ) explains how to set this up.) (Optional) If software such as Nginx needs to be installed, link to the proper article describing how to install it. (Optional) If the reader needs a fully-qualified domain name (FQDN), mention it here as well. (Optional) List any other accounts needed, such as GitHub, Facebook, or other services. Step 1 \u2014 Doing Something # Introduction to the step. What are we going to do and why are we doing it? First.... Next... Finally... Display the status of your firewall with the following command: sudo ufw status You'll see the following output: [secondary_label Output] Status: active To Action From -- ------ ---- OpenSSH ALLOW Anywhere <^>Nginx HTTP ALLOW Anywhere<^> OpenSSH (v6) ALLOW Anywhere (v6) <^>Nginx HTTP (v6) ALLOW Anywhere (v6)<^> Open the file /etc/nginx.conf in your editor: sudo nano /etc/nginx.com Change the root field so it points to /var/www/your_domain : [label /etc/nginx/sites-available/default] server { listen 80 default_server ; listen [::]:80 default_server ipv6only=on ; root <^>/var/www/your_domain<^> ; index index.html index.htm ; server_name localhost ; location / { try_files $uri $uri/ = 404 ; } } Now transition to the next step by telling the reader what's next. Step 2 \u2014 Title Case # Another introduction Your content Transition to the next step. Step 3 \u2014 Title Case # Another introduction Your content Transition to the next step. Conclusion # In this article you [configured/set up/built/deployed] [something]. Now you can....","title":"Tags and Keywords"},{"location":"user_guides/fs/dummy/#how-to-installconfiguredo-something-on-distribution","text":"","title":"How To [Install/Configure/Do Something] on [Distribution]"},{"location":"user_guides/fs/dummy/#introduction","text":"Introductory paragraph about the topic that explains what this topic is about and why the reader should care; what problem does it solve? In this guide, you will [configure/set up/build/deploy] [some thing]... When you're finished, you'll be able to...","title":"Introduction"},{"location":"user_guides/fs/dummy/#prerequisites","text":"Before you begin this guide you'll need the following: [number of servers] server(s) A non-root user with sudo privileges ( ) explains how to set this up.) (Optional) If software such as Nginx needs to be installed, link to the proper article describing how to install it. (Optional) If the reader needs a fully-qualified domain name (FQDN), mention it here as well. (Optional) List any other accounts needed, such as GitHub, Facebook, or other services.","title":"Prerequisites"},{"location":"user_guides/fs/dummy/#step-1-doing-something","text":"Introduction to the step. What are we going to do and why are we doing it? First.... Next... Finally... Display the status of your firewall with the following command: sudo ufw status You'll see the following output: [secondary_label Output] Status: active To Action From -- ------ ---- OpenSSH ALLOW Anywhere <^>Nginx HTTP ALLOW Anywhere<^> OpenSSH (v6) ALLOW Anywhere (v6) <^>Nginx HTTP (v6) ALLOW Anywhere (v6)<^> Open the file /etc/nginx.conf in your editor: sudo nano /etc/nginx.com Change the root field so it points to /var/www/your_domain : [label /etc/nginx/sites-available/default] server { listen 80 default_server ; listen [::]:80 default_server ipv6only=on ; root <^>/var/www/your_domain<^> ; index index.html index.htm ; server_name localhost ; location / { try_files $uri $uri/ = 404 ; } } Now transition to the next step by telling the reader what's next.","title":"Step 1 \u2014 Doing Something"},{"location":"user_guides/fs/dummy/#step-2-title-case","text":"Another introduction Your content Transition to the next step.","title":"Step 2 \u2014 Title Case"},{"location":"user_guides/fs/dummy/#step-3-title-case","text":"Another introduction Your content Transition to the next step.","title":"Step 3 \u2014 Title Case"},{"location":"user_guides/fs/dummy/#conclusion","text":"In this article you [configured/set up/built/deployed] [something]. Now you can....","title":"Conclusion"},{"location":"user_guides/integrations/dummy/","text":"","title":"Dummy"},{"location":"user_guides/ml/dummy/","text":"","title":"Dummy"},{"location":"user_guides/ml/deployment/dummy/","text":"","title":"Dummy"},{"location":"user_guides/ml/model/framworks/dummy/","text":"","title":"Dummy"}]}